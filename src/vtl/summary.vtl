#set ($partnerCode = $request.getParameter('partnerCode'))
  #set ($partnerURLTitle = $request.getParameter('partnerURLTitle'))
  #set ($productCode = $request.getParameter('productCode'))
  #set ($productName = $request.getParameter('productName'))
  #set ($productURLTitle = $request.getParameter('productURLTitle'))
  #set ($promotionCode = $request.getParameter('promotionCode'))
  #set ($CmsSettingUtil = $webutil.getBean("cmsSettingUtil"))
  #set ($partner = $CmsSettingUtil.findCMSSetting($partnerCode))
  #set ($allowPromoCode = $UtilMethods.isSet($productCode) && $CmsSettingUtil.hasPromoCodeStructure($productCode))
  #if ($allowPromoCode && $UtilMethods.isSet($promotionCode))
    #set ($promoCodeStruc = $CmsSettingUtil.findPromoCodeStructure($productCode, $promotionCode))
  #end
  #set ($product = $CmsSettingUtil.findCMSProductSettingAdjustedByPromoCode($productCode, $partner.getPartnerIdentifier(), $promoCodeStruc))
  #set ($productExtended = $CmsSettingUtil.findExtendedProductStructure($productCode))
  #if($request.getParameter('branch').length() > 0)
    #set ($branch = $request.getParameter('branch'))
  #end
  
  $request.getSession().setAttribute('isInIframeP', null)
  $request.getSession().setAttribute('previousPageIframe', 'Summary')
   
  ##foreach($con in $dotcontent.pull("+structureName:WlpProductStructure +(conhost:$host.identifier conhost:SYSTEM_HOST) +(Parent_WlpPartnerStructure-Child_WlpProductStructure:$partner.getPartnerIdentifier()) +WlpProductStructure.productCode:$productCode",1,"undefined"))
  #foreach($con in $dotcontent.pullRelated("WlpPartnerStructure.wlpproductstructures",$partner.getPartnerIdentifier(),"+Wlpproductstructure.productCode:$productCode",false, 1, ""))
    #set($tnc = $con.tnc)
    #set($productLogo = $con.productLogoS.uri)
    #set($productDisclosurePDF =  $con.productDisclosureSheet.uri)
    #set($upgradeSummaryHeader = $con.upgradeSummaryHeader)
    #set($upgradeSummaryDescription = $con.upgradeSummaryDescription)
    #set($basicSummaryHeader = $con.basicSummaryHeader)
    #set($basicSummaryDescription = $con.basicSummaryDescription)
    #set($productDisclosurePDFHtml =  $con.productDisclosureSheetHtml)
  #end
  
    #set($productDisclosurePDFGstHtml =  $productExtended.content.productDisclosureSheetGstHtml)
    #set($productDisclosureSheetMmp =  $productExtended.content.productDisclosureSheetMmp)

#set($gstVal = $wlputil.getGst())
#set($stampDuty = $product.getStampDuty())
#set ($purchaseTempId = $CmsSettingUtil.decryptPBEWithMD5AndDES($request.getParameter('purchaseTempId')))
#if ($UtilMethods.isSet($purchaseTempId))
  ## get from the purchase temp table
  #set ($purchaseService = $webutil.getBean("purchaseService"))  
  #set ($purchaseTemp = $purchaseService.findPurchaseTempById($webapi.parseLong($purchaseTempId)))
  #set ($purchaseExtTempList = $purchaseService.findPurchaseExtTempByPurchaseTempId($webapi.parseLong($purchaseTempId)))
  #if($UtilMethods.isSet($purchaseTemp.promoCode))
    #set($promotionCode = $purchaseTemp.promoCode)
  #end
  #set ($membershipID = $purchaseTemp.membershipID)
  #set($policyHolderName = $purchaseTemp.policyHolderName)
  #set($policyHolderMalaysian = $purchaseTemp.policyHolderMalaysian)
  #if ($policyHolderMalaysian)
    #set($policyHolderMalaysian = "Y")
  #else
    #set($policyHolderMalaysian = "N")
  #end
  #if (!$UtilMethods.isSet($policyHolderMalaysian) || $policyHolderMalaysian == "Y")
    #set($policyHolderNric = $wlputil.formatNric($purchaseTemp.policyHolderNric))
  #else
    #set($policyHolderNric = $purchaseTemp.policyHolderNric)
    #set($policyHolderGender = $purchaseTemp.policyHolderGender)
    #set($policyHolderDateOfBirth = $date.format('dd/MM/yyyy', $purchaseTemp.policyHolderDateOfBirth))
    #set($policyHolderNationality = $purchaseTemp.policyHolderNationality)
  #end
  #set($policyHolderMobileNo = $purchaseTemp.policyHolderMobileNo)
  #set($policyHolderMaritalStatus = $purchaseTemp.policyHolderMaritalStatus)
  #set($policyHolderEmail = $purchaseTemp.policyHolderEmail)
  #if ($UtilMethods.isSet($purchaseTemp.photo))
    #set($photo = "purtmp" + $purchaseTemp.uuid)
  #end
  <!--Tax invoice amend -->        
  #set($policyHolderAddressLine1 = $purchaseTemp.policyHolderAddressLine1)        
  #set($policyHolderAddressLine2 = $purchaseTemp.policyHolderAddressLine2)
  #set($addressPostcode = $purchaseTemp.addressPostcode)
  #set($addressState = $purchaseTemp.addressState)
  #set($addressCity = $purchaseTemp.addressCity)
  #set($addressOverwriteIndicator = $purchaseTemp.addressOverwriteIndicator)

  #set($propertyPostcode = $purchaseTemp.propertyPostcode)
  #set($propertyAddressLine1= $purchaseTemp.propertyAddressLine1)
  #set($propertyAddressLine2= $purchaseTemp.propertyAddressLine2)
  #set($propertyState = $purchaseTemp.propertyState)
  #set($propertyCity = $purchaseTemp.propertyCity)
  #set($studentId = $purchaseTemp.studentId)
  #set($staffId = $purchaseTemp.staffId)
  #set($staffRelationship = $purchaseTemp.staffRelationship)
  #set($campus = $purchaseTemp.campus)

  #set($locationAddressLine1= $purchaseTemp.locationAddressLine1)
  #set($locationAddressLine2= $purchaseTemp.locationAddressLine2)

  #set($staffName = $purchaseTemp.staffName)
  #set($branchAbbr = $purchaseTemp.branchAbbr)
  #set($agentNumber = $purchaseTemp.agentNumber)

  #set($coveragePlan = $purchaseTemp.coveragePlan)
  #set($coverageStartDate = $date.format('dd/MM/yyyy', $purchaseTemp.coverageStartDate))
  #set($coverageExpiryDate = $date.format('dd/MM/yyyy', $purchaseTemp.coverageExpiryDate))
  #set($noDaysCovered = $purchaseTemp.daysOfCoverage)
  
  #set($memberNameArr = [])
  #set($memberIdNoArr = [])
  #set($memberIsMalaysianArr = [])
  #set($memberRelationshipArr = [])
  #set($driverRelationshipArr = [])
  #set($memberDOBArr = [])
  #set($memberMotorDrivingExperienceArr = [])
  #set($memberOccupationArr = [])

  #set($memberPetBreedArr = [])
  #set($memberGenderArr = [])
  #set($memberPetMicrochipIdArr = [])
  #set($memberPhotoArr = [])

  #foreach($member in $purchaseExtTempList)
      #set($dummy = $memberNameArr.add($member.name))
      #if ($member.malaysian)
        #set($dummy = $memberIdNoArr.add($wlputil.formatNric($member.identificationNo)))
        #set($dummy = $memberIsMalaysianArr.add("Y"))
      #else
        #set($dummy = $memberIdNoArr.add($member.identificationNo))
        #set($dummy = $memberIsMalaysianArr.add("N"))
      #end

      #set($dummy = $memberRelationshipArr.add($member.relationship))
      #set($dummy = $driverRelationshipArr.add($member.driverRelationship))
      #set($dummy = $memberGenderArr.add($member.gender))
      #set($dummy = $memberDOBArr.add($date.format('dd/MM/yyyy', $member.dateOfBirth)))
      ##set($dummy = $memberMotorDrivingExperienceArr.add($number.format("integer", $member.motorDrivingExperience)))
      #set($dummy = $memberOccupationArr.add($member.occupation))        
      
      #if ($product.formula == "motor" && $product.productName != "Motorcycle")
        #set($dummy = $memberMotorDrivingExperienceArr.add($number.format("integer", $member.motorDrivingExperience)))
      #end
      #if ($product.formula == "pets")
        #set($dummy = $memberPetBreedArr.add($member.petBreed))
        ##set($dummy = $memberGenderArr.add($member.gender))
        #set($dummy = $memberPetMicrochipIdArr.add($member.petMicrochipId))
        #if ($UtilMethods.isSet($member.photo))
        #set($dummy = $memberPhotoArr.add($member.photo)) 
        #end      
      #end

  #end
  
  #set($memberName = $wlputil.arrayToString($memberNameArr))
  #set($memberIdNo = $wlputil.arrayToString($memberIdNoArr))
  #set($memberIsMalaysian = $wlputil.arrayToString($memberIsMalaysianArr))
  #set($memberRelationship = $wlputil.arrayToString($memberRelationshipArr))
  #set($driverRelationship = $wlputil.arrayToString($driverRelationshipArr))
  #set($memberDOB = $wlputil.arrayToString($memberDOBArr))
  #set($memberMotorDrivingExperience = $wlputil.arrayToString($memberMotorDrivingExperienceArr))
  #set($memberOccupation = $wlputil.arrayToString($memberOccupationArr))
  #set($memberGender = $wlputil.arrayToString($memberGenderArr))
  #if ($product.formula == "pets")
    #set($memberPetBreed = $wlputil.arrayToString($memberPetBreedArr))
    #set($memberPetMicrochipId = $wlputil.arrayToString($memberPetMicrochipIdArr))
    #set($memberPhoto = $wlputil.arrayToString($memberPhotoArr))
  #end
  #set($hasUpgrade = $purchaseTemp.hasUpgrade)
  #set($errorMsg = $purchaseTemp.errorMsg)
  #if($purchaseTemp.coverageGstValue > 0)
    #set($destSelect = 'Y')
  #else
    #set($destSelect = 'N')
  #end
  #set($travelPlan = $purchaseTemp.travelPlan)
  #set($travelArea = $purchaseTemp.travelArea)
  #set($travelBenefitPlan = $purchaseTemp.travelBenefitPlan)
  #set($prescreenYesNo = $purchaseTemp.prescreenYesNo)
  #set($prescreenYesNo2 = $purchaseTemp.prescreenYesNo2)
  #set($prescreenYesNo3 = $purchaseTemp.prescreenYesNo3)
  #set($prescreenYesNo4 = $purchaseTemp.prescreenYesNo4)
  #set($policyHolderOccupation = $purchaseTemp.policyHolderOccupation)
  #set($bmi = $purchaseTemp.bmi)
  #set($bmiHeight = $purchaseTemp.bmiHeight)
  #set($bmiWeight = $purchaseTemp.bmiWeight)

  
  #if ($product.formula == "motor")
    #set($productName = $purchaseTemp.productName)
    #set($motorRegistrationNo = $purchaseTemp.motorRegistrationNo)
    #if ($UtilMethods.isSet($purchaseTemp.certificateNo))
        #set($certificateNo = $purchaseTemp.certificateNo)
    #end
    #set($motorChassisNo = $purchaseTemp.motorChassisNo)
    #if($purchaseTemp.dpfStatus)
        #set($dpfStatus = "true")
    #else
        #set($dpfStatus = "false")
    #end
    #set($motorMakeCode = $purchaseTemp.esumRequest.vehicleMake)
    #set($motorModelCode = $purchaseTemp.esumRequest.vehicleModel)
    #foreach($con in $dotcontent.pull("+structureName:TieRefBancaMotorMake +(conhost:ceaa0d75-448c-4885-a628-7f0c35d374bd conhost:SYSTEM_HOST) +live:true",0,"TieRefBancaMotorMake.makeDescription"))
       #if($motorMakeCode == $con.makeCode && $productCode == $con.productCode)
         #set($motorMake = $con.makeDescription)
        #end
    #end
    #set($motorCc = $purchaseTemp.esumRequest.vehicleCc)
    #set($motorYearOfMake = $purchaseTemp.esumRequest.yearOfMake)
    #set($motorSeat = $purchaseTemp.esumRequest.motorSeat)
    #set($motorStyle = $purchaseTemp.esumRequest.motorStyle)
    #set($motorVariant = $purchaseTemp.esumRequest.motorVariant)
    #set($motorTransmission = $purchaseTemp.esumRequest.motorTransmission)
    #set($motorFamily = $purchaseTemp.esumRequest.motorFamily)
    #set($motorNcdCheckNRIC = $purchaseTemp.motorNcdCheckNRIC)
    #set($motorNcdCheckPassport = $purchaseTemp.motorNcdCheckPasspor)
    #set($motorNxtNcdLevel = $purchaseTemp.motorNcdEnquiry.nxtNcdLevel)
    #if($number.format("#.##", $purchaseTemp.motorNcdRate).endsWith("."))
        #set($format = "#[[#,###.##]]#")
        #set($motorDisplayNxtNcd = $number.format($format,$purchaseTemp.motorNcdRate) + "%")
    #else
        #set($format = "#[[#]]#")
        #set($motorDisplayNxtNcd = $number.format($format,$purchaseTemp.motorNcdRate) + "%")
    #end
    #set($motorNxtNcdEffDate = $date.format('dd/MM/yyyy', $purchaseTemp.motorNcdEnquiry.nxtNcdEffDate))
    #set($motorCurNcdLevel = $purchaseTemp.motorNcdEnquiry.curNcdLevel)
    #set($motorCurNcdEffDate = $date.format('dd/MM/yyyy', $purchaseTemp.motorNcdEnquiry.curNcdEffDate))
    #set($motorCurNcdExpDate = $date.format('dd/MM/yyyy', $purchaseTemp.motorNcdEnquiry.curNcdExpDate))
    #set($motorNvic = $purchaseTemp.motorNvic)
    #set($motorVehicleLocation = $purchaseTemp.motorVehicleLocation)
    #set($motorVehicleLocationStateCode = $purchaseTemp.motorVehicleLocationStateCode)
    #set($motorSumInsured = $purchaseTemp.motorSumInsured)
    #if($productCode == "MSM")        
        #set ($rule = $purchaseService.deserializeJson($productExtended, $productCode, $purchaseTemp.agentNumber))        
        #foreach($con in $rule.getSumInsuredType())        
                #if($math.sub($motorSumInsured,$math.mul($purchaseTemp.esumRequest.motorMktValue,$math.div($con.getMarkup(),100))) == $purchaseTemp.esumRequest.motorMktValue)        
                    #set($motorVehiclePremiumValue = "marketValue")        
                        
                #elseif($math.sub($motorSumInsured,$math.mul($purchaseTemp.esumRequest.motorRecommendedValue,$math.div($con.getMarkup(),100))) == $purchaseTemp.esumRequest.motorRecommendedValue)        
                            
                    #set($motorVehiclePremiumValue = "recomendedValue")        
                        	
                #end		
        #end		
        		
    #end		
    #set($ISMEngineNo = $purchaseTemp.esumRequest.motorEngine)
    #set($motorEngineNo = $purchaseTemp.motorEngineNo)
    #set($motorLoanProvider = $purchaseTemp.motorLoanProvider)
    #set($motorAddLegalLiabilityToPassengers = $purchaseTemp.motorAddLegalLiabilityToPassengers)
    #set($motorAddLegalLiabilityOfPassengers = $purchaseTemp.motorAddLegalLiabilityOfPassengers)
    #set($motorAddSpecialPerils = $purchaseTemp.motorAddSpecialPerils)
    #set($motorAddWindscreen = $purchaseTemp.motorAddWindscreen)
    #set($motorAddWindscreenSumInsured = $purchaseTemp.motorAddWindscreenSumInsured)
    #set($motorAddSRCC = $purchaseTemp.additionalCoverage.motorAddSRCC)
    #set($motorAddRiderPA = $purchaseTemp.additionalCoverage.motorAddRiderPA)
    #set($motorAddUnlimitedTowing = $purchaseTemp.additionalCoverage.motorAddUnlimitedTowing)
    #set($motorAddWaiverCompulsoryExcess = $purchaseTemp.additionalCoverage.motorAddWaiverCompulsoryExcess)
    #set($motorAddEHailing = $purchaseTemp.additionalCoverage.motorAddEHailing)
    #set($motorAddBetterment = $purchaseTemp.additionalCoverage.motorAddBetterment)
    #set($motorAddBettermentEndorsementCode = $purchaseTemp.additionalCoverage.motorAddBettermentEndorsement)
    #set($motorAddSmartKeyShield = $purchaseTemp.additionalCoverage.motorAddSmartKeyShield)
    #set($motorAddSmartKeyShieldSumInsured = $purchaseTemp.additionalCoverage.motorAddSmartKeyShieldSumInsured)
    #set($motorAddDriverPersonalAccident = $purchaseTemp.additionalCoverage.motorAddDriverPersonalAccident)
    #set($motorAddDriverPersonalAccidentSumInsured = $purchaseTemp.additionalCoverage.motorAddDriverPersonalAccidentSumInsured)   
    #set($motorAddLimitedSpecialPerils = $purchaseTemp.additionalCoverage.motorAddLimitedSpecialPerils)
    #set($motorAddNcdRelief = $purchaseTemp.additionalCoverage.motorAddNcdRelief)
    #if($purchaseTemp.additionalCoverage.motorAddDriverPersonalAccidentEndorsement == "PAMA")
        #set($additionalPlanA = "Y")
    #end
    #if($purchaseTemp.additionalCoverage.motorAddDriverPersonalAccidentEndorsement == "PAMB")
        #set($additionalPlanB = "Y")
    #end
    #if($purchaseTemp.additionalCoverage.motorAddDriverPersonalAccidentEndorsement == "PAMD")
        #set($additionalPlanC = "Y")
    #end
    #set($motorAddCART = $purchaseTemp.additionalCoverage.motorAddCART)
    #set($motorAddCARTSumInsured = $purchaseTemp.additionalCoverage.motorAddCARTSumInsured)
    #if($purchaseTemp.additionalCoverage.motorAddCARTEndorsement == "EC07")
        #set($additionalPlan07 = "Y")
    #end
    #if($purchaseTemp.additionalCoverage.motorAddCARTEndorsement == "EC14")
        #set($additionalPlan14 = "Y")
    #end
    #if($purchaseTemp.additionalCoverage.motorAddCARTEndorsement == "EC21")
        #set($additionalPlan21 = "Y")
    #end
    #if($purchaseTemp.additionalCoverage.motorPlusPlanEndorsement == "MMP1")
        #set($motorPlusPlan = "Y")
    #end
    #if($purchaseTemp.additionalCoverage.allRiderPlanEndorsement == "ALL")
        #set($allRiderPlan = "Y")
    #end
    #set($motorNxtNcdLevelParam = $number.toNumber($motorNxtNcdLevel).intValue())
  #end
#else  
  ## get from the parameter
  
  #set($policyHolderName = $request.getParameter('policyHolderName'))
  #set($policyHolderMalaysian = $request.getParameter('policyHolderMalaysian'))
  #if (!$UtilMethods.isSet($policyHolderMalaysian) || $policyHolderMalaysian == "Y")
    #set($policyHolderNric = $request.getParameter('policyHolderNRIC'))
  #else
    #set($policyHolderNric = $request.getParameter('policyHolderPassport'))
    #set($policyHolderGender = $request.getParameter('policyHolderGender'))
    #set($policyHolderDateOfBirth = $request.getParameter('policyHolderDateOfBirth'))
    #set($policyHolderNationality = $request.getParameter('policyHolderNationality'))
  #end
  #set($policyHolderMobileNo = $request.getParameter('policyHolderMobileNo'))
  #set($policyHolderMaritalStatus = $request.getParameter('policyHolderMaritalStatus'))
  #set($policyHolderEmail = $request.getParameter('policyHolderEmail'))
      <!--Tax invoice amend -->        
  #if ($product.formula == "pets")
      #set($policyHolderAddressLine1 = $request.getParameter('propertyAddressLine1'))        
      #set($policyHolderAddressLine2 = $request.getParameter('propertyAddressLine2'))
      #set($addressPostcode = $request.getParameter('propertyPostcode'))
      #set($addressState = $request.getParameter('propertyState'))
      #set($addressCity = $request.getParameter('propertyCity'))
      #set($addressOverwriteIndicator = $request.getParameter('addressOverwriteIndicator'))
  #else
      #set($policyHolderAddressLine1 = $request.getParameter('policyHolderAddressLine1'))    	
      #set($policyHolderAddressLine2 = $request.getParameter('policyHolderAddressLine2'))
      #set($refAddress1 = $request.getParameter('refAddress1'))
      #set($refAddress2 = $request.getParameter('refAddress2'))
      #set($addressPostcode = $request.getParameter('addressPostcode'))
      #set($addressState = $request.getParameter('addressState'))
      #set($addressCity = $request.getParameter('addressCity'))
      #set($addressOverwriteIndicator = $request.getParameter('addressOverwriteIndicator'))
  #end

  #set($propertyPostcode = $request.getParameter('propertyPostcode'))
  #set($propertyAddressLine1= $request.getParameter('propertyAddressLine1'))
  #set($propertyAddressLine2= $request.getParameter('propertyAddressLine2'))
  #set($propertyState = $request.getParameter('propertyState'))
  #set($propertyCity = $request.getParameter('propertyCity'))
  #set($studentId = $request.getParameter('studentId'))
  #set($staffId = $request.getParameter('staffId'))
  #set($staffRelationship = $request.getParameter('staffRelationship'))
  #set($campus = $request.getParameter('campus'))
  #set($policyHolderOccupation = $request.getParameter('policyHolderOccupation'))
  #set($photo = $request.getParameter('photo-tmp-img'))  

  #set($staffName = $request.getParameter('staffName_hidden'))
  #set($branchAbbr = $request.getParameter('branchCode'))
  #set($agentNumber = $request.getParameter('agentNumber'))
  
  #set($locationAddressLine1= $request.getParameter('locationAddressLine1'))
  #set($locationAddressLine2= $request.getParameter('locationAddressLine2'))

  #set($coveragePlan = $request.getParameter('coveragePlan'))
  #set($coverageStartDate = $request.getParameter('coverageStartDate'))
  #set($coverageExpiryDate = $request.getParameter('coverageExpiryDate'))
  #set($noDaysCovered = $request.getParameter('noDaysCovered'))
  #set($memberName = $request.getParameter('memberName'))
  #set($memberIdNo = $request.getParameter('memberIdNo'))
  #set($memberIsMalaysian = $request.getParameter('memberIsMalaysian'))
  #set($memberRelationship = $request.getParameter('memberRelationship'))
  #set($driverRelationship = $request.getParameter('driverRelationship'))
  #set($memberDOB = $request.getParameter('memberDOB'))
  #set($memberMotorDrivingExperience = $request.getParameter('memberMotorDrivingExperience'))
  #set($memberOccupation = $request.getParameter('memberOccupation'))
  
  #set($memberPetBreed = $request.getParameter('memberPetBreed'))
  #set($memberGender = $request.getParameter('memberGender'))
  #set($memberPetMicrochipId = $request.getParameter('memberPetMicrochipId'))
  #set($memberPhoto = $request.getParameter('memberPhoto-tmp-img'))  

  #set($hasUpgrade = $request.getParameter('hasUpgrade'))
  #set($errorMsg = $request.getParameter('errorMsg'))
  #set($destSelect = $request.getParameter('destSelect'))
  #set($travelPlan = $request.getParameter('travelPlan'))
  #set($travelArea = $request.getParameter('travelArea'))
  #set($travelBenefitPlan = $request.getParameter('travelBenefitPlan'))
  #set($prescreenYesNo = $request.getParameter('prescreenYesNo'))
  #set($prescreenYesNo2 = $request.getParameter('prescreenYesNo2'))
  #set($prescreenYesNo3 = $request.getParameter('prescreenYesNo3'))
  #set($prescreenYesNo4 = $request.getParameter('prescreenYesNo4'))
  #set($bmi = $request.getParameter('bmi'))
  #set($bmiHeight = $request.getParameter('bmiHeight'))
  #set($bmiWeight = $request.getParameter('bmiWeight'))
  
  
  #if ($product.formula == "motor")
    #set($certificateNo = $request.getParameter("certificateNo"))
    #set($motorRegistrationNo = $request.getParameter("motorRegistrationNo"))
    #set($motorChassisNo = $request.getParameter("motorChassisNo"))
    #set($dpfStatus = $request.getParameter("dpfStatus"))
    #set($motorMakeCode = $request.getParameter("motorMakeCode"))
    #set($motorModelCode = $request.getParameter("motorModelCode"))
	#set($enableCcDropDown = $request.getParameter("enableCcDropDown"))
    #set($motorCc = $request.getParameter("motorCc"))
    #set($motorYearOfMake = $request.getParameter("motorYearOfMake"))
    #set($motorVariant = $request.getParameter("motorVariant"))
    #set($motorSeat = $request.getParameter("motorSeat"))
    #set($motorStyle = $request.getParameter("motorStyle"))
    #set($motorTransmission = $request.getParameter("motorTransmission"))
    #set($motorFamily = $request.getParameter("motorFamily"))
    #foreach($con in $dotcontent.pull("+structureName:TieRefBancaMotorMake +(conhost:ceaa0d75-448c-4885-a628-7f0c35d374bd conhost:SYSTEM_HOST) +live:true",0,"TieRefBancaMotorMake.makeDescription"))
        #if($motorMakeCode == $con.makeCode && $productCode == $con.productCode)
         #set($motorMake = $con.makeDescription)
        #end
    #end
    #set($motorNcdCheckNRIC = $request.getParameter("motorNcdCheckNRIC"))
    #set($motorNcdCheckPassport = $request.getParameter("motorNcdCheckPasspor"))
    #set($motorNxtNcdLevel = $request.getParameter("motorNxtNcdLevel"))
    #set($motorNxtNcdEffDate = $request.getParameter("motorNxtNcdEffDate"))
    #set($motorCurNcdLevel = $request.getParameter("motorCurNcdLevel"))
    #set($motorCurNcdEffDate = $request.getParameter("motorCurNcdEffDate"))
    #set($motorCurNcdExpDate = $request.getParameter("motorCurNcdExpDate"))
    #set($motorDisplayNxtNcd = $request.getParameter("motorDisplayNxtNcd"))
    #set($motorNvic = $request.getParameter("motorNvic"))
    #set($motorVehicleLocation = $request.getParameter("motorVehicleLocation"))
	#set($motorVehicleLocationStateCode = $request.getParameter("motorVehicleLocationStateCode"))
    #set($motorVehiclePremiumValue = $request.getParameter("motorVehiclePremiumValue"))
    #set($motorSumInsured = $request.getParameter("motorSumInsured"))
    #set($ISMEngineNo = $request.getParameter("ISMEngineNo"))
    #set($motorEngineNo = $request.getParameter("motorEngineNo"))
    #set($motorLoanProvider = $request.getParameter("motorLoanProvider"))
    #set($motorAddLegalLiabilityToPassengers = $request.getParameter("motorAddLegalLiabilityToPassengers"))
    #set($motorAddLegalLiabilityOfPassengers = $request.getParameter("motorAddLegalLiabilityOfPassengers"))
    #set($motorAddSpecialPerils = $request.getParameter("motorAddSpecialPerils"))
    #set($motorAddWindscreen = $request.getParameter("motorAddWindscreen"))
    #set($motorAddWindscreenSumInsured = $request.getParameter("motorAddWindscreenSumInsured"))
    #set($motorAddSRCC = $request.getParameter("motorAddSRCC"))
    #set($motorAddRiderPA = $request.getParameter("motorAddRiderPA"))
    #set($motorAddUnlimitedTowing = $request.getParameter("motorAddUnlimitedTowing"))
    #set($motorAddWaiverCompulsoryExcess = $request.getParameter("motorAddWaiverCompulsoryExcess"))
    #set($motorAddEHailing = $request.getParameter("motorAddEHailing"))
    #set($motorAddBetterment = $request.getParameter("motorAddBetterment"))
    #set($motorAddBettermentEndorsementCode = $request.getParameter("motorAddBettermentEndorsementCode"))
    #set($motorAddSmartKeyShield = $request.getParameter("motorAddSmartKeyShield"))
    #set($motorAddSmartKeyShieldSumInsured = $request.getParameter("motorAddSmartKeyShieldSumInsured"))
    #set($motorAddDriverPersonalAccident = $request.getParameter("motorAddDriverPersonalAccident"))
    #set($motorAddDriverPersonalAccidentSumInsured = $request.getParameter("motorAddDriverPersonalAccidentSumInsured"))
    #set($motorAddLimitedSpecialPerils = $request.getParameter("motorAddLimitedSpecialPerils"))
    #set($motorAddNcdRelief = $request.getParameter("motorAddNcdRelief"))
    #set($additionalPlanA = $request.getParameter("additionalPlanA"))
    #set($additionalPlanB = $request.getParameter("additionalPlanB"))
    #set($additionalPlanC = $request.getParameter("additionalPlanC"))
    #set($motorNxtNcdLevelParam = $number.toNumber($motorNxtNcdLevel).intValue())
    #set($motorAddCART = $request.getParameter("motorAddCART"))
    #set($motorAddCARTSumInsured = $request.getParameter("motorAddCARTSumInsured"))
    #set($additionalPlan07 = $request.getParameter("additionalPlan07"))
    #set($additionalPlan14 = $request.getParameter("additionalPlan14"))
    #set($additionalPlan21 = $request.getParameter("additionalPlan21"))
    #set($motorPlusPlan = $request.getParameter("motorPlusPlan"))
    #set($allRiderPlan = $request.getParameter("allRiderPlan"))
	#set($flexiPlan = $request.getParameter("flexiPlan"))
    #set($motorLoanProviderDescription = $request.getParameter("motorLoanProviderDescription")) 
    
  #end
#end  

## Fix chinese punctuations
    #set($punctuations = [["，",","],["！","!"],["、",","],["。","."],["‘","'"],["’","'"],["：",":"],["；",";"],["（","("],["）",")"],["“","\""],["”","\""],["？","?"]])
    #foreach($punctuation in $punctuations)
        #set($policyHolderAddressLine1 = $policyHolderAddressLine1.replace($punctuation[0],$punctuation[1]))
        #set($policyHolderAddressLine2 = $policyHolderAddressLine2.replace($punctuation[0],$punctuation[1]))
        #set($propertyAddressLine1 = $propertyAddressLine1.replace($punctuation[0],$punctuation[1]))
        #set($propertyAddressLine2 = $propertyAddressLine2.replace($punctuation[0],$punctuation[1]))
        #set($policyHolderNric = $policyHolderNric.replace($punctuation[0],$punctuation[1]))
        #set($memberIdNo = $memberIdNo.replace($punctuation[0],$punctuation[1]))
    #end
    
## data from contentlets
  #if($product.bancaProduct)
    #foreach($con in $dotcontent.pull("+structureName:TieRefCity +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST)+TieRefCity.postcode:${propertyPostcode}",1,"TieRefCity.cityDescription"))
      #set($townCityName = $con)
    #end  
    ##foreach($con in $dotcontent.pull("+structureName:TieRefCity +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieRefCity.cityCode:${addressCity}",1,"modDate desc"))
      ##set($refCity = $con)
    ##end
     #foreach($con in $dotcontent.pull("+structureName:TieRefCity +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieRefCity.postcode:${addressPostcode}",1,"modDate desc"))
      #set($refCity = $con)
    #end
    #set($querystate = $refCity.stateCode.replace('-','\-'))
    #foreach($con in $dotcontent.pull("+structureName:TieRefState +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieRefState.stateCode:${querystate}",10,"modDate desc"))
      #set($refState = $con)
    #end
  #end

  #if ($product.formula == "motor")
    #foreach($con in $dotcontent.pull("+structureName:TieRefBancaLoanProvider +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieRefBancaLoanProvider.financeCode:${motorLoanProvider}",1,"modDate desc"))
      #set($refLoanProvider = $con)
    #end
    
    ## calculate motor premium
    #if (!$UtilMethods.isSet($motorPlusPlan))
        #set($motorPlusPlanParam = false)
    #else
        #set($motorPlusPlanParam = true)
    #end
    #if (!$UtilMethods.isSet($allRiderPlan))
        #set($allRiderPlanParam = false)
    #else
        #set($allRiderPlanParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddLegalLiabilityToPassengers))
        #set($motorAddLegalLiabilityToPassengersParam = false)
    #else
        #set($motorAddLegalLiabilityToPassengersParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddLegalLiabilityOfPassengers))
        #set($motorAddLegalLiabilityOfPassengersParam = false)
    #else
        #set($motorAddLegalLiabilityOfPassengersParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddSpecialPerils))
        #set($motorAddSpecialPerilsParam = false)
    #else
        #set($motorAddSpecialPerilsParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddWindscreen))
        #set($motorAddWindscreenParam = false)
    #else
        #set($motorAddWindscreenParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddWindscreenSumInsured))
        #set($motorAddWindscreenSumInsured = 0)
    #else
        #set($motorAddWindscreenSumInsured = $number.toNumber($motorAddWindscreenSumInsured).intValue())
    #end
    #if (!$UtilMethods.isSet($motorAddSRCC))
        #set($motorAddSRCCParam = false)
    #else
        #set($motorAddSRCCParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddRiderPA))
        #set($motorAddRiderPAParam = false)
    #else
        #set($motorAddRiderPAParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddUnlimitedTowing))
        #set($motorAddUnlimitedTowingParam = false)
    #else
        #set($motorAddUnlimitedTowingParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddWaiverCompulsoryExcess))
        #set($motorAddWaiverCompulsoryExcessParam = false)
    #else
        #set($motorAddWaiverCompulsoryExcessParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddEHailing))
        #set($motorAddEHailingParam = false)
    #else
        #set($motorAddEHailingParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddBetterment))
        #set($motorAddBettermentParam = false)
    #else
        #set($motorAddBettermentParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddSmartKeyShield))
        #set($motorAddSmartKeyShieldParam = false)
    #else
        #set($motorAddSmartKeyShieldParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddLimitedSpecialPerils))        
        #set($motorAddLimitedSpecialPerilsParam = false)		
    #else		
        #set($motorAddLimitedSpecialPerilsParam = true)		
    #end
     #if (!$UtilMethods.isSet($motorAddNcdRelief))        
        #set($motorAddNcdReliefParam = false)    	
    #else		
        #set($motorAddNcdReliefParam = true)		
    #end
    #if (!$UtilMethods.isSet($motorAddSmartKeyShieldSumInsured))
        #set($motorAddSmartKeyShieldSumInsured = 0)
    #else
        #set($motorAddSmartKeyShieldSumInsured = $number.toNumber($motorAddSmartKeyShieldSumInsured).intValue())
    #end
    #if (!$UtilMethods.isSet($motorAddDriverPersonalAccident))
        #set($motorAddDriverPersonalAccidentParam = false)
    #else
        #set($motorAddDriverPersonalAccidentParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddDriverPersonalAccidentSumInsured))
        #set($motorAddDriverPersonalAccidentSumInsured = 0)
    #else
        #set($motorAddDriverPersonalAccidentSumInsured = $number.toNumber($motorAddDriverPersonalAccidentSumInsured).intValue())
    #end
    #if (!$UtilMethods.isSet($motorAddCART))
        #set($motorAddCARTParam = false)
    #else
        #set($motorAddCARTParam = true)
    #end
    #if (!$UtilMethods.isSet($motorAddCARTSumInsured))
        #set($motorAddCARTSumInsured = 0)
    #else
        #set($motorAddCARTSumInsured = $number.toNumber($motorAddCARTSumInsured).intValue())
    #end
  #end
  #if ($product.formula == "critical-illness")
    #if (!$UtilMethods.isSet($policyHolderMalaysian) || $policyHolderMalaysian == "Y")
      #set($tempDate = $CmsSettingUtil.extractDOB($policyHolderNric))
      #set($policyHolderGender = $CmsSettingUtil.genderCodeFromNRIC($policyHolderNric))
    #else
      #set($tempDate = $CmsSettingUtil.convertStringToDate($policyHolderDateOfBirth, "dd/MM/yyyy"))
    #end
    #set($policyHolderAgeByYearOfBirth = $CmsSettingUtil.ageByYearOfBirth($tempDate))
  #end
  
  #if ($productExtended.getAllowMotorPlusPlan() == "Y" || $product.productName == "Motorcycle")
    #set($policyHolderGender = $CmsSettingUtil.genderCodeFromNRIC($policyHolderNric))
    #set ($tempMembersMotorDrivingExperience = $memberMotorDrivingExperience.split(","))
    #set($policyHolderDrivingExp = $tempMembersMotorDrivingExperience[0])
  #end

  ## perform complete calculation
  #set($purchaseForm = $wlputil.newPurchaseForm())
  #set($dummy = $purchaseForm.setCertificateNo($certificateNo))
  #set($dummy = $purchaseForm.setGstRate($destSelect))
  #set($dummy = $purchaseForm.setSstRate($destSelect))
  #set($dummy = $purchaseForm.setProductCode($productCode))
  #set($dummy = $purchaseForm.setProductName($productName))
  #set($dummy = $purchaseForm.setPartnerCode($partnerCode))
  #set($dummy = $purchaseForm.setPolicyHolderMalaysian($policyHolderMalaysian))
  #set($dummy = $purchaseForm.setPolicyHolderNRIC($policyHolderNric))
  #set($dummy = $purchaseForm.setPolicyHolderDateOfBirth($policyHolderDateOfBirth))
  #set($dummy = $purchaseForm.setPolicyHolderGender($policyHolderGender))
  #set($dummy = $purchaseForm.setPolicyHolderMaritalStatus($policyHolderMaritalStatus))
  #set($dummy = $purchaseForm.setPhoto($photo))  
  #set($dummy = $purchaseForm.setMemberName($memberName))
  #set($dummy = $purchaseForm.setMemberIdNo($memberIdNo))
  #set($dummy = $purchaseForm.setMemberIsMalaysian($memberIsMalaysian))
  #set($dummy = $purchaseForm.setMemberRelationship($memberRelationship))
  #set($dummy = $purchaseForm.setDriverRelationship($driverRelationship))
  #set($dummy = $purchaseForm.setMemberDOB($memberDOB))
  #set($dummy = $purchaseForm.setMemberOccupation($memberOccupation))
  #set($dummy = $purchaseForm.setMemberGender($memberGender))
  
  #if ($product.formula == "pets")
    #set($dummy = $purchaseForm.setMemberPetBreed($memberPetBreed))
    #set($dummy = $purchaseForm.setmemberPetMicrochipId($memberPetMicrochipId))
    #set($dummy = $purchaseForm.setMemberPhoto($memberPhoto))  
  #end
  #set($dummy = $purchaseForm.setMemberMotorDrivingExperience($memberMotorDrivingExperience))
  #set($dummy = $purchaseForm.setCoverageStartDate($coverageStartDate))
  #set($dummy = $purchaseForm.setCoverageExpiryDate($coverageExpiryDate))
  #set($dummy = $purchaseForm.setTravelPlan($travelPlan))
  #set($dummy = $purchaseForm.setTravelArea($travelArea))
  #set($dummy = $purchaseForm.setCoveragePlan($coveragePlan))
  #set($dummy = $purchaseForm.setTravelBenefitPlan($travelBenefitPlan))
   <!--Tax invoice amend -->        
  #set($dummy = $purchaseForm.setPolicyHolderAddressLine1($policyHolderAddressLine1))		
  #set($dummy = $purchaseForm.setPolicyHolderAddressLine2($policyHolderAddressLine2))
  #set($dummy = $purchaseForm.setAddressCity($addressCity))
  #set($dummy = $purchaseForm.setAddressOverwriteIndicator($addressOverwriteIndicator))
  #set($dummy = $purchaseForm.setAddressState($addressState))
  #set($dummy = $purchaseForm.setAddressPostcode($addressPostcode))
  #set($dummy = $purchaseForm.setPropertyCity($propertyCity))
  #set($dummy = $purchaseForm.setPropertyState($propertyState))
  #set($dummy = $purchaseForm.setPropertyPostcode($propertyPostcode))
  #set($dummy = $purchaseForm.setStudentId($studentId))
  #set($dummy = $purchaseForm.setStaffId($staffId))
  #set($dummy = $purchaseForm.setStaffRelationship($staffRelationship))
  #set($dummy = $purchaseForm.setCampus($campus))
  #set($dummy = $purchaseForm.setMotorNvic($motorNvic))
  #set($dummy = $purchaseForm.setMotorChassisNo($motorChassisNo))
  #set($dummy = $purchaseForm.setDpfStatus($dpfStatus))
  #set($dummy = $purchaseForm.setMotorRegistrationNo($motorRegistrationNo))
  #set($dummy = $purchaseForm.setMotorModelCode($motorModelCode))
  #set($dummy = $purchaseForm.setMotorMakeCode($motorMakeCode))
  #set($dummy = $purchaseForm.setMotorCc($webapi.parseInt($motorCc)))
  #set($dummy = $purchaseForm.setMotorYearOfMake($webapi.parseInt($motorYearOfMake)))
  #set($dummy = $purchaseForm.setMotorStyle($motorStyle))
  #set($dummy = $purchaseForm.setMotorSeat($motorSeat))
  #set($dummy = $purchaseForm.setMotorVariant($motorVariant))
  #set($dummy = $purchaseForm.setMotorTransmission($motorTransmission))
  #set($dummy = $purchaseForm.setMotorFamily($motorFamily))
  #set($dummy = $purchaseForm.setMotorMake($motorMake))
  #set($dummy = $purchaseForm.setMotorNxtNcdLevel($motorNxtNcdLevelParam))
  #set($dummy = $purchaseForm.setMotorVehicleLocation($motorVehicleLocation))
  #set($dummy = $purchaseForm.setMotorVehicleLocationStateCode($motorVehicleLocationStateCode))
  #set($dummy = $purchaseForm.setMotorVehiclePremiumValue($motorVehiclePremiumValue))
  #set($dummy = $purchaseForm.setMotorPlusPlan($motorPlusPlan))
  #set($dummy = $purchaseForm.setMotorAddLegalLiabilityOfPassengers($motorAddLegalLiabilityOfPassengers))
  #set($dummy = $purchaseForm.setMotorAddLegalLiabilityToPassengers($motorAddLegalLiabilityToPassengers))
  #set($dummy = $purchaseForm.setMotorAddSpecialPerils($motorAddSpecialPerils))
  #set($dummy = $purchaseForm.setMotorAddLimitedSpecialPerils($motorAddLimitedSpecialPerils))
  #set($dummy = $purchaseForm.setMotorAddNcdRelief($motorAddNcdRelief))
  #set($dummy = $purchaseForm.setMotorAddWindscreen($motorAddWindscreen))
  #set($dummy = $purchaseForm.setMotorAddWindscreenSumInsured($motorAddWindscreenSumInsured))
  #set($dummy = $purchaseForm.setMotorAddSRCC($motorAddSRCC))
  #set($dummy = $purchaseForm.setMotorAddRiderPA($motorAddRiderPA))
  #set($dummy = $purchaseForm.setMotorAddUnlimitedTowing($motorAddUnlimitedTowing))
  #set($dummy = $purchaseForm.setMotorAddWaiverCompulsoryExcess($motorAddWaiverCompulsoryExcess))
  #set($dummy = $purchaseForm.setMotorAddEHailing($motorAddEHailing))
  #set($dummy = $purchaseForm.setMotorAddBetterment($motorAddBetterment))
  #set($dummy = $purchaseForm.setMotorAddBettermentEndorsementCode($motorAddBettermentEndorsementCode))
  #set($dummy = $purchaseForm.setMotorAddSmartKeyShield($motorAddSmartKeyShield))
  #set($dummy = $purchaseForm.setMotorAddSmartKeyShieldSumInsured($motorAddSmartKeyShieldSumInsured))
  #set($dummy = $purchaseForm.setMotorAddDriverPersonalAccident($motorAddDriverPersonalAccident))
  #set($dummy = $purchaseForm.setMotorAddDriverPersonalAccidentSumInsured($motorAddDriverPersonalAccidentSumInsured))
  #set($dummy = $purchaseForm.setAdditionalPlanA($additionalPlanA))
  #set($dummy = $purchaseForm.setAdditionalPlanB($additionalPlanB))
  #set($dummy = $purchaseForm.setAdditionalPlanC($additionalPlanC))
  #set($dummy = $purchaseForm.setMotorAddCART($motorAddCART))
  #set($dummy = $purchaseForm.setMotorAddCARTSumInsured($motorAddCARTSumInsured))
  #set($dummy = $purchaseForm.setAdditionalPlan07($additionalPlan07))
  #set($dummy = $purchaseForm.setAdditionalPlan14($additionalPlan14))
  #set($dummy = $purchaseForm.setAdditionalPlan21($additionalPlan21))
  #set($dummy = $purchaseForm.setMotorPlusPlan($motorPlusPlan))
  #set($dummy = $purchaseForm.setAllRiderPlan($allRiderPlan))
  #set($dummy = $purchaseForm.setStaffName($staffName))
  #set($dummy = $purchaseForm.setBranchAbbr($branchAbbr))
  #set($dummy = $purchaseForm.setAgentNumber($agentNumber))
  #set($premiumCalculationResult = $wlputil.calculatePremium($purchaseForm))
  #set($motorCalculationResult = $premiumCalculationResult)
  #set($motorAdditonalDriver = $premiumCalculationResult.additionalDriver)
  #set($motorAdditonalDriverPremium = $premiumCalculationResult.additionalDriverPremium)
  
  
#if($product.formula == "critical-illness" || $product.formula == "home-content" )
  #set ($count = 0)
  #set ($memberCount = 0)
#end

#set($actionAddOnURL = "")
#if($branch.length() > 0 || $isInIframe=='true')
  #set($actionAddOnURL = "?")
  #if($branch.length() > 0)
        #set($actionAddOnURL = $actionAddOnURL + "branch=" + $branch)
  #end
  #if($isInIframe=='true')
    #if($branch.length() > 0)
      #set($actionAddOnURL = $actionAddOnURL + "&isInIframe=true")
    #else
      #set($actionAddOnURL = $actionAddOnURL + "isInIframe=true")
    #end
  #end
#end

#if ($product.getProductName() == 'Motorcycle')
    #set($m3paStage = "summary")
    #dotParse('//msiginternal/vtl/widgets/product/m3pa/m3pa-form.vtl')
    #stop
#end

<form name="summaryForm" method="post" class="#if(($partnerCode == 'msig') && $product.formula == 'motor') tieMotor #end">
  <input type="hidden" value="processPurchase" name="action" />
  <input type="hidden" value="Step2" name="actionType" />
  <input type="hidden" value="$!esc.html(${partnerCode})" name="partnerCode" />
  <input type="hidden" value="$!esc.html(${productCode})" name="productCode" />
  <input type="hidden" value="${product.getProductName()}" name="productName" />
  <input type="hidden" value="$!esc.html($!{prescreenYesNo})" name="prescreenYesNo" />
  <input type="hidden" name="staffRelationship" value="$!esc.html($!staffRelationship)">
  <input type="hidden" name="isInIframe" value="${isInIframe}">
  #if($product.formula == "critical-illness")
  <input type="hidden" value="$!esc.html($!{bmi})" name="bmi" />
  <input type="hidden" value="$!esc.html($!{bmiHeight})" name="bmiHeight" />
  <input type="hidden" value="$!esc.html($!{bmiWeight})" name="bmiWeight" />
  <input type="hidden" value="$!esc.html($!{prescreenYesNo2})" name="prescreenYesNo2" />
  <input type="hidden" value="$!esc.html($!{prescreenYesNo3})" name="prescreenYesNo3" />
  <input type="hidden" value="$!esc.html($!{prescreenYesNo4})" name="prescreenYesNo4" />  
  #end
  <input type="hidden" value="$!esc.html($destSelect)" name="gstRate" />
  <input type="hidden" value="$!esc.html($destSelect)" name="sstRate" />
  <input type="hidden" value="$!esc.html($destSelect)" name="destSelect" />
  <input type="hidden" value="$!esc.html($!product.formula)" name="formula" id="formula" />
  #if ($product.formula == "motor")
    <input type="hidden" name="certificateNo" value="$!esc.html($!certificateNo)">
    <input type="hidden" name="motorRegistrationNo" value="$!esc.html($!motorRegistrationNo)">
    <input type="hidden" name="motorChassisNo" value="$!esc.html($!motorChassisNo)">
    <input type="hidden" name="dpfStatus" value="$!esc.html($!dpfStatus)">
    <input type="hidden" name="motorMakeCode" value="$!esc.html($!motorMakeCode)">
    <input type="hidden" name="motorModelCode" value="$!esc.html($!motorModelCode)">
	<input type="hidden" name="enableCcDropDown" value="$!esc.html($!enableCcDropDown)">
    <input type="hidden" name="motorCc" value="$!esc.html($!motorCc)">
    <input type="hidden" name="motorYearOfMake" value="$!esc.html($!motorYearOfMake)">
    <input type="hidden" name="motorStyle" value="$!esc.html($!motorStyle)">
    <input type="hidden" name="motorSeat" value="$!esc.html($!motorSeat)">
    <input type="hidden" name="motorVariant" value="$!esc.html($!motorVariant)">
    <input type="hidden" name="motorTransmission" value="$!esc.html($!motorTransmission)">
    <input type="hidden" name="motorFamily" value="$!esc.html($!motorFamily)">
    <input type="hidden" name="motorMake" value="$!esc.html($!motorMake)">
    <input type="hidden" name="motorNxtNcdLevel" value="$!esc.html($!motorNxtNcdLevel)">
    <input type="hidden" name="motorNxtNcdEffDate" value="$!esc.html($!motorNxtNcdEffDate)">
    <input type="hidden" name="motorCurNcdLevel" value="$!esc.html($!motorCurNcdLevel)">
    <input type="hidden" name="motorCurNcdEffDate" value="$!esc.html($!motorCurNcdEffDate)">
    <input type="hidden" name="motorCurNcdExpDate" value="$!esc.html($!motorCurNcdExpDate)">
    <input type="hidden" name="motorNvic" value="$!esc.html($!motorNvic)">
    <input type="hidden" name="motorVehicleLocation" value="$!esc.html($!motorVehicleLocation)">
	<input type="hidden" name="motorVehicleLocationStateCode" value="$!esc.html($!motorVehicleLocationStateCode)">
    <input type="hidden" name="motorVehiclePremiumValue" value="$!esc.html($!motorVehiclePremiumValue)">
    <input type="hidden" name="motorDisplayNxtNcd" value="$!esc.html($!motorDisplayNxtNcd)">
    <input type="hidden" name="motorSumInsured" value="$!esc.html($!motorSumInsured)">
    <input type="hidden" name="ISMEngineNo" value="$!esc.html($!ISMEngineNo)">
    <input type="hidden" name="motorEngineNo" value="$!esc.html($!motorEngineNo)">
    <input type="hidden" name="motorLoanProvider" value="$!esc.html($!motorLoanProvider)">
	<input type="hidden" name="motorLoanProviderDescription" value="$!esc.html($!motorLoanProviderDescription)">
    <input type="hidden" name="motorAddLegalLiabilityToPassengers" value="$!esc.html($!motorAddLegalLiabilityToPassengers)">
    <input type="hidden" name="motorAddLegalLiabilityOfPassengers" value="$!esc.html($!motorAddLegalLiabilityOfPassengers)">
    <input type="hidden" name="motorAddSpecialPerils" value="$!esc.html($!motorAddSpecialPerils)">
    <input type="hidden" name="motorAddWindscreen" value="$!esc.html($!motorAddWindscreen)">
    <input type="hidden" name="motorAddWindscreenSumInsured" value="$!esc.html($!motorAddWindscreenSumInsured)">
    <input type="hidden" name="motorAddSRCC" value="$!esc.html($!motorAddSRCC)">
    <input type="hidden" name="motorAddRiderPA" value="$!esc.html($!motorAddRiderPA)">
    <input type="hidden" name="motorAddUnlimitedTowing" value="$!esc.html($!motorAddUnlimitedTowing)">
    <input type="hidden" name="motorAddWaiverCompulsoryExcess" value="$!esc.html($!motorAddWaiverCompulsoryExcess)">
    <input type="hidden" name="motorAddEHailing" value="$!esc.html($!motorAddEHailing)">
    <input type="hidden" name="motorAddOnEHailing" value="$!esc.html($!request.getParameter('motorAddOnEHailing'))">
    <input type="hidden" name="motorAddBetterment" value="$!esc.html($!motorAddBetterment)">
    <input type="hidden" name="motorAddBettermentEndorsementCode" value="$!esc.html($!motorAddBettermentEndorsementCode)">
    <input type="hidden" name="motorAddSmartKeyShield" value="$!esc.html($!motorAddSmartKeyShield)">
    <input type="hidden" name="motorAddSmartKeyShieldSumInsured" value="$!esc.html($!motorAddSmartKeyShieldSumInsured)">
    <input type="hidden" name="motorAddDriverPersonalAccident" value="$!esc.html($!motorAddDriverPersonalAccident)">
    <input type="hidden" name="motorAddDriverPersonalAccidentSumInsured" value="$!esc.html($!motorAddDriverPersonalAccidentSumInsured)">
    <input type="hidden" name="motorAdditonalDriver" value="$!esc.html($!{motorAdditonalDriver})">
    <input type="hidden" name="motorAdditonalDriverPremium" value="$!esc.html($!{motorAdditonalDriverPremium})">
    <input type="hidden" name="motorAddLimitedSpecialPerils" value="$!esc.html($!motorAddLimitedSpecialPerils)">
 	<input type="hidden" name="motorAddNcdRelief" value="$!esc.html($!motorAddNcdRelief)">
	<input type="hidden" name="motorPlusPlan" value="$!esc.html($!motorPlusPlan)">
	<input type="hidden" name="allRiderPlan" value="$!esc.html($!allRiderPlan)">
	<input type="hidden" name="flexiPlan" value="$!esc.html($!flexiPlan)">
    <input type="hidden" name="additionalPlanA" value="$!esc.html($!{additionalPlanA})">
    <input type="hidden" name="additionalPlanB" value="$!esc.html($!{additionalPlanB})">
    <input type="hidden" name="additionalPlanC" value="$!esc.html($!{additionalPlanC})">
    <input type="hidden" name="motorAddCART" value="$!esc.html($!motorAddCART)">
    <input type="hidden" name="motorAddCARTSumInsured" value="$!esc.html($!motorAddCARTSumInsured)">
    <input type="hidden" name="additionalPlan07" value="$!esc.html($!{additionalPlan07})">
    <input type="hidden" name="additionalPlan14" value="$!esc.html($!{additionalPlan14})">
    <input type="hidden" name="additionalPlan21" value="$!esc.html($!{additionalPlan21})">
    
  #end
  
  
  <div class="main-container">
     #dotParse("//msiginternal/vtl/widgets/product/productTop.vtl")
	 #if($productExtended.getAllowMotorPlusPlan() == "Y" || $product.productName == "Motorcycle")
    <style type="text/css">
        @media only screen and (min-width: 992px){
            .wrapper{
        		padding: 0 15%;
        	}
            #splitCol{
                max-width: 1000px;
            }
        }
        
        input[type="radio"]:checked+label{
        	background: url(../../img/inputDotYes.png) 0% 0% no-repeat scroll transparent;
        }
        input[type="radio"]+label{
        	background: url(../../img/inputDotNon.png) 0% 0% no-repeat scroll transparent;
        }
    </style>
    #end
    <div #if($productExtended.getAllowMotorPlusPlan().equals("Y") || $product.productName == "Motorcycle") id='mmpSummaryWrapper' #end class="main wrapper clearfix">
      #if($partnerURLTitle != "msig" && $partnerURLTitle != "mcp" && $productExtended.getAllowMotorPlusPlan() != 'Y' && $product.productName != "Motorcycle")
      <div class="helpSummary helpContent whilePrompt clearfix hidden">
        <span class="promptTail"></span>
        <h1>Please check your information before proceeding to make your payment.</h1>
        
        <a href="" class="button">Ok, got it.</a>
      </div>
      #end
	  #if(!$productExtended.getAllowMotorPlusPlan().equals("Y") && $product.productName != "Motorcycle")
      <div class="pageIntro">
        <h1>Plan Summary</h1>
      </div>
	  #end
       ## Loading Screen for Summary , mainly is for Motor, For Now
    <div class="progress-checking hidden">
        <div class="progress-loading-icon"></div>
        <h1>Please Wait.....</h1>
    </div>
## Loading Screen Ended

	#if($productExtended.getAllowMotorPlusPlan().equals("Y") || $product.productName == "Motorcycle")
	
		<ul id="splitCol" class="accordianStack accordian planSummary" style="box-shadow: none; background-color: transparent;" >
        
            <div class="motorNewSummaryPage">
                <!-- Motor Plus Plan Car Details Section -->
                <div class="motorplus-section" >
                    <li class="#if(($partnerCode == 'msig') && $product.formula == 'motor') tieMotor-title #end">
        				<div class="form-title">
    						<p>#if($product.productName == "Motorcycle") Motorcycle Details #else Car Details #end <!--<span class="toolTip"><span class="toolTipText">You can purchase Motor Insurance online for vehicles 15 years old and below.</span></span>--></p>
    					</div>
    				</li>
    				<li>
    					<div class="" name="displayField-left">
    						<h4>#if($product.productName == "Motorcycle") Motorcycle Registration No.: #else Car Registration No.: #end</h4>
    						<strong>$!motorRegistrationNo</strong>
    					</div>
    					<div class="" name="displayField-right">
    						<h4>#if($product.productName == "Motorcycle") Year of Motorcycle: #else Year of Make: #end</h4>
    						<strong>$!motorYearOfMake</strong>
    					</div>
    				</li>
    				<li>
    					<div class="" name="displayField-left">
    						<h4>#if($product.productName == "Motorcycle") Motorcycle Make: #else Car Make: #end</h4>
    						<strong>$!motorMake</strong>
    					</div>
    					<div class="" name="displayField-right">
    						<h4>#if($product.productName == "Motorcycle") Motorcycle Model: #else Car Model: #end</h4>
    						<strong>$!motorFamily</strong>
    					 </div>
    				</li>
                    ##<li style="padding: 0px 28px 40px 28px;">
                    <li>
                      <div class="carInfoCubicCapacitySection" name="displayField-left">
            			<h4>Cubic Capacity:</h4>
    					<strong>$!motorCc</strong>
    				  </div>
    				  <div class="carInfoSpecificationSection" name="displayField-right">
    					<h4>Variant:</h4>
    					<strong>$!motorVariant $!motorStyle $!ISMEngineNo $!motorTransmission  </strong>
    				  </div>
    				</li>
    				<li>
    					<div class="" name="displayField-left">
    						<h4>Engine No.:</h4>
    						<strong>$!motorEngineNo</strong>
    					</div>
    					<div class="" name="displayField-right">
    						<h4>Chassis No.:</h4>
    						<strong>$!motorChassisNo</strong>
    					</div>
    				</li>
    				<!--<li>
    					<div class="carInfoLocationSection" name="displayField-left">
    						<h4>#if($product.productName == "Motorcycle") Motorcycle Location: #else Car Location: #end</h4>
    						<strong>#if ($motorVehicleLocation == "em") East Malaysia #else West Malaysia #end</strong>
    					</div>
    				#if ($!refLoanProvider.financeName)				  
    					<div class="carInfoLoanProviderSection" name="displayField-right">
    						<h4>Loan Provider:</h4>
    						<strong>$!refLoanProvider.financeName</strong>
    					</div>
    				#end
    				</li>-->
					
					#foreach($con in $dotcontent.pull("+structureName:TieRefState +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieRefState.vpmsStateCode:${motorVehicleLocation}",1,"TieRefState.stateDescription"))
						#set($motorState = $con)
					#end
					<li>
    					<div class="carInfoLocationSectionStateCode" name="displayField-left">
    						<h4>#if($product.productName == "Motorcycle") Motorcycle Location #else Car Location #end :</h4>
    						<strong>$motorState.stateDescription</strong>
    					</div>
						
    				#if ($!refLoanProvider.financeName)				  
    					<div class="carInfoLoanProviderSection" name="displayField-right">
    						<h4>Loan Provider:</h4>
    						<strong>$!refLoanProvider.financeName</strong>
    					</div>
    				#end
    				</li>
					
					
					#foreach($con in $dotcontent.pull("+structureName:TieRefState%20+(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieRefState.vpmsStateCode:${motorVehicleLocation}",1,"TieRefState.stateDescription"))
						#set($motorVpmsState = $con)
					#end
					<li style="display:none">
    					<div class="carInfoLocationSection">
    						<h4>#if($product.productName == "Motorcycle") Motorcycle Location Vpms Code #else Car Location Vpms Code #end :</h4>
    						<strong>$motorVpmsState.stateDescription</strong>
    					</div>
    				</li>
			
    				<li>
    					<div style="text-align: right;" class="carReview">
    						<button type="button" id="editBtn" class="carInfoEditBtn" onclick="editCarInfoSection()"><span class="editIcon"><i class="material-icons">mode_edit</i></span><span class="btnWording">Edit</span></button>
    						<button type="button" id="saveBtn" class="carInfoSaveBtn" onclick="saveCarInfoSection()" hidden>Save</button>
    					</div>
    				</li>
                </div>
                <!-- Motor Plus Plan Car Details Section End -->
                
                <!-- Motor Plus Plan Driver Details Section -->
                <div class="motorplus-section">
        			<li>
    					<div class="form-title">
    						<p>#if($product.productName == "Motorcycle") Rider Details #else Driver Details Info #end <!--<span class="toolTip"><span class="toolTipText">You can purchase Motor Insurance online for vehicles 15 years old and below.</span></span>--></p>
    					</div>
    				</li>
					
					#if (!$UtilMethods.isSet($policyHolderMalaysian) || $policyHolderMalaysian == "Y")
					    <li>
                            <div class="policyHolderNameSection" name="displayField-left">
                                <h4>Name (as per NRIC):</h4>
                                <strong>$!policyHolderName</strong>
                            </div>
                            <div class="" name="displayField-right">
                                <h4>NRIC No.:</h4>
                                <strong>$!policyHolderNric</strong>
                            </div>
						</li>
					#else
                        <li>
                            <div class="policyHolderNameSection" name="displayField-left">
                                <h4>Name (as per Passport):</h4>
                                <strong>$!policyHolderName</strong>
                            </div>
                            <div class="" name="displayField-right">
                                <h4>Passport No.:</h4>
                                <strong>$!policyHolderNric</strong>
                            </div>
                        </li>
					#end
                        <li>
                            <div class="policyHolderEmailSection" name="displayField-left">
                                <h4>Email:</h4>
                                <strong>$!policyHolderEmail</strong>
                            </div>
                            <div class="policyHolderMobileNoSection" name="displayField-right">
                                <h4>Mobile No.:</h4>
                                <strong>$!policyHolderMobileNo</strong>
                            </div>
                        </li>
												
						#if ($UtilMethods.isSet($memberName))
							#set ($members = $memberName.split(","))
							#set ($mainMotorDrivingExperience = $memberMotorDrivingExperience.split(","))
							#set ($mainOccupation = $memberOccupation.split(","))   
							#set ($mainGender = $memberGender.split(","))
						#end
						#if ($UtilMethods.isSet($members) && $members.size() > 0)
					
                    #if (!$UtilMethods.isSet($policyHolderMalaysian) || $policyHolderMalaysian == "Y")
						<li>
                            <div class="policyHolderAddressSection" name="displayField-left">
                                <h4>Address:</h4>
                                <strong>$policyHolderAddressLine1 $policyHolderAddressLine2 $addressPostcode</strong>
                            </div>
                            <div class="policyHolderGenderSection" name="displayField-right">
                        		<h4>Gender:</h4>
                        		#if($mainGender[0] == "M")
                        			<strong>Male</strong>
                        		#elseif ($mainGender[0] == "F")
                        			<strong>Female</strong>
                        		#end
                            </div>
						</li>
							
							#if($policyHolderMaritalStatus=="S")
								#set ($maritalStatus = "Single")
							#else
								#set ($maritalStatus = "Married")
							#end
							
                            #if($product.productName != "Motorcycle")
							<li>
								<div class="policyHolderDrivingExperienceSection" name="displayField-left">
									<h4>Years of Driving Experience:</h4>
									<strong>$mainMotorDrivingExperience[0] years</strong>
								</div>
								<div class="policyHolderMaritalStatusSection" name="displayField-right">
									<h4>Marital Status:</h4>
									<strong>$maritalStatus</strong>
								</div>
							</li>
							
							<li>
								<div class="policyHolderOccupationSection" name="displayField-left">
									<h4>Occupation:</h4>
									<strong>$mainOccupation[0]</strong>
								</div>
							</li>
							#else
                            <li>
                                <div class="policyHolderOccupationSection" name="displayField-left">
    								<h4>Occupation:</h4>
									<strong>$mainOccupation[0]</strong>
								</div>
								<div class="policyHolderMaritalStatusSection" name="displayField-right">
									<h4>Marital Status:</h4>
									<strong>$maritalStatus</strong>
								</div>
							</li>
                            #end
                        #else
                        <li>
                            <div class="policyHolderGenderSection" name="displayField-left">
                                <h4>Gender:</h4>
                            	#if($mainGender[0] == "M")
                        			<strong>Male</strong>
                        		#elseif ($mainGender[0] == "F")
                        			<strong>Female</strong>
                        		#end
                            </div>
                            <div class="policyHolderDOBSection" name="displayField-right">
                                <h4>Date of Birth:</h4>
                                <strong>$!policyHolderDateOfBirth</strong>
                            </div>
                        </li>
                        
                        #if($policyHolderMaritalStatus=="S")
							#set ($maritalStatus = "Single")
						#else
							#set ($maritalStatus = "Married")
						#end
                            
                        <li>
                            <div class="policyHolderAddressSection" name="displayField-left">
                                <h4>Address:</h4>
                                <strong>$policyHolderAddressLine1 $policyHolderAddressLine2 $addressPostcode</strong>
                            </div>
                            <div class="policyHolderMaritalStatusSection" name="displayField-right">
								<h4>Marital Status:</h4>
								<strong>$maritalStatus</strong>
							</div>
						</li>
						
                        #if($product.productName != "Motorcycle")
						<li>
							<div class="policyHolderDrivingExperienceSection" name="displayField-left">
								<h4>Years of Driving Experience:</h4>
								<strong>$mainMotorDrivingExperience[0] years</strong>
							</div>
							<div class="policyHolderOccupationSection" name="displayField-right">
								<h4>Occupation:</h4>
								<strong>$mainOccupation[0]</strong>
							</div>
						</li>
                        #else
                        <li>
							<div class="policyHolderOccupationSection" name="displayField-left">
								<h4>Occupation:</h4>
								<strong>$mainOccupation[0]</strong>
							</div>
						</li>
                        #end
															
                        #end
						#end
						<li>
							<div style="text-align: right;" class="carReview">
								<button type="button" id="editBtn" class="policyHolderEditBtn" onclick="editPolicyHolderSection()"><span class="editIcon"><i class="material-icons">mode_edit</i></span><span class="btnWording">Edit</span></button>
								<button type="button" id="saveBtn" class="policyHolderSaveBtn" onclick="savePolicyHolderSection()" hidden>Save</button>
							</div>
						</li>   
				</div>
                <!-- Motor Plus Plan Driver Details Section End -->
                
                <!-- Motor Plus Plan Additional Driver Section -->
                #set ($count = 0)
                #set ($memberCount = 0)
                #if ($UtilMethods.isSet($memberName))
                    #set ($members = $memberName.split(","))
                    #set ($membersIdNo = $memberIdNo.split(","))
                    #set ($membersIsMalaysian = $memberIsMalaysian.split(","))
                    #set ($membersDOB = $memberDOB.split(","))
                    #set ($membersMotorDrivingExperience = $memberMotorDrivingExperience.split(","))
                    #set ($membersOccupation = $memberOccupation.split(","))                      
                    #set ($memberPetBreed = $memberPetBreed.split(","))
                    #set ($memberGenderStr = $memberGender)
                    #set ($memberGender = $memberGender.split(","))
                    #set ($driverRelationshipStr = $driverRelationship)
                    #set ($driverRelationship = $driverRelationship.split(","))
                    #set ($memberPetMicrochipId = $memberPetMicrochipId.split(","))
                    #set ($memberPhoto = $memberPhoto.split(","))
                    #set ($count = $math.add($members.size(),-1))
                    #set ($memberCount = $members.size())     
                #end
                #if ($UtilMethods.isSet($members) && $members.size() > 0)
					#set ($iniNo = 0)
                  
                    #foreach($i in [$iniNo..$count])
					
						#if(($productExtended.getAllowMotorPlusPlan() == "Y" || $product.productName == "Motorcycle") && $i == 0)
						#else
							#if($productExtended.getAllowMotorPlusPlan() == "Y" || $product.productName == "Motorcycle")
								#set($driverNumber = $i)
							#else
								#set ($driverNumber = $i + 1)
							#end
							
							#if($memberGender[$i] == "M")
								#set ($gender = "Male")
							#end
							#if($memberGender[$i] == "F")
								#set ($gender = "Female")
							#end
			
							#if($driverRelationship[$i] == "00")
								#set ($relationship = "Policyholder")
							#end
							#if($driverRelationship[$i] == "01")
								#set ($relationship = "Parent / Parent-in-law")
							#end
							#if($driverRelationship[$i] == "02")
								#set ($relationship = "Spouse")
							#end
							#if($driverRelationship[$i] == "03")
								#set ($relationship = "Child")
							#end
							#if($driverRelationship[$i] == "04")
								#set ($relationship = "Sibling/Sibling-in-law/Cousin/Relative")
							#end
							#if($driverRelationship[$i] == "05")
								#set ($relationship = "Friend / Co-worker")
							#end
                        
        				<div id="motorDriver" class="motorplus-section" name="driver$i">
            				<li class="#if(($partnerCode == 'msig') && $product.formula == 'motor') tieMotor-title #end">
            				    <div class="form-title">
            				        <p>Additional Driver #$driverNumber <!--<span class="toolTip"><span class="toolTipText">You can purchase Motor Insurance online for vehicles 15 years old and below.</span></span>--></p>
            				    </div>
            				</li>
        		
                           #if($i != 0)
                            <li class="driverNationalitySection$i" hidden>
                                <div style="display: inline;">
                            		<h4>Nationality</h4>
                            		<input id="typeMalaysian$i" type="radio" name="driverNationality$i" value="Y" #if ($membersIsMalaysian[$i] == 'Y') checked #end />
                            		
                            		<label class="labelPadding" for="typeMalaysian$i" #if ($membersIsMalaysian[$i] == 'Y') style="font-weight:bold;" #end> Malaysian</label>
                            		
                            		<input id="typeNonMalaysian$i" type="radio" name="driverNationality$i" value="N" #if ($membersIsMalaysian[$i] == 'N') checked #end />
                            		
                            		<label class="labelPadding" for="typeNonMalaysian$i" #if ($membersIsMalaysian[$i] == 'N') style="font-weight:bold;" #end> Non-Malaysian</label>
                            	</div>
                            </li>
                            #end
        		
            				<li id='firstRow'>
							  #if ($membersIsMalaysian[$i] == 'Y')
                              <div class="driverNameSection$i" name="displayField-left">
								<h4>Name (as per NRIC):</h4>
								<strong>$members[$i]</strong>
							  </div>
							  #else
                              <div class="driverNameSection$i" name="displayField-left">
    							<h4>Name (as per Passport):</h4>
								<strong>$members[$i]</strong>
							  </div>
							  
                              #end
							
							<div class="driverNRICSection$i" #if ($membersIsMalaysian[$i] == 'N') hidden #else name="displayField-right" #end>
								<h4>NRIC No.:</h4>
								#if ($membersIsMalaysian[$i] == 'Y')
								<strong>$membersIdNo[$i]</strong>
								#end
							  </div>
							
							<div class="driverPassportSection$i" #if ($membersIsMalaysian[$i] == 'Y') hidden #else name="displayField-right" #end>
								<h4>Passport No.:</h4>
								#if ($membersIsMalaysian[$i] == 'N')
								<strong>$membersIdNo[$i]</strong>
								#end
							  </div>
							</li>
							
							#if ($membersIsMalaysian[$i] == 'Y')
								<li id="secondRow">
								  <div class="driverGenderSection$i" name="displayField-left">
									<h4>Gender:</h4>
									<strong>$gender</strong>
								  </div>
								   <div class="driverRelationshipSection$i" name="displayField-right">
									<h4>Family Relationship</h4>
									<strong>$relationship</strong>
								  </div>
								</li>
							#elseif ($membersIsMalaysian[$i] == 'N')
								<li id="secondRow">
								  <div class="driverDOBSection$i" name="displayField-left">
									<h4>D.O.B:</h4>
									#if ($membersIsMalaysian[$i] == 'N')
										<strong>$membersDOB[$i]</strong>
									#end
								  </div>
								  <div class="driverGenderSection$i" name="displayField-right">
									<h4>Gender:</h4>
									<strong>$gender</strong>
								  </div>
								</li>
							#end
							
							#if ($membersIsMalaysian[$i] == 'Y')
								<li id="thirdRow">
								  <div class="driverExperienceSection$i" name="displayField-left">
									<h4>Years of Driving Experience</h4>
									<strong>$membersMotorDrivingExperience[$i] years</strong>
								  </div>
								  <div class="driverOccupationSection$i" name="displayField-right">
									<h4>Occupation</h4>
									<strong>$membersOccupation[$i]</strong>
								  </div>
								</li>
							#elseif ($membersIsMalaysian[$i] == 'N')
								<li id="thirdRow">
									<div class="driverRelationshipSection$i" name="displayField-left">
										<h4>Family Relationship</h4>
										<strong>$relationship</strong>
									 </div>
									 <div class="driverExperienceSection$i" name="displayField-right">
										<h4>Years of Driving Experience</h4>
										<strong>$membersMotorDrivingExperience[$i] years</strong>
									 </div>
								</li>
								<li id="fourthRow">
									<div class="driverOccupationSection$i" name="displayField-left">
										<h4>Occupation</h4>
										<strong>$membersOccupation[$i]</strong>
									</div>
								</li>
							#end
							
							<li id="buttonRow">
								<div style="text-align: right;" class="driverReview">
									<button id="removeBtn" type="button" class="driverRemoveBtn$i" onclick="removeAdditionalDriverSection($i)"><span class="removeIcon"><i class="material-icons">close</i></span><span class="btnWording">Remove</span></button>
									<button id="editBtn" type="button" class="driverEditBtn$i" onclick="editAdditionalDriverSection($i)"><span class="editIcon"><i class="material-icons">mode_edit</i></span><span class="btnWording">Edit</span></button>
									<button id="saveBtn" type="button" class="driverSaveBtn$i" onclick="saveAdditionalDriverSection($i)" hidden>Save</button>
								</div>
							</li>
        				</div>
        			#end
                #end
            #end
            #if($partnerCode == "SHOP")
                <div class='motorplus-section'>
                    <li style="padding: 18px 25px 18px 25px !important">
                        <label style="color: rgba(102, 102, 102, 1) !important;font-size: 18px;font-weight: bold;line-height: 28px;" for="membershipID">MY.SHOP.COM Privileged Card ID</label><br>
                        <input name="membershipID" class="required membershipID" minlength="6" maxlength="12" id="membershipID" type="text" data-name="MEMBERSHIP ID" placeholder="XXXXXXXXXXXX" value="#if($UtilMethods.isSet($membershipID))$membershipID #end" autocomplete="off">
                    </li>
                </div>
            #end
            <!-- Motor Plus Plan Additional Driver Section End -->
                <div class="checkBox">
                <input type="checkbox" id="boxCheck" name="agreeToTnC" value="Y" data-group="checkbox"> <label for="boxCheck">By ticking this box, I hereby acknowledge that I have read the   #if(!$UtilMethods.isSet($motorPlusPlan))<a href="$productDisclosurePDFHtml" class="iconPdf" target="_blank"> #else <a href="$productDisclosureSheetMmp" class="iconPdf" target="_blank"> #end Product Disclosure Sheet</a> and have agreed to the <a id="linkTnc" href="">Terms & Conditions</a>.</label></div>
                            
            </div>
            
            <!-- Summary Container Start -->
                <div class="motorNewSummaryPage motorNewSummaryPage2">
                    <li class="totalCost clearfix" id="summaryContainer">
                        <div>
                            <ul>
                                #set($border = "")
                                #set($grossPremium = $premiumCalculationResult.grossPremium)
                                #set($additionalPremium = $premiumCalculationResult.additionalPremium)
                                #set($additionalPremiumDescription = $premiumCalculationResult.additionalPremiumDescription)
                                #set($discount = $premiumCalculationResult.discountAmount)
                                #set($rebate = $premiumCalculationResult.rebateAmount)
                                #set($totalPremium = $premiumCalculationResult.totalPayable)
                                #set($gstamount = $premiumCalculationResult.gstAmount)
                                #set($gstVal = $premiumCalculationResult.gst)
                                #if ($UtilMethods.isSet($premiumCalculationResult.sst))
                                    #set($sstamount = $premiumCalculationResult.sstAmount)
                                    #set($sstVal = $premiumCalculationResult.sst)
                                #end
                                #set($stampDuty = $premiumCalculationResult.stampDuty)
                                #set($promoDiscount = $premiumCalculationResult.promoDiscount)
                                #set($grandTotal = $premiumCalculationResult.totalPayable)
                            
                                #if($number.format("#.##", $grandTotal).endsWith("."))
                                	#set($format = "#[[#,##0.00]]#")
                                #else
                                	#set($format = "#[[#,##0]]#")
                                #end
                            
                                #if ($product.formula == "motor")
                                    <li class="summaryTitleTop" style="margin: 0!important"><p style="width:100%;">Summary</p></li>
                                    <li class="summaryBoldText"><p style="width: 65vw;">You're qualified for $!{motorCalculationResult.ncdRate}% NCD!</p></li>
                                    <li class="summaryBoldText summaryDiscount"><p class="mmpCoveragePeriod">Coverage Period: <br/><i style="font-weight:normal !important;">1 Year ($coverageStartDate - $coverageExpiryDate)</i></p></li>
                                    <li class="summaryBoldText summaryCapital summaryDiscount"><p>Your Sum Insured</p><span id="summarySumInsured">RM $number.format($format, $motorSumInsured)</span></li>
                                    <li class="summaryBoldText summaryDiscount summaryDividerLine"><p>Excess</p>
                                        <span id="summaryExcess">
                                            #if($UtilMethods.isSet($motorCalculationResult.excess))
                                            RM $number.format($format, $motorCalculationResult.excess)
                                            #else
                                            NIL
                                            #end
                                        </span>
                                    </li>
                                
                                	  <li class="summaryDiscount"><p>Basic Premium</p><span id="basicPremium">RM $number.format($format, $motorCalculationResult.basePremium)</span> </li>
                                	  #if ($UtilMethods.isSet($motorCalculationResult.loading) && $motorCalculationResult.loading > 0)
                                	  <li class="summaryDiscount">Loading<span>RM $number.format($format, $motorCalculationResult.loading)</span> </li>
                                	  #end
                                      #if($allRiderPlanParam)
                                    		<li class="summaryDiscount pushIn"><p>All Riders</p><span id="allRiderPlanPremium">RM $number.format($format, $motorCalculationResult.allRiderPlanPremium)</span> </li>
                                      #end
                                	  #if ($UtilMethods.isSet($motorCalculationResult.ncdAmount) && $motorCalculationResult.ncdAmount > 0)
                                	  <li class="summaryDiscount"><p>NCD ($!{motorCalculationResult.ncdRate}%)</p><span id="ncdAmount" class="deductAmount">- RM $number.format($format, $motorCalculationResult.ncdAmount)</span> </li>
                                	  #end
                                      
                                      #if($allRiderPlanParam)
                                        #set($totalAmount = $motorCalculationResult.basePremium + $motorCalculationResult.allRiderPlanPremium - $motorCalculationResult.ncdAmount)
                                      #else
                                        #set($totalAmount = $motorCalculationResult.basePremium - $motorCalculationResult.ncdAmount)
                                      #end
                                      <li class="summaryBoldText summaryDiscount summaryCapital summaryDividerLine"><p>Total Amount</p><span id="netNcdAmount">RM $number.format($format, $totalAmount)</span></li>
                                	  
                                
                                	  #if($motorAddLegalLiabilityToPassengersParam || $motorAddLegalLiabilityOfPassengersParam || $motorAddSpecialPerilsParam || $motorAddWindscreenParam || $motorAddSRCCParam || $motorAddSmartKeyShieldParam || $motorAddDriverPersonalAccidentParam || $motorAddLimitedSpecialPerilsParam || $motorAddEHailingParam || $motorAddBettermentParam || $motorAddCARTParam || $motorPlusPlanParam || $motorAddNcdReliefParam || $motorAddRiderPAParam)
                                	  
                                	  #else
                                	  #end
                                	  <li class="summaryBoldText summaryDiscount">
                                      #if($product.productName == "Motorcycle")
                                        Optional Add-On
                                      #else
                                        Motor Add-On
                                      #end
                                        </li>
                                      <!-- Additional Drivers -->
                                      #if (!$motorPlusPlanParam && !$motorAddWaiverCompulsoryExcessParam)
                                        #if ($members.size() > 2)
                                		    <li class="summaryDiscount" id="summaryAdditionalDriverRow"><p>Additional Drivers ($premiumCalculationResult.additionalDriver)</p><span id="summaryAdditionalDriver">RM $number.format($format, $premiumCalculationResult.additionalDriverPremium)</span> </li>
                                	    #end
                                      #end
                                	  
                                	  <!-- Additional Drivers End-->
                                	  #if ($motorPlusPlanParam)
                                    	 <li class="summaryDiscount pushIn">
											<p>MSIG Motor Plus<br/>
												<span class="mmpSubAddOn">- Driver's Personal Accident - Plan 1</span>
												<span class="mmpSubAddOn">- Waiver of Compulsory Excess</span>
												<span class="mmpSubAddOn">- Special Perils - Cover up to 100%</span>
												<span class="mmpSubAddOn">- 24-Hour Unlimited Towing Service</span>
												<span class="mmpSubAddOn">- Legal Liability of Passengers</span>
												<span class="mmpSubAddOn">- Legal Liability to Passengers</span>
												<span class="mmpSubAddOn">- Strike, Riot & Civil Commotion</span>
											</p>
											<span id="motorPlusPlanPremium">RM $number.format($format, $motorCalculationResult.motorPlusPlanPremium)</span>
										</li>
                                	  #end
                                	  
                                	  #if ($motorAddLegalLiabilityToPassengersParam)
                                		#if (!$motorPlusPlanParam)
                                			<li class="summaryDiscount pushIn"><p>Legal Liability to Passengers</p><span>RM $number.format($format, $motorCalculationResult.addLegalLiabilityToPassengersPremium)</span> </li>
                                		#end
                                	  #end
                                      
                                	  #if ($motorAddLegalLiabilityOfPassengersParam)
                                		#if (!$motorPlusPlanParam)
                                			<li class="summaryDiscount pushIn //pushTop"><p>#if($product.productName == "Motorcycle") Legal Liability to Pillion #else Legal Liability of Passengers #end</p><span>RM $number.format($format, $motorCalculationResult.addLegalLiabilityOfPassengersPremium)</span> </li>
                                		#end
                                	  #end
                                      
                                	  #if ($motorAddSpecialPerilsParam)
                                		#if (!$motorPlusPlanParam)
                                			<li class="summaryDiscount pushIn //pushTop"><p>#if($product.productName == "Motorcycle")Special Perils #else Special Perils ( floods , storm , landslide , landslip , subsidence)#end</p><span>RM $number.format($format, $motorCalculationResult.addSpecialPerilsPremium)</span> </li>
                                		#end
                                	  #end
                                      
                                	  #if ($motorAddLimitedSpecialPerilsParam)
                                      #set($sum = $!premiumCalculationResult.sumInsured)
                                      #set($calc_25 = $sum * 25 / 100)
                                	    <li class="summaryDiscount pushIn //pushTop"><p>Limited Special Perils ( floods , storm , landslide , landslip , subsidence) - RM $number.format("#[[#,##0]]#", $calc_25)</p><span>RM $number.format($format, $motorCalculationResult.addLimitedSpecialPerilsPremium)</span> </li>
                                	  #end
                                      
                                	  #if ($motorAddSRCCParam)
                                		#if (!$motorPlusPlanParam)
                                		  <li class="summaryDiscount pushIn //pushTop"><p>Strike, Riot & Civil Commotion</p><span>RM $number.format($format, $motorCalculationResult.addSRCCPremium)</span> </li>                   
                                		 #end
                                	  #end
									  
									  #if ($motorAddUnlimitedTowingParam)
										#if (!$motorPlusPlanParam)
										  <li class="summaryDiscount pushIn //pushTop"><p>24-Hour Unlimited Towing Service</p><span>RM $number.format($format, $motorCalculationResult.addUnlimitedTowingPremium)</span> </li>
										#end
									  #end
									  
									  #if ($motorAddWaiverCompulsoryExcessParam)
										#if (!$motorPlusPlanParam)
										  <li class="summaryDiscount pushIn //pushTop"><p>Waiver of Compulsory Excess</p><span>RM $number.format($format, $motorCalculationResult.addWaiverCompulsoryExcessPremium)</span></li>
										#end
									  #end
                                      
                                	  #if ($motorAddEHailingParam)
                                	    <li class="summaryDiscount pushIn"><p>E-Hailing</p><span>RM $number.format($format, $motorCalculationResult.addEHailingPremium)</span> </li>
                                	  #end
                                      
                                	  #if ($motorAddBettermentParam)
                                	    <li class="summaryDiscount pushIn //pushTop"><p>Waiver of Betterment Cost</p><span>RM $number.format($format, $motorCalculationResult.addBettermentPremium)</span> </li>
                                	  #end
                                      
                                	  #if ($motorAddWindscreenParam)
                                	    <li class="summaryDiscount pushIn"><p>Windscreen Coverage - RM $number.format("#[[#,##0]]#", $motorAddWindscreenSumInsured)</p><span>RM $number.format($format, $motorCalculationResult.addWindscreenPremium)</span> </li>
                                	  #end
                                      
                                	  #if ($motorAddSmartKeyShieldParam)
                                		#set($annualPremium = $motorCalculationResult.totalPremium)    	                      <li class="summaryDiscount pushIn"><p>Smart Key Shield Coverage - RM $number.format("#[[#,##0]]#", $motorAddSmartKeyShieldSumInsured)</p><span>RM $number.format($format, $motorCalculationResult.addSmartKeyShieldPremium)</span> </li>
                                	  #end
                                      
                                	  #if ($motorAddDriverPersonalAccidentParam)
                                		#if (!$motorPlusPlanParam)
                                		  <li class="summaryDiscount pushIn"><p>Driver's Personal Accident Coverage - RM $number.format("#[[#,##0]]#", $motorAddDriverPersonalAccidentSumInsured)</p><span>RM $number.format($format, $motorCalculationResult.addDriverPersonalAccidentPremium)</span> </li>
                                		#end
                                	  #end
                                    	  #if ($motorAddCARTParam)
                                    	    <li class="summaryDiscount pushIn">CART Extension
                                    	  #if ($additionalPlan07)
                                    		7 Days
                                    	  #elseif($additionalPlan14)
                                    		14 Days
                                    	  #else
                                    		21 Days
                                    	  #end
                                          - RM $number.format("#[[#,##0]]#", $motorAddCARTSumInsured)<span>RM $number.format($format, $motorCalculationResult.addCARTPremium)</span> </li>
                                	  #end
                                      
                                      #if ($motorAddNcdReliefParam)    	
                                 	    <li class="summaryDiscount pushIn //pushTop"><p>Current Year 'NCD' Relief</p><span>RM $number.format($format, $motorCalculationResult.addNcdReliefPremium)</span> </li>
                                 	  #end
                                      
                                      
                                      #if ($motorAddRiderPAParam)
                            		        <li class="summaryDiscount pushIn //pushTop"><p>Rider's Personal Accident</p><span>RM $number.format($format, $motorCalculationResult.addRiderPAPremium)</span> </li>                   
                                	  #end
                                      <li class="summaryBoldText summaryDiscount summaryCapital summaryDividerLine" id="summaryTotalAdditionalPremiumRow"><p>
                                        #if($product.productName == "Motorcycle")
                                            Total Add-On
                                        #else
                                            Total Motor Add-On
                                        #end
                                        </p><span id="summaryTotalAdditionalPremium">RM $number.format($format, $motorCalculationResult.getTotalAdditionalCoveragePremium())</span></li>
                                	  #if($motorCalculationResult.netPremium)
                                		#set($annualPremium = $motorCalculationResult.netPremium)
                                		#if ($UtilMethods.isSet($discount))
                                		    #set($annualPremium = $math.add($annualPremium,$discount))
                                		#end
                                        
                                		#if ($UtilMethods.isSet($rebate))
                                		    #set($annualPremium = $math.add($annualPremium,$rebate))
                                		#end
                                        
                                		#if ($UtilMethods.isSet($promoDiscount))		
                                		    #foreach($cont in $promoDiscount)		
                                		        #set($annualPremium = $math.add($annualPremium,$cont.discountAmount))		
                                            #end
                                		#end
                                	 <li class="summaryDiscount borderTop"><p>Annual Premium</p><span id="summaryAnnualPremium">RM $number.format($format, $annualPremium)</span> </li>  
                                	  #end
                                #else
                                	  <li class="summaryDiscount"><p>Gross Premium</p><span>RM $number.format($format, $grossPremium)</span> </li>
                                #end
                                
                                #if ($product.getDiscount().equals("0") || $product.getDiscount().equals("0.0"))
                                	  <li class="summaryDiscount" id="summaryDiscountRow" style="display: none !important;"><p>#if($UtilMethods.isSet($productExtended.getDiscountRebateLabel())) $productExtended.getDiscountRebateLabel() #else Discount #end @ 0%</p><span id="summaryDiscountValue" class="deductAmount">- RM 0</span> </li>
                                #else 
                                    <li class="summaryDiscount" id="summaryDiscountRow"><p>#if($UtilMethods.isSet($productExtended.getDiscountRebateLabel())) $productExtended.getDiscountRebateLabel() #else Discount #end @ $product.getDiscount()%</p><span id="summaryDiscountValue" class="deductAmount">- RM $number.format($format, $discount)</span> </li>
                                    
                                #end
                                
                                #if ($rebate > 0)
                                	  <li class="summaryDiscount">Rebate Amount<span>- RM $number.format($format, $rebate)</span></li>
                                #end
                                
                                #set($border = "border")
                                #if($promoDiscount.size() > 0)
                                    #if($productCode == "MSM")
                                    	<li class="summaryDiscount $!{border}">  <span> RM $number.format($format, $math.sub( $annualPremium,$discount ))</span></li>
                                    	#set($tempAmount = $math.sub($annualPremium,$discount))
                                    #else
                                    	<li class="summaryDiscount $!{border}">  <span> RM $number.format($format, $math.sub( $grossPremium,$discount ))</span> </li>
                                    	#set($tempAmount = $math.sub($grossPremium,$discount))
                                    #end
                                
                                	#foreach($cont in $promoDiscount)
                                			#set($tempAmount = $math.sub($tempAmount,$cont.discountAmount))
                                		  <li class="summaryDiscount "><p>$cont.discountLabel @ $cont.discountRate %</p><span>- RM $number.format($format,$cont.discountAmount)</span></li>
                                		 <li class="summaryDiscount $!{border}"> </span><span> RM $number.format($format,$tempAmount)</span></li>
                                	   
                                	  #end
                                #end
                                
                                #if ($UtilMethods.isSet($premiumCalculationResult.sst))
                                    #if ($UtilMethods.isSet($sstVal))
                                        #if ($sstVal > 0)
                            				<li class="summaryDiscount" id="summarySstRow"><p>Service Tax @ $sstVal%</p><span id="summarySstValue">RM $number.format($format, $sstamount)</span> </li>
                                        #else
                                            <li class="summaryDiscount"><p>Service Tax @ 0%</p><span>RM 0.00</span> </li>
                                        #end
                                    #else
                                         #### sst exempted
                                    #end
                                #else
                                    #if ($UtilMethods.isSet($gstVal))
                                        #if ($gstVal > 0)
                                            <li class="summaryDiscount"><p>GST @ $gstVal% (Standard Rate)</p><span>RM $number.format($format, $gstamount)</span> </li>
                                        #else
                                            <li class="summaryDiscount"><p>GST @ 0% (Standard Rate)</p><span>RM 0.00</span> </li>
                                        #end
                                    #else
                                         #### gst exempted
                                    #end
                                #end
                            
                                #if ($UtilMethods.isSet($additionalPremium))
                                    <li class="summaryDiscount"><p>$additionalPremiumDescription</p><span>RM $number.format($format, $additionalPremium)</span></li>
                                #end        
                                #if ($UtilMethods.isSet($stampDuty) && $stampDuty > 0)
                                    <li class="summaryStamp"><p>Stamp Duty </p><span>RM $number.format($format,$stampDuty)</span></li>  
                                    #set($border = "border")
                                #end    
                                #if($allowPromoCode == true)
                                ##if($partnerCode == "hlb") ##nuimei-promoCode
                                <li class="summaryBoldText summaryDividerLine  clearfix" style="padding-bottom: 15px !important;">
                                    <label for="promoCode">Promo Code (Optional)</label><br>
			                        <input type="text" id="promoCode" class="mmpPromoCode" name="promotionCode" value="$!promotionCode" minlength="6" maxlength="12" placeholder="PROMOABC" autocomplete="off">
                                    <a class="button ok-btn mmpApplyPromoCode" id="applyPromoCode">Apply</a>
                                    <span class="clearfix"></span>
                                    <br>
                                    <small class="promoCodeError"></small>
		                        </li>
                                #end
                                <li class="summaryTotal $!{border}" id="summaryGrandTotalRow"><p>Total Amount to Pay </p><span id="summaryGrandTotal">RM $number.format($format, $grandTotal)</span></li>
                            </ul>
                        </div>
                    </li>
                </div>
            <div class="checkBox1"><input type="checkbox" id="boxCheck1" name="agreeToTnC" value="Y" data-group="checkbox"> <label for="boxCheck">By ticking this box, I hereby acknowledge that I have read the #if(!$UtilMethods.isSet($motorPlusPlan))<a href="$productDisclosurePDFHtml" class="iconPdf" target="_blank"> #else <a href="$productDisclosureSheetMmp" class="iconPdf" target="_blank"> #end Product Disclosure Sheet</a> and have agreed to the <a id="linkTnc1" href="">Terms & Conditions</a>.</label></div>
            
			<div class="mmpSummaryNavigationBtn">
                <a class="ir alignRight nextArrow mmpBtnNext" id="checkSubmit" href="#" onClick="javascript:proceed(); return false;">Checkout</a>
                <a href="" class="ir alignLeft prevArrow mmpBtnBack" href="#" onClick="javascript: return false;">Back</a>
            </div>
        </ul>
	
	#else

      <ul class="accordianStack accordian planSummary">
        #if ($product.formula == "daily" || $product.formula == "monthly" || $product.formula == "flat" || $product.formula == "critical-illness" || $product.formula == "home-content" || $product.formula == "personal-accident" || $product.formula == "pets" || $product.formula == "mcp" || $product.formula == "wedding" || $product.formula == "daily-personal-accident")


          #if($product.formula == "critical-illness" || $product.formula == "home-content" || $product.formula == "personal-accident" || $product.formula == "daily-personal-accident")
            #foreach($con in $dotcontent.pull("+structureName:TieBancaPlanTableStructure +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieBancaPlanTableStructure.planCode:\"${coveragePlan}\"",1,"TieBancaPlanTableStructure.planCode"))
              #set($planName = $con)
            #end
            <li>
              <div class="form-title">
                <p>Product Info</p>
              </div>
            </li>
            <li>
              <div class="">
                <h4>Product</h4>
                <strong>$product.getProductName()</strong>
              </div>
            </li>
            
            <li>
              <div class="">
                <h4>Plan Type</h4>
                <strong>            
                  $planName.planName
                </strong>
              </div>
            </li>
          #else
            #if($product.formula == "pets")
                <li>
                  <div class="">
                    <h4>Plan Type</h4>
                    <strong>            
                      $planName.planName
                    </strong>
                  </div>
                </li>
            #else
                <li>
                    <div class="">
                      <h4>Plan Type</h4>
                      <strong>            
                        $product.getProductName()
                      </strong>
                    </div>
                </li>
            #end
          #end


        #elseif ($product.formula == "travelright-plus")
        <li>
          <div class="">
            <h4>Product</h4>
            <strong>$product.getProductName()</strong>
          </div>
        </li>
        ##if($partnerCode != "hlb" && $partnerCode != "hlbstaff" && $partnerCode != "mach" && $partnerCode != "sc")
        #if($partnerCode != "mach" && $partnerCode != "sc")
            <li>
              <div class="">
                <h4>Plan</h4>
                #if ($travelBenefitPlan == "1")
                <strong>Plan 1</strong>
                #elseif ($travelBenefitPlan == "2")
                <strong>Plan 2</strong>
                #end
              </div>
            </li>
            #end
        <li>
          <div class="">
            <h4>Coverage</h4>
            #if ($travelPlan == "annual")
            <strong>Annual Cover</strong>
            #else
            <strong>Single Trip</strong>
            #end
          </div>
        </li>
        <li>
          <div class="">
            <h4>Area of Travel</h4>
            #if ($travelArea == "area1")
            <strong>Area 1</strong>
            #elseif ($travelArea == "area2")
            <strong>Area 2</strong>
            #elseif ($travelArea == "area3")
            <strong>Area 3</strong>
            #elseif ($travelArea == "area4")
            <strong>Area 4</strong>
            #end
          </div>
        </li>
        #elseif ($product.formula == "personal-accident")
        <li>
          <div class="">
            <h4>Product</h4>
            <strong>$product.getProductName()</strong>
          </div>
        </li>
        #elseif ($product.formula == "motor")
        <!-- M -->
        <li class="#if(($partnerCode == 'msig') && $product.formula == 'motor') tieMotor-title #end">
          <div class="form-title">
            <p>Main Policy Holder's Info</p>
          </div>
        </li>
        #if($!policyHolderGender == "M")
        	#set ($nonMalaysianGender = "Male")
    	#else
    		#set ($nonMalaysianGender = "Female")
    	#end

        
    #if (!$UtilMethods.isSet($policyHolderMalaysian) || $policyHolderMalaysian == "Y")
       <li>
          <div class="">
            <h4>Name as per NRIC</h4>
            <strong>$!policyHolderName</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>NRIC</h4>
            <strong>$!policyHolderNric</strong>
          </div>
        </li>
    #else
        <li>
          <div class="">
            <h4>Name as per Passport</h4>
            <strong>$!policyHolderName</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Passport No.</h4>
            <strong>$!policyHolderNric</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Gender</h4>
            <strong>$nonMalaysianGender</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>D.O.B</h4>
            <strong>$!policyHolderDateOfBirth</strong>
          </div>
        </li>
    #end
        <li>
          <div class="">
            <h4>Email Address</h4>
            <strong>$!policyHolderEmail</strong>
          </div>
        </li>
        <li>
            <div class="">
                <h4>Contact No.</h4>
                <strong>$!policyHolderMobileNo</strong>
            </div>
        </li>
        
        #if($policyHolderMaritalStatus=="S")
            #set ($maritalStatus = "Single")
        #else
            #set ($maritalStatus = "Married")
        #end
        
        <li>
          <div class="">
            <h4>Marital Status</h4>
            <strong>$maritalStatus</strong>    
          </div>
        </li>
        <li>
          <div class="">
            <h4>Place of Residence</h4>
            <strong>$refCity.cityDescription, $refState.stateDescription</strong>
          </div>
        </li>
        <!---->
        <!--M-->
        <li class="#if(($partnerCode == 'msig') && $product.formula == 'motor') tieMotor-title #end">
          <div class="form-title">
            <p>Car Info</p>
          </div>
        </li>
        
        <li>
          <div class="">
            <h4>Car Registration No.</h4>
            <strong>$!motorRegistrationNo</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Car Chassis No.</h4>
            <strong>$!motorChassisNo</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Car Engine No.</h4>
            <strong>$!motorEngineNo</strong>
          </div>
        </li>
        #end
        #if ($product.formula != "motor")
        #if($product.formula == "personal-accident" || $product.formula == "home-content" || $product.formula == "critical-illness")
          <li>
            <div class="">
              <h4>Period of Insurance</h4>
                 <strong>$coverageStartDate - $coverageExpiryDate - 1 Year </strong>
            </div>
          </li>
        #else  
          <li>
            <div class="">
              <h4>Dates</h4>     
              #if ($travelPlan == "annual" || $product.formula == "pets" || $product.formula == "mcp")
                 <strong>$coverageStartDate - $coverageExpiryDate - 1 Year </strong>
              #else
                 <strong>$coverageStartDate - $coverageExpiryDate - $noDaysCovered #if ($UtilMethods.parseDouble($noDaysCovered,0) > 1) Days #else Day #end </strong>
              #end   
            </div>
          </li>
        #end

        <!-- Wedding -->
        #if($product.formula == "wedding")
        <li>
          <div class="">
            <h4>Location of Property (Address)</h4>
            <strong>$!locationAddressLine1</strong>
          </div>
        </li>
          #if($locationAddressLine2) 
            <li>
              <div class="">
                <h4>Location of Property (Address 2)</h4>
                <strong>$!locationAddressLine2</strong>
              </div>
            </li>
          #end
        <li>
          <div class="">
            <h4>Country</h4>
            <strong>Malaysia</strong>
          </div>
        </li>
        #end
        <!-- Wedding End -->

        #if($product.formula == "critical-illness" || $product.formula == "home-content" )
          #foreach($con in $dotcontent.pull("+structureName:TieBancaPlanTableStructure +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieBancaPlanTableStructure.planCode:\"${coveragePlan}\"",1,"TieBancaPlanTableStructure.planCode"))
            #set($planName = $con)
          #end
          <li>
            <div class="">
              <h4>Sum Insured</h4>
              <strong>$planName.sumInsured</strong>
            </div>
          </li>      
        #end
        #end

        #if($product.formula == "home-content")
        <li>
          <div class="form-title">
            <p>Your Property Info</p>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Location of Property (Address)</h4>
            <strong>$!propertyAddressLine1</strong>
          </div>
        </li>
        #if($propertyAddressLine2) 
        <li>
          <div class="">
            <h4>Location of Property (Address 2)</h4>
            <strong>$!propertyAddressLine2</strong>
          </div>
        </li>
        #end
        <li>
          <div class="">
            <h4>Postal Code</h4>
            <strong>$!propertyPostcode</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Town / City</h4>
            <strong>$townCityName.cityDescription</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Country</h4>
            <strong>Malaysia</strong>
          </div>
        </li>
        #end

        #if($product.formula == "motor")
        <li>
          <div class="">
            <h4>Car Make</h4>
            <strong>$!motorMake</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Car Model</h4>
            <strong>$!motorFamily</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Year of Make</h4>
            <strong>$!motorYearOfMake</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Cubic Capacity</h4>
            <strong>$!motorCc</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Car Specifications</h4>
            <strong>$!motorVariant $!motorStyle $!ISMEngineNo $!motorTransmission  </strong>
          </div>
        </li>  
        <li>
          <div class="">
            <h4>Seating Capacity</h4>
            <strong>$!motorSeat</strong>
          </div>
        </li>
        

        <li class="#if(($partnerCode == 'msig') && $product.formula == 'motor') tieMotor-title #end">
          <div class="form-title">
            <p>Insurance Info</p>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Product</h4>
            <strong>$product.getProductName()</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Plan Type</h4>
            <strong>Comprehensive Cover for Private Car</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Period of Insurance</h4>
               <strong>$coverageStartDate - $coverageExpiryDate - 1 Year </strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Car Location</h4>
            #foreach($con in $dotcontent.pull("+structureName:TieRefState +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieRefState.vpmsStateCode:${motorVehicleLocation}",1,"TieRefState.stateDescription"))
    			#set($motorState = $con)
    		#end
    		<strong>$motorState.stateDescription</strong>
            ## <strong>#if ($motorVehicleLocation == "em") East Malaysia #else West Malaysia #end</strong>
          </div>
        </li>
          #if ($!refLoanProvider.financeName)
          <li>
            <div class="">
              <h4>Loan Provider</h4>
              <strong>$!refLoanProvider.financeName</strong>
            </div>
          </li>
          #end
        #if ($motorAddLegalLiabilityToPassengersParam || $motorAddLegalLiabilityOfPassengersParam || $motorAddSpecialPerilsParam || $motorAddWindscreenParam  || $motorAddSRCCParam || $motorAddSmartKeyShieldParam || $motorAddDriverPersonalAccidentParam || $motorAddLimitedSpecialPerilsParam || $motorAddEHailingParam || $motorAddWaiverCompulsoryExcessParam || $motorAddUnlimitedTowingParam || $motorAddNcdReliefParam)
        <li>
          <div class="summary-add-coverage">
            <h4>Additional Coverage</h4>
            <ol>
            #if ($motorAddLegalLiabilityToPassengersParam)
                <li>Passenger Legal Liability</li>
            #end
            #if ($motorAddLegalLiabilityOfPassengersParam)
                <li>Legal Liability of Passenger for Acts of Negligence</li>
            #end
            #if ($motorAddSpecialPerilsParam)
                <li>Special Perils ( floods , storm , landslide , landslip , subsidence )</li>
            #end        
            #if ($motorAddLimitedSpecialPerilsParam)
                #set($sum = $!premiumCalculationResult.sumInsured)
                #set($calc_25 = $sum * 25 / 100)
                <li>Limited Special Perils ( floods , storm , landslide , landslip , subsidence ) - RM $number.format("#[[#,##0]]#", $calc_25)</li>
            #end
            #if ($motorAddSRCCParam)
                <li>SRCC (Strikes, Riots and Civil Commotion)</li>
            #end
            #if ($motorAddUnlimitedTowingParam)
        		<li>24-Hour Unlimited Towing Service</li>
			#end
            #if ($motorAddWaiverCompulsoryExcessParam)
                <li>Waiver of Compulsory Excess</li>
            #end
            #if ($motorAddEHailingParam)
                <li>E-Hailing</li>
            #end
            #if ($motorAddBettermentParam)
                <li>Waiver of Betterment Cost</li>
            #end
            #if ($motorAddWindscreenParam)
                <li>Windscreen Coverage - RM $number.format("#[[#,##0]]#", $motorAddWindscreenSumInsured)</li>
            #end
            #if($motorAddSmartKeyShieldParam)
                <li>Smart Key Shield Coverage - RM $number.format("#[[#,##0]]#", $motorAddSmartKeyShieldSumInsured)</li>
            #end
            #if($motorAddDriverPersonalAccidentParam)
                <li>Driver's Personal Accident Coverage - RM $number.format("#[[#,##0]]#", $motorAddDriverPersonalAccidentSumInsured)</li>
            #end
            #if ($motorAddCARTParam)
            <li>CART Extension 
                  #if ($additionalPlan07)
                    7 Days
                  #elseif($additionalPlan14)
                    14 Days
                  #else
                    21 Days
                  #end
                - RM $number.format("#[[#,##0]]#", $motorAddCARTSumInsured)</li>
            #end
            #if ($motorAddNcdReliefParam)
               <li>Current Year 'NCD' Relief</li>
            #end
            </ol>
          </div>
        </li>
        #end
        <li>
          <div class="">
            <h4>Sum Insured</h4>
            <strong>RM $number.format("#[[#,##0]]#", $!premiumCalculationResult.sumInsured)</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>No Claim Discount</h4>
            <strong>$!{motorCalculationResult.ncdRate}%</strong>
          </div>
        </li>
      
        #set ($count = 0)
        #set ($memberCount = 0)
        #if ($UtilMethods.isSet($memberName))
            #set ($members = $memberName.split(","))
            #set ($membersIdNo = $memberIdNo.split(","))
            #set ($membersIsMalaysian = $memberIsMalaysian.split(","))
            #set ($membersDOB = $memberDOB.split(","))
            #set ($membersMotorDrivingExperience = $memberMotorDrivingExperience.split(","))
            #set ($membersOccupation = $memberOccupation.split(","))                      
            #set ($memberPetBreed = $memberPetBreed.split(","))
            #set ($memberGenderStr = $memberGender)
            #set ($memberGender = $memberGender.split(","))
            #set ($driverRelationshipStr = $driverRelationship)
            #set ($driverRelationship = $driverRelationship.split(","))
            #set ($memberPetMicrochipId = $memberPetMicrochipId.split(","))
            #set ($memberPhoto = $memberPhoto.split(","))
            #set ($count = $math.add($members.size(),-1))
            #set ($memberCount = $members.size())     
        #end
        #if ($UtilMethods.isSet($members) && $members.size() > 0)
          #foreach($i in [0..$count])
            #set($driverNumber = $i + 1)
            #if($memberGender[$i] == "M")
                #set ($gender = "Male")
            #end
            #if($memberGender[$i] == "F")
                #set ($gender = "Female")
            #end
            

            #if($driverRelationship[$i] == "00")
                #set ($relationship = "Policyholder")
            #end
            #if($driverRelationship[$i] == "01")
                #set ($relationship = "Parent / Parent-in-law")
            #end
            #if($driverRelationship[$i] == "02")
                #set ($relationship = "Spouse")
            #end
            #if($driverRelationship[$i] == "03")
                #set ($relationship = "Child")
            #end
            #if($driverRelationship[$i] == "04")
                #set ($relationship = "Sibling/Sibling-in-law/Cousin/Relative")
            #end
            #if($driverRelationship[$i] == "05")
                #set ($relationship = "Friend / Co-worker")
            #end
      
        <li class="#if(($partnerCode == 'msig') && $product.formula == 'motor') tieMotor-title #end">
          <div class="form-title">
            <p>Driver's Info #$driverNumber</p>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Name</h4>
            <strong>$members[$i]</strong>
          </div>
        </li>
        #if ($membersIsMalaysian[$i] == "Y")
        <li>
          <div class="">
            <h4>NRIC</h4>
            <strong>$membersIdNo[$i]</strong>
          </div>
        </li>
        #else
        <li>
          <div class="">
            <h4>Passport No.</h4>
            <strong>$membersIdNo[$i]</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>D.O.B</h4>
            <strong>$membersDOB[$i]</strong>
          </div>
        </li>
        #end
        <li>
          <div class="">
            <h4>Gender</h4>
            <strong>$gender</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Family Relationship</h4>
            <strong>$relationship</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Driving Experience</h4>
            <strong>$membersMotorDrivingExperience[$i]</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>Occupation</h4>
            <strong>$membersOccupation[$i]</strong>
          </div>
        </li>
          #end
        #end

        #elseif($product.formula == "critical-illness" || $product.formula == "home-content")
        <li>
          <div class="form-title">
            <p>Policy Holder's Info</p>
          </div>
        </li>
        #if (!$UtilMethods.isSet($policyHolderMalaysian) || $policyHolderMalaysian == "Y")
         <li>
           <div class="">
            <h4>Name as per NRIC</h4>
            <strong>$!policyHolderName</strong>
            </div>
          </li>
          <li>
            <div class="">
             <h4>NRIC</h4>
             <strong>$!policyHolderNric</strong>
            </div>
          </li>
        #else
          <li>
            <div class="">
             <h4>Name as per Passport</h4>
             <strong>$!policyHolderName</strong>
            </div>
          </li>
          <li>
            <div class="">
             <h4>Passport No.</h4>
             <strong>$!policyHolderNric</strong>
            </div>
          </li>
          #foreach($con in $dotcontent.pull("+structureName:TieRefCountry +(conhost:9e20171a-ec3c-49cc-8f4a-0fdea34d6b74 conhost:SYSTEM_HOST) +TieRefCountry.countryCode:${policyHolderNationality}",1,"TieRefCountry.name"))
            #set($countryName = $con)
          #end
          <li>
            <div class="">
             <h4>Country</h4>
             <strong>$countryName.name </strong>
            </div>
          </li>
        <li>
          <div class="">
            <h4>Gender</h4>
            <strong>$!policyHolderGender</strong>
          </div>
        </li>
        <li>
          <div class="">
            <h4>D.O.B</h4>
            <strong>$!policyHolderDateOfBirth</strong>
          </div>
        </li>
        #end
        #if($product.formula != "home-content")
          <li>
            <div class="">
              <h4>Email Address</h4>
              <strong>$!policyHolderEmail</strong>
            </div>
          </li>
        #end
        #else
          #if($product.formula == "pets")
            <li class="petSummary clearfix">
              <div>
                <h4>Pet Covered:</h4>
                <strong>Your Pet</strong>
                <div class="furtherInfo">
                  <ul>
                    <!-- <li>
                      <h4>Type</h4>
                      <span>$memberRelationship</span>
                    </li>
                    <li>
                      <h4>Breed</h4>
                      <span>$memberPetBreed</span>
                    </li> -->
                    <li>
                      <h4>$memberRelationship - $memberName</h4>                      
                    </li>
                    <!-- <li>
                      <h4>Gender</h4>
                      <span>$memberGender</span>
                    </li>                  
                    <li>
                      <h4>D.O.B</h4>
                      <span>$memberDOB</span>
                    </li>
                    <li>
                      <h4>Birth Cert</h4>
                      <span>$memberIdNo</span>
                    </li>
                    <li>
                      <h4>Microchip</h4>
                      <span>#if($UtilMethods.isSet($memberPetMicrochipId)) $memberPetMicrochipId #else Nil #end</span>
                    </li> -->
                  #if($UtilMethods.isSet($photo))
                      <li>
                        <p>Photo</p>
                      <img class="petImage" src="/dotCMS/purchase/buynow?action=tempPhoto&tempid=$photo"/>
                      </li>
                    #end
                  </ul>
                </div>

              </div>
              <a href="" class="arrowMore btnfurtherInfo"></a>
            </li>
          #end
          <!-- Hide for pet -->
          <!-- This have to be outside the if else, if not will have $math error -->
          #if($product.formula != "pets")
              <li>
                <div class="">
                  <h4>Number of persons covered:</h4>
                  #set ($count = 0)
                  #set ($memberCount = 0)                  
                  #if ($UtilMethods.isSet($memberName))
                    #set ($members = $memberName.split(","))
                    #set ($count = $math.add($members.size(),-1))      
                    #set ($memberCount = $members.size())     
                    #if ($members.size() > 0)
                      #if($product.formula == "pets")
                        <strong>You and your pet</strong>
                      #else
                        <strong>You and $members.size() family  #if ($members.size() > 1) members #else member #end</strong>
                      #end  
                    #end      
                  #else
                    <strong>You</strong>
                    #set ($count = 0)
                  #end
                  <div class="furtherInfo">
                    <ul class="summaryFamily">
                      <li>You - $policyHolderName</li>
                        #if ($UtilMethods.isSet($members) && $members.size() > 0)
                          #foreach($i in [0..$count])
                            #if($product.formula == "pets")
                               <li>Your Pet - $members[$i]</li>            
                            #else 
                               <li>$members[$i]</li>
                            #end            
                          #end
                        #end                
                    </ul>
                  </div>
                </div>
                <a href="" class="arrowMore btnfurtherInfo"></a>
              </li>
          #else
              #set ($count = 0)
              #set ($memberCount = 0)                  
              #if ($UtilMethods.isSet($memberName))
                #set ($members = $memberName.split(","))
                #set ($count = $math.add($members.size(),-1))      
                #set ($memberCount = $members.size())
              #else
                #set ($count = 0)
              #end
          #end
          <!-- Hide for pet Ended -->
        #end
        #if ($hasUpgrade.equals("Y"))       
          #if ($coveragePlan.equals("Upgrade"))
            <li>
            <div class="">
              <h4>$upgradeSummaryHeader</h4>
              <strong>$upgradeSummaryDescription</strong>
            </div>
            </li>  

          #else
    
            <li>
            <div class="">
              <h4>$basicSummaryHeader</h4>
              <strong>$basicSummaryDescription</strong>
            </div>
            </li>          
          #end
        #end

        

        <li class="totalCost clearfix">
          <div>
            <ul>
                #set($border = "")
                #set($grossPremium = $premiumCalculationResult.grossPremium)
                #set($additionalPremium = $premiumCalculationResult.additionalPremium)
                #set($additionalPremiumDescription = $premiumCalculationResult.additionalPremiumDescription)
                #set($discount = $premiumCalculationResult.discountAmount)
                #set($rebate = $premiumCalculationResult.rebateAmount)
                #set($totalPremium = $premiumCalculationResult.totalPayable)
                #set($gstamount = $premiumCalculationResult.gstAmount)
                #set($gstVal = $premiumCalculationResult.gst)
                #if ($UtilMethods.isSet($premiumCalculationResult.sst))
                    #set($sstamount = $premiumCalculationResult.sstAmount)
                    #set($sstVal = $premiumCalculationResult.sst)
                #end
                #set($stampDuty = $premiumCalculationResult.stampDuty)
                #set($promoDiscount = $premiumCalculationResult.promoDiscount)
                #set($grandTotal = $premiumCalculationResult.totalPayable)
                
                #if($number.format("#.##", $grandTotal).endsWith("."))
                    #set($format = "#[[#,##0.00]]#")
                #else
                    #set($format = "#[[#,##0]]#")
                #end

                #if ($product.formula == "motor")
                      <li class="summaryDiscount"><p>Basic Premium</p><span>RM $number.format($format, $motorCalculationResult.basePremium)</span> </li>
                      #if ($UtilMethods.isSet($motorCalculationResult.loading) && $motorCalculationResult.loading > 0)
                      <li class="summaryDiscount">Loading<span>RM $number.format($format, $motorCalculationResult.loading)</span> </li>
                      #end
                      #if ($UtilMethods.isSet($motorCalculationResult.ncdAmount) && $motorCalculationResult.ncdAmount > 0)
                      <li class="summaryDiscount"><p>No Claim Discount ($!{motorCalculationResult.ncdRate}%)</p><span>- RM $number.format($format, $motorCalculationResult.ncdAmount)</span> </li>
                      #end
                      
                      <!-- Additional Drivers -->
                      #if ($members.size() > 2 && !$motorAddWaiverCompulsoryExcessParam)
                        <li class="summaryDiscount"><p>Additional Drivers ($premiumCalculationResult.additionalDriver)</p><span>RM $number.format($format, $premiumCalculationResult.additionalDriverPremium)</span> </li>
                      #end
                      
                      <!-- Additional Drivers End-->

                      #if($motorAddLegalLiabilityToPassengersParam || $motorAddLegalLiabilityOfPassengersParam || $motorAddSpecialPerilsParam || $motorAddWindscreenParam || $motorAddSRCCParam || $motorAddSmartKeyShieldParam || $motorAddDriverPersonalAccidentParam || $motorAddLimitedSpecialPerilsParam || $motorAddEHailingParam || $motorAddBettermentParam || $motorAddCARTParam || $motorAddWaiverCompulsoryExcessParam || $motorAddUnlimitedTowingParam || $motorAddNcdReliefParam)
                       <li class="summaryDiscount">Additional Benefits/Extensions</li>
                      #else
                      #end

                      #if ($motorAddLegalLiabilityToPassengersParam)
                      <li class="summaryDiscount pushIn"><p>Passenger Legal Liability</p><span>RM $number.format($format, $motorCalculationResult.addLegalLiabilityToPassengersPremium)</span> </li>
                      #end
                      #if ($motorAddLegalLiabilityOfPassengersParam)
                      <li class="summaryDiscount pushIn //pushTop"><p>Legal Liability of Passenger for Acts of Negligence</p><span>RM $number.format($format, $motorCalculationResult.addLegalLiabilityOfPassengersPremium)</span> </li>
                      #end
                      #if ($motorAddSpecialPerilsParam)
                      <li class="summaryDiscount pushIn //pushTop"><p>Special Perils ( floods , storm , landslide , landslip , subsidence)</p><span>RM $number.format($format, $motorCalculationResult.addSpecialPerilsPremium)</span> </li>
                       #end        
                      #if ($motorAddLimitedSpecialPerilsParam)
                      #set($sum = $!premiumCalculationResult.sumInsured)
                      #set($calc_25 = $sum * 25 / 100)
                      <li class="summaryDiscount pushIn //pushTop"><p>Limited Special Perils ( floods , storm , landslide , landslip , subsidence) - RM $number.format("#[[#,##0]]#", $calc_25)</p><span>RM $number.format($format, $motorCalculationResult.addLimitedSpecialPerilsPremium)</span> </li>
                      #end
                      #if ($motorAddSRCCParam)
                      <li class="summaryDiscount pushIn //pushTop"><p>SRCC (Strikes, Riots and Civil Commotion)</p><span>RM $number.format($format, $motorCalculationResult.addSRCCPremium)</span> </li>
                      #end
                      #if ($motorAddUnlimitedTowingParam)
        			  <li class="summaryDiscount pushIn //pushTop"><p>24-Hour Unlimited Towing Service</p><span>RM $number.format($format, $motorCalculationResult.addUnlimitedTowingPremium)</span> </li>
					  #end
                      #if ($motorAddWaiverCompulsoryExcessParam)
                      <li class="summaryDiscount pushIn //pushTop">
                        <p>Waiver of Compulsory Excess</p><span>RM $number.format($format, $motorCalculationResult.addWaiverCompulsoryExcessPremium)</span>     
                      </li>
                      #end
                      #if ($motorAddEHailingParam)
                      <li class="summaryDiscount pushIn"><p>E-Hailing</p><span>RM $number.format($format, $motorCalculationResult.addEHailingPremium)</span> </li>
                      #end
                      #if ($motorAddBettermentParam)
                      <li class="summaryDiscount pushIn //pushTop"><p>Waiver of Betterment Cost</p><span>RM $number.format($format, $motorCalculationResult.addBettermentPremium)</span> </li>
                      #end
                      #if ($motorAddWindscreenParam)
                      <li class="summaryDiscount pushIn"><p>Windscreen Coverage - RM $number.format("#[[#,##0]]#", $motorAddWindscreenSumInsured)</p><span>RM $number.format($format, $motorCalculationResult.addWindscreenPremium)</span> </li>
                      #end
                      #if ($motorAddSmartKeyShieldParam)
                        #set($annualPremium = $motorCalculationResult.totalPremium)    	                      <li class="summaryDiscount pushIn"><p>Smart Key Shield Coverage - RM $number.format("#[[#,##0]]#", $motorAddSmartKeyShieldSumInsured)</p><span>RM $number.format($format, $motorCalculationResult.addSmartKeyShieldPremium)</span> </li>
                      #end
                      #if ($motorAddDriverPersonalAccidentParam)
                      <li class="summaryDiscount pushIn"><p>Driver's Personal Accident Coverage - RM $number.format("#[[#,##0]]#", $motorAddDriverPersonalAccidentSumInsured)</p><span>RM $number.format($format, $motorCalculationResult.addDriverPersonalAccidentPremium)</span> </li>
                      #end
                      #if ($motorAddCARTParam)
                      <li class="summaryDiscount pushIn">CART Extension
                      #if ($additionalPlan07)
                        7 Days
                      #elseif($additionalPlan14)
                        14 Days
                      #else
                        21 Days
                      #end
                      
                      - RM $number.format("#[[#,##0]]#", $motorAddCARTSumInsured)<span>RM $number.format($format, $motorCalculationResult.addCARTPremium)</span> </li>
                      #end
                      #if ($motorAddNcdReliefParam)    	
                      <li class="summaryDiscount pushIn //pushTop"><p>Current Year 'NCD' Relief</p><span>RM $number.format($format, $motorCalculationResult.addNcdReliefPremium)</span> </li>
                      #end
                      #if($motorCalculationResult.netPremium)
                        #set($annualPremium = $motorCalculationResult.netPremium)
                        #if ($UtilMethods.isSet($discount))
                          #set($annualPremium = $math.add($annualPremium,$discount))
                          #end  
                        #if ($UtilMethods.isSet($rebate))
                          #set($annualPremium = $math.add($annualPremium,$rebate))
                        #end
                        #if ($UtilMethods.isSet($promoDiscount))		
                          #foreach($cont in $promoDiscount)		
                            #set($annualPremium = $math.add($annualPremium,$cont.discountAmount))		
                          #end
                        #end
                      <li class="summaryDiscount borderTop"><p>Annual Premium</p><span>RM $number.format($format, $annualPremium)</span> </li>              
                      #end
                #else
                      <li class="summaryDiscount">
                      #if(($productCode == "DLT" && $travelPlan == "annual" && $CmsSettingUtil.findStaffRelationship($staffRelationship) == "Direct Relationship"))
                        <p>Gross Premium <span class="staffPromoNote">(Included additional 15% staff discount)</span></p>
                      #else
                        <p>Gross Premium</p>
                      #end
                      <span>RM $number.format($format, $grossPremium)</span> </li>
                #end
                #if ($product.getDiscount().equals("0") || $product.getDiscount().equals("0.0"))
                     <li class="summaryDiscount" id="summaryDiscountRow" style="display: none !important;"><p>#if($UtilMethods.isSet($productExtended.getDiscountRebateLabel())) $productExtended.getDiscountRebateLabel() #else Discount #end @ $product.getDiscount()% </p><span>- RM $number.format($format, $discount)</span> </li>
                #else
                   <li class="summaryDiscount" id="summaryDiscountRow"><p>#if($UtilMethods.isSet($productExtended.getDiscountRebateLabel())) $productExtended.getDiscountRebateLabel() #else Discount #end @ $product.getDiscount()% </p><span>- RM $number.format($format, $discount)</span> </li>
                #end
                #if ($rebate > 0)
                      <li class="summaryDiscount">Rebate Amount<span>- RM $number.format($format, $rebate)</span></li>
                #end
                #set($border = "border")
                #if(!($productCode == "DLT" && $travelPlan == "annual" && $CmsSettingUtil.findStaffRelationship($staffRelationship) == "Direct Relationship"))
                    #if($promoDiscount.size() > 0)
                        #if($productCode == "MSM")
                            <li class="summaryDiscount $!{border}">  <span> RM $number.format($format, $math.sub( $annualPremium,$discount ))</span></li>
                            #set($tempAmount = $math.sub($annualPremium,$discount))
                        #else
                            <li class="summaryDiscount $!{border}">  <span> RM $number.format($format, $math.sub( $grossPremium,$discount ))</span> </li>
                            #set($tempAmount = $math.sub($grossPremium,$discount))
                        #end
                        
                        #foreach($cont in $promoDiscount)
                            #set($tempAmount = $math.sub($tempAmount,$cont.discountAmount))
                            <li class="summaryDiscount "><p>$cont.discountLabel @ $cont.discountRate %</p><span>- RM $number.format($format,$cont.discountAmount)</span></li>
                            <li class="summaryDiscount $!{border}"> </span><span> RM $number.format($format,$tempAmount)</span></li>
                        #end
                    #end
                #end

                <!--        #if ($UtilMethods.isSet($gstVal))
                    #if ($gstVal > 0)
                        <li class="summaryDiscount"><p>GST @ $gstVal% (Standard Rate)</p><span>RM $number.format($format, $gstamount)</span> </li>
                    #else
                        <li class="summaryDiscount"><p>GST @ 0% (Standard Rate)</p><span>RM 0.00</span> </li>
                    #end
                #else
                     #### gst exempted
                #end -->
      
                #if ($UtilMethods.isSet($premiumCalculationResult.sst))
                    #if ($UtilMethods.isSet($sstVal))
                        #if ($sstVal > 0)
            				<li class="summaryDiscount"><p>Service Tax Rate @ $sstVal%</p><span id="summarySstValue">RM $number.format($format, $sstamount)</span> </li>
                        #else
                            <li class="summaryDiscount"><p>Service Tax Rate  @ 0%</p><span>RM 0.00</span> </li>
                        #end
                    #else
                         #### sst exempted
                    #end
                #else
                    #if ($UtilMethods.isSet($gstVal))
                        #if ($gstVal > 0)
                            <li class="summaryDiscount"><p>GST @ $gstVal% (Standard Rate)</p><span>RM $number.format($format, $gstamount)</span> </li>
                        #else
                            <li class="summaryDiscount"><p>GST @ 0% (Standard Rate)</p><span>RM 0.00</span> </li>
                        #end
                    #else
                         #### gst exempted
                    #end
                #end
      
                #if ($UtilMethods.isSet($additionalPremium))
                <li class="summaryDiscount"><p>$additionalPremiumDescription</p><span>RM $number.format($format, $additionalPremium)</span></li>
                #end        
                #if ($UtilMethods.isSet($stampDuty) && $stampDuty > 0)
                 <li class="summaryStamp"><p>Stamp Duty </p><span>RM $number.format($format,$stampDuty)</span></li>  
                #set($border = "border")
                #end        
                <li class="summaryTotal $!{border}"><p>Total Amount Payable </p><span id="summaryGrandTotal">RM $number.format($format, $grandTotal)</span></li>
            </ul>                    
          </div>
        </li>  
        #if($partnerCode == "sw")
        <li class="fieldgroup clearfix">
                <label style="font-weight: bold; font-size: 0.9em;" for="membershipID">Please Enter Your Sunway Pals Number (Optional)</label><img class="tooltip-icon" src="/img/icon_info-02.png" title="Sunway Pals" desc="
                <ul>
                    <li>Please key in your Sunway Pals Member ID/ Card no. to collect Pals Points.</li>
                    <li>Do ensure that you key in the correct Member ID/ Card no. Incorrect input will not be processed.</li>
                    <li>Pals Points will be credited to your account within 14 working days.</li>
                    <li>Please login at <a href='https://sunwaypals.com.my/' target='_blank'>https://sunwaypals.com.my/</a> to check your Member ID/ Card no.</li>
                </ul>"><br>
                <input  style="width: 100%;border-radius: 5px;box-sizing: border-box;padding: 8px 8px 3px;font-family: 'pt_sansregular';border: 1px solid gray;" name="membershipID" class="required policyHolderSunwayPalsNumber" minlength="19" maxlength="19" id="membershipID" type="text" data-name="SUNWAYPALSNUMBER" placeholder="XXXX-XXXX-XXXX-XXXX" value="$membershipID" autocomplete="off">
              </li>
        #elseif($partnerCode == "SHOP")
        <li class="fieldgroup clearfix">
                <label style="font-weight: bold; font-size: 0.9em;" for="membershipID">MY.SHOP.COM Privileged Card ID</label><br>
                <input  style="width: 100%;border-radius: 5px;box-sizing: border-box;padding: 8px 8px 3px;font-family: 'pt_sansregular';border: 1px solid gray;" name="membershipID" class="required membershipID" minlength="6" maxlength="12" id="membershipID" type="text" data-name="MEMBERSHIP ID" placeholder="XXXXXXXXXXXX" value="#if($UtilMethods.isSet($membershipID))$membershipID #end" autocomplete="off">
              </li>
        #elseif($partnerCode == "cnt")
         <li class="fieldgroup clearfix">
                <label style="font-weight: bold; font-size: 0.9em;" for="membershipID">Reference Code <label style="font-style:italic">(Optional)</label></label><br>
                <input  style="width: 100%;border-radius: 5px;box-sizing: border-box;padding: 8px 8px 3px;font-family: 'pt_sansregular';border: 1px solid gray;text-transform:uppercase" name="membershipID" class="required membershipID" maxlength="7" id="membershipID" type="text" data-name="MEMBERSHIP ID" placeholder="XXXXXXX" value="#if($UtilMethods.isSet($membershipID))$membershipID #end" autocomplete="off">
              </li>
        #end   
        #if($allowPromoCode == true)
        ##if($partnerCode == "hlb") ##nuimei-promoCode
            <li class="fieldgroup clearfix form-group">
                <label for="promoCode">Promo Code (Optional)</label>
                <br>
    			<input type="text" id="promoCode" class="nonMmpPromoCode" name="promotionCode" value="$!promotionCode" minlength="6" maxlength="12" placeholder="PROMOABC" autocomplete="off">
                <span class="applyPromoContainer">
                    <a class="button ok-btn nonMmpApplyPromoCode" id="applyPromoCode">Apply</a>
                </span>
    			<small class="promoCodeError"></small>
		    </li>
		#end
      </ul>
     
                
                <div class="checkBox"><input type="checkbox" id="boxCheck" name="agreeToTnC" value="Y"> <label for="boxCheck">By ticking this box, I hereby acknowledge that I have read the   #if($date.date.before($date.toDate('yyyy-M-d H:m:s',"2018-09-01 00:00:00")))<a href="$productDisclosurePDFGstHtml" class="iconPdf" target="_blank"><!--#if($product.formula == "pets") #if($product.productCode == "MOP") Product Disclosure Sheet #else Brochure with Product Disclosure Sheet #end  #else Product Disclosure #end--> #else <a href="$productDisclosurePDFHtml" class="iconPdf" target="_blank"> #end Product Disclosure Sheet</a> and have agreed to the <a id="linkTnc" href="javascript(0)">Terms & Conditions</a>.</label></div>
				
		#end
        #if($productExtended.getAllowMotorPlusPlan() != "Y" && $product.productName != "Motorcycle")
        <div class="navBottom summaryFooter">
            <ul class="clearfix">
                <li class="prevArrow"><a class="ir alignLeft" href="#" onClick="javascript: return false;"><span class="button">Back</span>Previous</a></li>
                <li class="smallLogo">
                    <a href="/$partnerURLTitle$actionAddOnURL" class="ir">MSIG</a>
				</li>
                <li class="nextArrow "><a class="ir alignRight" id="checkSubmit" href="#" onClick="javascript:proceed(); return false;"><span class="button">Continue</span> Next</a></li>
			</ul>
        </div>
		#end

  <input name="coverageStartDate" type="hidden" value="$!esc.html($!coverageStartDate)">
  <input name="coverageExpiryDate"  type="hidden" value="$!esc.html($!coverageExpiryDate)">      
        
<input name="policyHolderName"  id="policyHolderName" type="hidden"  value="$!esc.html($!policyHolderName)">
<input name="policyHolderNRIC"  id="policyHolderNRIC" type="hidden" value="$!esc.html($!policyHolderNric)">
<input name="policyHolderMalaysian"  id="policyHolderMalaysian" type="hidden"  value="$!esc.html($!policyHolderMalaysian)">
<input name="policyHolderGender"  id="policyHolderGender" type="hidden"  value="$!esc.html($!policyHolderGender)">
<input name="policyHolderDrivingExp"  id="policyHolderDrivingExp" type="hidden"  value="$!esc.html($!policyHolderDrivingExp)">
<input name="policyHolderDateOfBirth"  id="policyHolderDateOfBirth" type="hidden"  value="$!esc.html($!policyHolderDateOfBirth)">
<input name="policyHolderNationality"  id="policyHolderNationality" type="hidden"  value="$!esc.html($!policyHolderNationality)">
<input name="policyHolderEmail"  id="policyHolderEmail" type="hidden"  value="$!esc.html($!policyHolderEmail)">
<input name="policyHolderMobileNo"  id="policyHolderMobileNo" type="hidden" value="$!esc.html($!policyHolderMobileNo)">
<input name="policyHolderMaritalStatus"  id="policyHolderMaritalStatus" type="hidden" value="$!esc.html($!policyHolderMaritalStatus)">
<input name="policyHolderOccupation"  id="policyHolderOccupation" type="hidden" value="$!esc.html($!policyHolderOccupation)">      
<input name="photo"  id="photo" type="hidden" value="$!photo">
     <!--Tax invoice amend -->    	
<input name="policyHolderAddressLine1"  id="policyHolderAddressLine1" type="hidden" value="$!esc.html($!policyHolderAddressLine1)">		
<input name="policyHolderAddressLine2"  id="policyHolderAddressLine2" type="hidden" value="$!esc.html($!policyHolderAddressLine2)">
<input name="refAddress1" id="refAddress1" type="hidden" value="$!esc.html($!refAddress1)">
<input name="refAddress2" id="refAddress2" type="hidden" value="$!esc.html($!refAddress2)">
<input name="addressOverwriteIndicator" id="addressOverwriteIndicator" type="hidden" value="$!esc.html($!addressOverwriteIndicator)">
<input name="addressPostcode"  id="addressPostcode" type="hidden" value="$!esc.html($!addressPostcode)">
<input name="addressState"  id="addressState" type="hidden" value="$!esc.html($!addressState)">
<input name="addressCity"  id="addressCity" type="hidden" value="$!esc.html($!addressCity)">
<input name="propertyPostcode"  id="propertyPostcode" type="hidden" value="$!esc.html($!propertyPostcode)">
<input name="propertyAddressLine1"  id="propertyAddressLine1" type="hidden" value="$!esc.html($!propertyAddressLine1)">
<input name="propertyAddressLine2"  id="propertyAddressLine2" type="hidden" value="$!esc.html($!propertyAddressLine2)">
<input name="locationAddressLine1"  id="locationAddressLine1" type="hidden" value="$!esc.html($!locationAddressLine1)">
<input name="locationAddressLine2"  id="locationAddressLine2" type="hidden" value="$!esc.html($!locationAddressLine2)">
<input name="propertyState"  id="propertyState" type="hidden" value="$!esc.html($!propertyState)">      
<input name="propertyCity"  id="propertyCity" type="hidden" value="$!esc.html($!propertyCity)">      
<input name="studentId"  id="studentId" type="hidden" value="$!esc.html($!studentId)">      
<input name="staffId"  id="staffId" type="hidden" value="$!esc.html($!staffId)">
<input name="staffRelationship"  id="staffRelationship" type="hidden" value="$!esc.html($!staffRelationship)">
<input name="campus"  id="campus" type="hidden" value="$!esc.html($!campus)">      
<input name="certificateNo" id="certificateNo" data-name="certificateNo"  type="hidden" value="$!esc.html($!request.getParameter('certificateNo'))"> 
<input name="motorChassisNo"  id="motorChassisNo" data-name="motorChassisNo" value="$!esc.html($!request.getParameter('motorChassisNo'))" type="hidden">
<input name="motorRegistrationNo"  id="motorRegistrationNo" data-name="motorRegistrationNo" value="$!esc.html($!request.getParameter('motorRegistrationNo'))" type="hidden">
<input name="ISMEngineNo"  id="ISMEngineNo" data-name="ISMEngineNo" value="$!esc.html($!request.getParameter('ISMEngineNo'))" type="hidden">
<input name="motorMakeCode"  id="motorMakeCode" value="$!esc.html($!request.getParameter('motorMakeCode'))" type="hidden">
<input name="motorModelCode"  id="motorModelCode" data-name="motorModelCode" value="$!esc.html($!request.getParameter('motorModelCode'))" type="hidden">
<input name="motorCc"  id="motorCc" data-name="motorCc" value="$!esc.html($!request.getParameter('motorCc'))" type="hidden">
<input name="enableCcDropDown"  id="enableCcDropDown" data-name="enableCcDropDown" value="$!esc.html($!request.getParameter('enableCcDropDown'))" type="hidden">
<input name="motorYearOfMake"  id="motorYearOfMake" data-name="motorYearOfMake" value="$!esc.html($!request.getParameter('motorYearOfMake'))" type="hidden">
<input name="motorVariant"  id="motorVariant" data-name="motorVariant" value="$!esc.html($!request.getParameter('motorVariant'))" type="hidden">
<input name="motorStyle"  id="motorStyle" data-name="motorStyle" value="$!esc.html($!request.getParameter('motorStyle'))" type="hidden">
<input name="motorSeat"  id="motorSeat" data-name="motorSeat" value="$!esc.html($!request.getParameter('motorSeat'))" type="hidden">
<input name="motorTransmission"  id="motorTransmission" data-name="motorTransmission" value="$!esc.html($!request.getParameter('motorTransmission'))" type="hidden">
<input name="motorFamily"  id="motorFamily" data-name="motorFamily" value="$!esc.html($!request.getParameter('motorFamily'))" type="hidden">
<input name="motorMake"  id="motorMake" data-name="motorMake" value="$!esc.html($!request.getParameter('motorMake'))" type="hidden">
<input name="motorNvic"  id="motorNvic" data-name="motorNvic" value="$!esc.html($!request.getParameter('motorNvic'))" type="hidden">
<input name="motorDisplayNxtNcd"  id="motorDisplayNxtNcd" data-name="motorDisplayNxtNcd" value="$!esc.html($!request.getParameter('motorDisplayNxtNcd'))" type="hidden">
<input name="motorVehiclePremiumValue"  id="motorVehiclePremiumValue" data-name="motorVehiclePremiumValue" value="$!esc.html($!request.getParameter('motorVehiclePremiumValue'))" type="hidden">


<input name="coveragePlan" type="hidden"  value="$!esc.html($!coveragePlan)" />


<input name="coveragePremiumRate" type="hidden"  value="$!product.getNormalRate()" />

<input name="branchAbbr" id="branchAbbr" type="hidden" value="$!esc.html($!branchAbbr)" />
<input name="staffName" id="staffName" type="hidden" value="$!esc.html($!staffName)"  />
<input name="agentNumber" id="agentNumber" type="hidden" value="$!esc.html($!agentNumber)" />

#if ($product.getIsSeasonal().equals("Y"))
  <input type="hidden" name="coveragePremiumType" value="promotion" />
#else
  <input type="hidden" name="coveragePremiumType" value="default" />
#end
<input name="travelPlan" type="hidden" value="$!esc.html($!travelPlan)" />
<input name="travelArea" type="hidden" value="$!esc.html($!travelArea)" />
<input name="travelBenefitPlan" type="hidden" value="$!esc.html($!travelBenefitPlan)" />
<input name="coveragePremiumDiscount" type="hidden"  value="$!esc.html($!discount)" />
<input name="coverageStampDuty" type="hidden"  value="$!esc.html($!stampDuty)" />
<input name="noDaysCovered" type="hidden"  value="$!esc.html($!noDaysCovered)" />
<input name="totalPremium" type="hidden"  value="$!esc.html($!grandTotal)" >
  #if ($UtilMethods.isSet($members) && $members.size() > 0)

    <input name="memberName"  type="hidden" value="$!esc.html($!memberName)">

    <input name="memberIdNo"  type="hidden" value="$!esc.html($!memberIdNo)">
    
    #if($product.formula == "pets") 
      <input name="memberIsMalaysian"  type="hidden" value="N">
       <input name="memberGender"  id="memberGender" type="hidden" value="$!esc.html($!memberGender)">
    #else 
      <input name="memberIsMalaysian"  type="hidden" value="$!esc.html($!memberIsMalaysian)">
       <input name="memberGender"  id="memberGender" type="hidden" value="$!esc.html($!memberGenderStr)">
    #end
    <input name="memberRelationship"  type="hidden" value="$!esc.html($!memberRelationship)">
    <input name="driverRelationship"  type="hidden" value="$!esc.html($!driverRelationshipStr)">
    <input name="memberDOB"  type="hidden" value="$!esc.html($!memberDOB)">  
    
    <input name="memberMotorDrivingExperience"  type="hidden" value="$!esc.html($!memberMotorDrivingExperience)">
    
    <input name="memberOccupation"  type="hidden" value="$!esc.html($!memberOccupation)">  
    
    <input name="memberPetBreed"  id="memberPetBreed" type="hidden" value="$!esc.html($!memberPetBreed)">
   
    <input name="memberPetMicrochipId"  id="memberPetMicrochipId" type="hidden" value="$!esc.html($!memberPetMicrochipId)">
    <input name="memberPhoto"  id="memberPhoto" type="hidden" value="$!memberPhoto">
  #end
  
  #if($productExtended.getAllowMotorPlusPlan() == "Y" || $product.productName == "Motorcycle")
    <input type="hidden" name="basicPremium" value="$!esc.html($!request.getParameter('basicPremium'))">
	<input type="hidden" name="ncdAmount" value="$!esc.html($!request.getParameter('ncdAmount'))">
	<input type="hidden" name="netNcdAmount" value="$!esc.html($!request.getParameter('netNcdAmount'))">
	<input type="hidden" name="annualPremium" value="$!esc.html($!request.getParameter('annualPremium'))">
    <input type="hidden" name="excess" value="$!esc.html($!request.getParameter('excess'))">
	
	<input type="hidden" name="discount" value="$!esc.html($!request.getParameter('discount'))">
	<input type="hidden" name="sst" value="$!esc.html($!request.getParameter('sst'))">
	<input type="hidden" name="sstVal" value="$!esc.html($!request.getParameter('sstVal'))">
	<input type="hidden" name="stampDuty" value="$!esc.html($!request.getParameter('stampDuty'))">
	<input type="hidden" name="grandTotal" value="$!esc.html($!request.getParameter('grandTotal'))">
	<input type="hidden" name="additionalPremium" value="$!esc.html($!request.getParameter('additionalPremium'))">
    <input type="hidden" name="driverQuantity" value="$!esc.html($!request.getParameter('driverQuantity'))">
	
	<input type="hidden" name="driverPremium" value="$!esc.html($!request.getParameter('driverPremium'))" >
	
    <input type="hidden" name="motorPlusPlanPremium" value="$!esc.html($!request.getParameter('motorPlusPlanPremium'))">
    <input type="hidden" name="allRiderPlanPremium" value="$!esc.html($!request.getParameter('allRiderPlanPremium'))">
    <input type="hidden" name="ncdReliefPremium" value="$!esc.html($!request.getParameter('ncdReliefPremium'))">
    <input type="hidden" name="legalLiabilityToPassengersPremium" value="$!esc.html($!request.getParameter('legalLiabilityToPassengersPremium'))">
	<input type="hidden" name="legalLiabilityOfPassengersPremium" value="$!esc.html($!request.getParameter('legalLiabilityOfPassengersPremium'))">
	
	<input type="hidden" name="specialPerilsPremium" value="$!esc.html($!request.getParameter('specialPerilsPremium'))">
	<input type="hidden" name="limitedSpecialPerilsPremium" value="$!esc.html($!request.getParameter('limitedSpecialPerilsPremium'))">
	<input type="hidden" name="unlimitedTowingPremium" value="$!esc.html($!request.getParameter('unlimitedTowingPremium'))">
	<input type="hidden" name="waiverCompulsoryExcessPremium" value="$!esc.html($!request.getParameter('waiverCompulsoryExcessPremium'))">
	<input type="hidden" name="srccPremium" value="$!esc.html($!request.getParameter('srccPremium'))">
	<input type="hidden" name="riderPAPremium" value="$!esc.html($!request.getParameter('riderPAPremium'))">
	<input type="hidden" name="eHailingPremium" value="$!esc.html($!request.getParameter('eHailingPremium'))">
	<input type="hidden" name="bettermentPremium" value="$!esc.html($!request.getParameter('bettermentPremium'))">
	<input type="hidden" name="windscreenSumInsured" value="$!esc.html($!request.getParameter('windscreenSumInsured'))">
	<input type="hidden" name="smartKeyShieldSumInsured" value="$!esc.html($!request.getParameter('smartKeyShieldSumInsured'))">
	<input type="hidden" name="driverPersonalAccidentSumInsured" value="$!esc.html($!request.getParameter('driverPersonalAccidentSumInsured'))">
	<input type="hidden" name="cartSumInsured" value="$!esc.html($!request.getParameter('cartSumInsured'))">
	#end

  
   </div> <!-- #main -->
        </div> <!-- #main-container -->
    
  
  <div class="tncContainer whilePrompt hidden" #if($productExtended.getAllowMotorPlusPlan().equals("Y") || $product.productName == "Motorcycle") id="mmpTncContainer" #end>
    #if($productExtended.getAllowMotorPlusPlan().equals("Y") || $product.productName == "Motorcycle")
    <a href="" class="closeMMPMsg">✕</a>
    #else
    <a href="javascript:;">Close</a>
    #end
        $tnc
  </div>
   
    <div class="promptOverlay hidden"></div>
    <div class="promptMsg hidden" #if($productExtended.getAllowMotorPlusPlan().equals("Y") || $product.productName == "Motorcycle") id="mmpPromptMsg" #end>
    <p>Oops, looks like you haven't ticked the box yet. Please do so to proceed.</p>
      <a href="">Ok</a>
    </div>
    
    <div class="promptMsg promptNoSaveMsg hidden" id="mmpPromptMsg">
      <p>Oops, looks like you haven't saved your details yet. Please do so to proceed.</p>
      <a href="">Ok</a>
    </div>
    
  </form>
    <div class="errorMsgContainer hidden"><!--errors-->
      <p><strong>Oops, please check your details</strong></p>
      <ul>
        <li>error 1</li>
        <li>error 2</li>
        <li>error 3</li>
      </ul>
      <a href="">Ok, got it</a>
    </div>

  <script type="text/javascript">
    <!-- Motor Plus Review Page Javascript -->
    
        <!-- Edit Driver Details -->
    function editPolicyHolderSection(){
    	// Show the save button and disable the edit button
		$(".policyHolderSaveBtn").show();
		$(".policyHolderEditBtn").hide();
		$("#boxCheck").addClass("promptNoSave");
        
		// Change preview form to editable form
		$(".policyHolderNameSection").find('strong').remove();
		$(".policyHolderEmailSection").find('strong').remove();
		$(".policyHolderMobileNoSection").find('strong').remove();
		$(".policyHolderMaritalStatusSection").find('strong').remove();
		$(".policyHolderDrivingExperienceSection").find('strong').remove();
		$(".policyHolderOccupationSection").find('strong').remove();
		$(".policyHolderAddressSection").find('strong').remove();
        $(".policyHolderGenderSection").find('strong').remove();
		$(".policyHolderDOBSection").find('strong').remove();
        
		$(".policyHolderNameSection").append("<input name='editPolicyHolderName' placeholder='E.g.: Lee Siew Suan' type='text' />");
		$(".policyHolderEmailSection").append("<input name='editPolicyHolderEmail' placeholder='E.g.: you@gmail.com' type='email' maxlength='50' />");
		$(".policyHolderMobileNoSection").append("<input name='editPolicyHolderMobileNo' type='text' maxlength='13' placeholder='E.g.: 018-123 4567'/>");
		$(".policyHolderMaritalStatusSection").append("<select name='editPolicyHolderMaritalStatus'><option value='0' hidden>Select Option</option><option value='S'>Single</option><option value='M'>Married</option></select>");
        $(".policyHolderGenderSection").append("<select name='editPolicyHolderGender'><option value='0' hidden>Select Option</option><option value='M'>Male</option><option value='F'>Female</option></select>");
        $(".policyHolderDOBSection").append("<input name='editPolicyHolderDOB' type='text' />");
        $("input[name=editPolicyHolderDOB]").mask("00/00/0000", {placeholder: "DD/MM/YYYY"});
		$('[name="editPolicyHolderMobileNo"]').mask("000-000 00000", {placeholder: "E.g.: 018-123 4567"});
		$(".policyHolderDrivingExperienceSection").append("<select name='editPolicyHolderDrivingExperience'></select>");
		for(var i = 0; i < 53; i++) {
			$("select[name='editPolicyHolderDrivingExperience']").append("<option value='" + i + "'>" + i + "</option>");
		}
		$(".policyHolderOccupationSection").append("<input name='editPolicyHolderOccupation' placeholder='E.g.: Architect' type='text'/>");
        $(".policyHolderAddressSection").append("<input name='editPolicyHolderAddress1' placeholder='First Line' type='text'/><br/><input name='editPolicyHolderAddress2' placeholder='Second Line' type='text'/><br/><input name='editPolicyHolderPostcode' placeholder='Find Postcode' type='text' />");		
		$('input[name=editPolicyHolderPostcode]').focus(function () {      
			var url = "/js/jquery.autocomplete.min.js?v=$webapi.getAssetInode('/js/jquery.autocomplete.min.js')";
                $.getScript(url, function(){
			jQuery.ajax({
				type: "GET",
				url: '/api/content/render/false/type/json/limit/0/query/+structureName:TieRefCity%20+(conhost:ceaa0d75-448c-4885-a628-7f0c35d374bd%20conhost:SYSTEM_HOST)%20+live:true/orderby/TieRefCity.postcode',            
				dataType: "json",
				success: function (data) {
					var param = "[";
					if (data !== null && data.contentlets.length > 0) {
						for (var i = 0; i < data.contentlets.length; i++) {
							param = param + '{"value": "' + data.contentlets[i].postcode + '", "data": "' + data.contentlets[i].postcode + '"}, ';
						}

					}
					param = param.substring(0, param.length-2) + "]";

					$('input[name=editPolicyHolderPostcode]').autocomplete({
						lookup: JSON.parse(param),
						showNoSuggestionNotice:true,
						noSuggestionNotice:"No results found",
						triggerSelectOnValidInput:false,
						onSelect:function(suggestion){
							$('input[name=editPolicyHolderPostcode]').trigger('change',[suggestion.value]);
						}
						
					});  
				},
			});
			}, true);
		})
		
		
		// Populate the value into edit field
		$("input[name='editPolicyHolderName']").val($("input[name='policyHolderName']").val());
		$("input[name='editPolicyHolderEmail']").val($("input[name='policyHolderEmail']").val());
		$("input[name='editPolicyHolderMobileNo']").val($("input[name='policyHolderMobileNo']").val());
    	$("select[name='editPolicyHolderMaritalStatus']").val($("input[name='policyHolderMaritalStatus']").val());
    	$("select[name='editPolicyHolderGender']").val($("input[name='policyHolderGender']").val());
        $("input[name='editPolicyHolderDOB']").val($("input[name='policyHolderDateOfBirth']").val());
		$("select[name='editPolicyHolderDrivingExperience']").val($("input[name='memberMotorDrivingExperience']").val().split(',')[0]);
		$("input[name='editPolicyHolderOccupation']").val($("input[name='memberOccupation']").val().split(',')[0]);
		$("input[name='editPolicyHolderAddress1']").val($("input[name='policyHolderAddressLine1']").val());
		$("input[name='editPolicyHolderAddress2']").val($("input[name='policyHolderAddressLine2']").val());
		$("input[name='editPolicyHolderPostcode']").val($("input[name='addressPostcode']").val());
		
	}
	
	<!-- Save Driver Details -->
	function savePolicyHolderSection(){
	
		// Validation Start //
		var proceed = true;
		if($("input[name='editPolicyHolderName']").val() == "") {
			proceed = false;
			$(".policyHolderNameSection").find("br, span").remove();
			$(".policyHolderNameSection").append('<br/><span class="invalid" name="invalidName">Complete the Name as per NRIC field.</span>');
		} else if(!validateName($("input[name='editPolicyHolderName']").val())){
			proceed = false;
			$(".policyHolderNameSection").find("br, span").remove();
			$(".policyHolderNameSection").append('<br/><span class="invalid" name="invalidName">Please enter only alphabet,"-","@", "/" and " \' " for Name.</span>');
		} else {
			$(".policyHolderNameSection").find("br, span").remove();
		}
		
		if($("input[name='editPolicyHolderEmail']").val() == "") {
			proceed = false;
			$(".policyHolderEmailSection").find("br, span").remove();
			$(".policyHolderEmailSection").append('<br/><span class="invalid" name="invalidEmail">Complete the Email Address field.</span>');
		} else if(!$("input[name='editPolicyHolderEmail']").valid()){
			proceed = false;
			$(".policyHolderEmailSection").find("br, span").remove();
			$(".policyHolderEmailSection").append('<br/><span class="invalid" name="invalidEmail">Check your email address.</span>');
		} else {
			$(".policyHolderEmailSection").find("br, span").remove();
		}
		
		if($("input[name='editPolicyHolderMobileNo']").val() == "") {
			proceed = false;
			$(".policyHolderMobileNoSection").find("br, span").remove();
			$(".policyHolderMobileNoSection").append('<br/><span class="invalid" name="invalidContactNo">Complete the Contact No. field.</span>');
		} else if(!validateContactNo($("input[name='editPolicyHolderMobileNo']").val())){
			proceed = false;
			$(".policyHolderMobileNoSection").find("br, span").remove();
			$(".policyHolderMobileNoSection").append('<br/><span class="invalid" name="invalidContactNo">Please enter valid contact no.</span>');
		} else {
			$(".policyHolderMobileNoSection").find("br, span").remove();
		}
		
		if($("input[name='editPolicyHolderAddress1']").val() == "") {
			proceed = false;
			$(".policyHolderAddressSection").find("span").remove();
			$(".policyHolderAddressSection").append('<span class="invalid" name="invalidAddress"><br/>Complete the Address field.</span>');
		} else {
			$(".policyHolderAddressSection").find("span").remove();
		}
		
		if($("select[name='editPolicyHolderMaritalStatus'] option:selected").val() == "0") {
			proceed = false;
			$(".policyHolderMaritalStatusSection").find("br, span").remove();
			$(".policyHolderMaritalStatusSection").append('<br/><span class="invalid" name="invalidMaritalStatus">Complete the Marital Status field.</span>');
		} else {
			$(".policyHolderMaritalStatusSection").find("br, span").remove();
		}
		
		if($("input[name='editPolicyHolderOccupation']").val() == "") {
			proceed = false;
			$(".policyHolderOccupationSection").find("br, span").remove();
			$(".policyHolderOccupationSection").append('<br/><span class="invalid" name="invalidOccupation">Complete the Occupation field.</span>');
		} else {
			$(".policyHolderOccupationSection").find("br, span").remove();
		}
		
		if($("input[name='editPolicyHolderPostcode']").val() == "") {
    		proceed = false;
			$(".policyHolderAddressSection").find("br, span").remove();
			$(".policyHolderAddressSection").append('<br/><span class="invalid" name="invalidPostcode">Complete the Postcode field.</span>');
		} else {
			$(".policyHolderAddressSection").find("br, span").remove();
			
		}
        
        if($("select[name='editPolicyHolderGender'] option:selected").val() == "0") {
    		proceed = false;
			$(".policyHolderGenderSection").find("br, span").remove();
			$(".policyHolderGenderSection").append('<br/><span class="invalid" name="invalidDriverGender">Complete the Gender field.</span>');
		} else {
			$(".policyHolderGenderSection").find("br, span").remove();
		}
        
		if($("input[name='policyHolderMalaysian']").val() != "Y") {
            if($("input[name='editPolicyHolderDOB']").val() == "") {
            	proceed = false;
    			$(".policyHolderDOBSection").find("br, span").remove();
    			$(".policyHolderDOBSection").append('<br/><span class="invalid" name="invalidDriverDOB">Complete the Date of Birth field.</span>');
    		} else if(!validatePolicyHolderAgeLimit($("input[name='editPolicyHolderDOB']").val())){
        		proceed = false;
    		} else {
    			$(".policyHolderDOBSection").find("br, span").remove();
    		}
        }
        
		// Validation End //
		
		if(proceed){
	
			// Hide the save button and enable the edit button
			$(".policyHolderEditBtn").show();
			$(".policyHolderSaveBtn").hide();
            var saveBtn = document.querySelectorAll("[id='saveBtn']");
            var allowProceed = true;
            for(var i = 0; i < saveBtn.length; i++) {
                 var displaySave = saveBtn[i].style.display;
                 console.log(displaySave);
                 if(displaySave == 'inline-block'){
                    allowProceed = false;
                 }
            }
            
            if(allowProceed) {
    			$("#boxCheck").removeClass("promptNoSave");
            }
            
			// Change the value of hidden input
			$("input[name='policyHolderName']").val($("input[name='editPolicyHolderName']").val());
			$("input[name='policyHolderEmail']").val($("input[name='editPolicyHolderEmail']").val());
			$("input[name='policyHolderMobileNo']").val($("input[name='editPolicyHolderMobileNo']").val());
    		$("input[name='policyHolderMaritalStatus']").val($("select[name='editPolicyHolderMaritalStatus']").val());
    		$("input[name='policyHolderGender']").val($("select[name='editPolicyHolderGender']").val());
            $("input[name='policyHolderDateOfBirth']").val($("input[name='editPolicyHolderDOB']").val());
			$("input[name='policyHolderOccupation']").val($("input[name='editPolicyHolderOccupation']").val());
			if($("input[name='productName']").val() != 'Motorcycle') {
                var drivingExpStr = "";
    			for (var i = 0; i < $("input[name='memberMotorDrivingExperience']").val().split(",").length; i ++) {
    				var drivingExpValue = $("input[name='memberMotorDrivingExperience']").val().split(",")[i];
    				if (i == 0){
    					drivingExpValue = $("select[name='editPolicyHolderDrivingExperience']").val();
    					drivingExpStr = drivingExpStr + drivingExpValue;
    				} else {
    					drivingExpStr = drivingExpStr + "," + drivingExpValue;
    				}
    			}
    			$("input[name='memberMotorDrivingExperience']").attr("value", drivingExpStr);
			}
			var occupationStr = "";
			for (var i = 0; i < $("input[name='memberOccupation']").val().split(",").length; i ++) {
				var occupationValue = $("input[name='memberOccupation']").val().split(",")[i];
				if (i == 0){
					occupationValue = $("input[name='editPolicyHolderOccupation']").val();
					occupationStr = occupationStr + occupationValue;
				} else {
					occupationStr = occupationStr + "," + occupationValue;
				}
			}
    		$("input[name='memberOccupation']").attr("value", occupationStr);

            var genderStr = "";
    		for (var i = 0; i < $("input[name='memberGender']").val().split(",").length; i ++) {
				var genderValue = $("input[name='memberGender']").val().split(",")[i];
				if (i == 0){
					genderValue = $("select[name='editPolicyHolderGender']").val();
					genderStr = genderStr + genderValue;
				} else {
					genderStr = genderStr + "," + genderValue;
				}
			}
    		$("input[name='memberGender']").attr("value", genderStr);
            
            var dobStr = "";
            for (var i = 0; i < $("input[name='memberDOB']").val().split(",").length; i ++) {
				var dobValue = $("input[name='memberDOB']").val().split(",")[i];
				if (i == 0){
					dobValue = $("input[name='editPolicyHolderDOB']").val();
					dobStr = dobStr + dobValue;
				} else {
					dobStr = dobStr + "," + dobValue;
				}
			}
    		$("input[name='memberDOB']").attr("value", dobValue);
            
			$("input[name='policyHolderAddressLine1']").val($("input[name='editPolicyHolderAddress1']").val());
			$("input[name='policyHolderAddressLine2']").val($("input[name='editPolicyHolderAddress2']").val());
			$("input[name='addressPostcode']").val($("input[name='editPolicyHolderPostcode']").val());
			
			// Change editable form to preview form
			$(".policyHolderNameSection").find('input').remove();
			$(".policyHolderNameSection").append("<strong></strong>");
			$(".policyHolderNameSection").find('strong').html($("input[name='policyHolderName']").val());
			
			$(".policyHolderEmailSection").find('input').remove();
			$(".policyHolderEmailSection").append("<strong></strong>");
			$(".policyHolderEmailSection").find('strong').html($("input[name='policyHolderEmail']").val());
			
			$(".policyHolderMobileNoSection").find('input').remove();
			$(".policyHolderMobileNoSection").append("<strong></strong>");
			$(".policyHolderMobileNoSection").find('strong').html($("input[name='policyHolderMobileNo']").val());
			
			$(".policyHolderMaritalStatusSection").find('select').remove();
			$(".policyHolderMaritalStatusSection").append("<strong></strong>");
			if($("input[name='policyHolderMaritalStatus']").val() == "S") {
				$(".policyHolderMaritalStatusSection").find('strong').html("Single");
			} else if($("input[name='policyHolderMaritalStatus']").val() == "M"){
				$(".policyHolderMaritalStatusSection").find('strong').html("Married");
			}
			
			$(".policyHolderDrivingExperienceSection").find('select').remove();
			$(".policyHolderDrivingExperienceSection").append("<strong></strong>");
			$(".policyHolderDrivingExperienceSection").find("strong").html($("input[name='memberMotorDrivingExperience']").val().split(',')[0]);
			
			$(".policyHolderOccupationSection").find('input').remove();
			$(".policyHolderOccupationSection").append("<strong></strong>");
			$(".policyHolderOccupationSection").find('strong').html($("input[name='memberOccupation']").val().split(',')[0]);
            
            $(".policyHolderGenderSection").append("<strong></strong>");
    		$(".policyHolderGenderSection").find('strong').html($("select[name='editPolicyHolderGender'] option:selected").text());
			$(".policyHolderGenderSection").find('select').remove();
            
            $(".policyHolderDOBSection").find('input').remove();
        	$(".policyHolderDOBSection").append("<strong></strong>");
			$(".policyHolderDOBSection").find('strong').html($("input[name='policyHolderDateOfBirth']").val());
            
			$(".policyHolderAddressSection").find('input, br').remove();
			$(".policyHolderAddressSection").append("<strong></strong>");
            $(".policyHolderAddressSection").find('strong').html($("input[name='policyHolderAddressLine1']").val() + " " + $("input[name='policyHolderAddressLine2']").val() + " " + $("input[name='addressPostcode']").val());			
		}
	}
	
	<!-- Edit Car Details -->
	function editCarInfoSection(){
		// Show the save button and disable the edit button //
		$(".carInfoSaveBtn").show();
		$(".carInfoEditBtn").hide();
        $("#boxCheck").addClass("promptNoSave");
        
		// ByPass Enable Cc Drop Down //
		//$("input[name='enableCcDropDown']").attr("value", "true");
		
		// Edit Car Specification //
		jQuery.ajax({
            type: "POST",
            url: '/dotCMS/purchase/buynow',
            data: {"action": "findCarVariants",
                "motorMakeCode": $('input[name=motorMakeCode]').val(),
                "motorModelCode": $('input[name=motorModelCode]').val(),
                "motorYearOfMake": $('input[name=motorYearOfMake]').val(),
                "motorCc": $('input[name=motorCc]').val(),
                "coverageStartDate" : $('input[name=coverageStartDate]').val(),
            },
            dataType: "json",
            success: function (data) {
                if (data !== null && data.length > 0) {
					$(".carInfoSpecificationSection").find('strong').remove();
					$(".carInfoSpecificationSection").append("<select name='editCarInfoSpecification'></select>");
					for(var counter = 0; counter < data.length; counter++){
						var specification = data[counter].variant + " " + data[counter].style + " " + $("input[name='ISMEngineNo']").val() + " " + data[counter].seat + " seat " + data[counter].transmission;
						$("select[name='editCarInfoSpecification']").append("<option value='" + data[counter].nvic + "'>" + specification + "</option>");
						if ($("input[name='motorNvic']").val() == data[counter].nvic){
							$("select[name='editCarInfoSpecification']").val($("input[name='motorNvic']").val());
							$(".carInfoSpecificationSection").append("<input name='editCarInfoVariant' value='" + data[counter].variant + "' hidden/>");
							$(".carInfoSpecificationSection").append("<input name='editCarInfoStyle' value='" + data[counter].style + "' hidden/>");
							$(".carInfoSpecificationSection").append("<input name='editCarInfoSeat' value='" + data[counter].seat + "' hidden/>");
							$(".carInfoSpecificationSection").append("<input name='editCarInfoTransmission' value='" + data[counter].transmission + "' hidden/>");
						}
					}
					$("select[name='editCarInfoSpecification']").change(function(){
						jQuery.ajax({
							type: "POST",
							url: '/dotCMS/purchase/buynow',
							data: {"action": "findCarVariants",
							"motorMakeCode": $('input[name=motorMakeCode]').val(),
							"motorModelCode": $('input[name=motorModelCode]').val(),
							"motorYearOfMake": $('input[name=motorYearOfMake]').val(),
							"motorCc": $('select[name=editCarInfoCubicCapacity]').val(),
							"coverageStartDate" : $('input[name=coverageStartDate]').val(),
							},
							dataType: "json",
							success: function (data) {
								if (data !== null && data.length > 0) {
									for(var counter = 0; counter < data.length; counter++){
										if ($("select[name='editCarInfoSpecification']").val() == data[counter].nvic) {
											$("input[name='editCarInfoVariant']").attr("value", data[counter].variant);
											$("input[name='editCarInfoStyle']").attr("value", data[counter].style);
											$("input[name='editCarInfoSeat']").attr("value", data[counter].seat);
											$("input[name='editCarInfoTransmission']").attr("value", data[counter].transmission);
										}
									}
								}
							},
						});
					});
                }
            },
        });
		
		// Edit Car Cubic Capacity //
		if ($("input[name='enableCcDropDown']").val() == "true"){
			jQuery.ajax({
            type: "POST",
            url: '/dotCMS/purchase/buynow',
            data: {"action": "findCarCc",
                "motorMakeCode": $('input[name=motorMakeCode]').val(),
                "motorModelCode": $('input[name=motorModelCode]').val(),
                "motorYearOfMake": $('input[name=motorYearOfMake]').val(),
                "coverageStartDate" : $('input[name=coverageStartDate]').val()
            },
            dataType: "json",
            success: function (data) {
				if (data !== null && data.length > 0) {
					$(".carInfoCubicCapacitySection").find('strong').remove();
					$(".carInfoCubicCapacitySection").append("<select name='editCarInfoCubicCapacity'></select>");
					for(var counter = 0; counter < data.length; counter++){
						$("select[name='editCarInfoCubicCapacity']").append("<option value='" + data[counter] + "'>" + data[counter] + "</option>");
						if ($("input[name='motorCc']").val() == data[counter]){
							$("select[name='editCarInfoCubicCapacity']").val($("input[name='motorCc']").val());
						}
					}
					
					$("select[name='editCarInfoCubicCapacity']").change(function(){
						jQuery.ajax({
							type: "POST",
							url: '/dotCMS/purchase/buynow',
							data: {"action": "findCarVariants",
							"motorMakeCode": $('input[name=motorMakeCode]').val(),
							"motorModelCode": $('input[name=motorModelCode]').val(),
							"motorYearOfMake": $('input[name=motorYearOfMake]').val(),
							"motorCc": $(this).val(),
							"coverageStartDate" : $('input[name=coverageStartDate]').val(),
							},
							dataType: "json",
							success: function (data) {
								if (data !== null && data.length > 0) {
									$("select[name='editCarInfoSpecification']").find("option").remove();
									for(var counter = 0; counter < data.length; counter++){
										var specification = data[counter].variant + " " + data[counter].style + " " + $("input[name='ISMEngineNo']").val() + " " + data[counter].seat + " seat " + data[counter].transmission;
										$("select[name='editCarInfoSpecification']").append("<option value='" + data[counter].nvic + "'>" + specification + "</option>");
									}
									$("input[name='editCarInfoVariant']").attr("value", data[0].variant);
									$("input[name='editCarInfoStyle']").attr("value", data[0].style);
									$("input[name='editCarInfoSeat']").attr("value", data[0].seat);
									$("input[name='editCarInfoTransmission']").attr("value", data[0].transmission);
								}
							},
						});
					});
				}
            },
            });
		}
	
		// Edit Car Location //
		$(".carInfoLocationSection").find('strong').remove();
        $(".carInfoLocationSectionStateCode").find('strong').remove();
   		//$(".carInfoLocationSection").append("<select name='editCarInfoLocation'><option value='em'>East Malaysia</option><option value='wm'>West Malaysia</option></select>");
           
        $(".carInfoLocationSectionStateCode").append('<select name="editCarInfoLocationStateCode" id="editCarInfoLocationStateCode" class="required" data-name="Car Location State Code" required><option value="" disabled selected >Select</option>#foreach($con in $dotcontent.pull("+structureName:TieRefState +(conhost:ceaa0d75-448c-4885-a628-7f0c35d374bd conhost:SYSTEM_HOST) +live:true",0,"TieRefState.stateDescription"))<option value="$con.stateCode" #if($con.stateCode == $request.getParameter('motorVehicleLocationStateCode')) selected #end >$con.stateDescription</option>#end</select>');
        
        $(".carInfoLocationSection").append('<select name="editCarInfoLocation" id="editCarInfoLocation" class="required" data-name="Car Location"><option value="" disabled selected >Select</option>#foreach($con in $dotcontent.pull("+structureName:TieRefState +(conhost:ceaa0d75-448c-4885-a628-7f0c35d374bd conhost:SYSTEM_HOST) +live:true",0,"TieRefState.stateDescription"))<option value="$con.vpmsStateCode" #if(($con.vpmsStateCode == $request.getParameter('motorVehicleLocation')) && ($con.stateCode == $request.getParameter('motorVehicleLocationStateCode'))) selected #end >$con.stateDescription</option>#end</select>');
        
		// Edit Car Loan Provider //
		var financeName = "";
		var financeCode = $("input[name='motorLoanProvider']").val();
		$(".carInfoLoanProviderSection").find('strong').remove();
		$(".carInfoLoanProviderSection").append("<input name='editCarInfoLoanProvider' placeholder='Find Loan Provider' type='text' />");
		
		$("input[name=editCarInfoLoanProvider]").focus(function(){
			var url = "/js/jquery.autocomplete.min.js?v=$webapi.getAssetInode('/js/jquery.autocomplete.min.js')";
			$.getScript(url, function(){
			jQuery.ajax({
				type: "GET",
				url: '/api/content/render/false/type/json/limit/0/query/+structureName:TieRefBancaLoanProvider%20+(conhost:ceaa0d75-448c-4885-a628-7f0c35d374bd%20conhost:SYSTEM_HOST)%20+live:true/orderby/TieRefBancaLoanProvider.financeName',            
				dataType: "json",
				success: function (data) {
					var param = "[";
					if (data !== null && data.contentlets.length > 0) {
						for (var i = 0; i < data.contentlets.length; i++) {
						
							if (data.contentlets[i].financeName.includes('"')) {
								data.contentlets[i].financeName = data.contentlets[i].financeName.replace(/"/g, "'");	
							}
							param = param + '{"value": "' + data.contentlets[i].financeName + '", "data": "' + data.contentlets[i].financeCode + '"}, ';
						}

					}
					param = param.substring(0, param.length-2) + "]";
					console.log(param);

					$('input[name=editCarInfoLoanProvider]').autocomplete({
						lookup: JSON.parse(param),
						showNoSuggestionNotice:true,
						noSuggestionNotice:"No results found",
						triggerSelectOnValidInput:false,
						onSelect:function(suggestion){
							$('input[name=editCarInfoLoanProvider]').trigger('change',[suggestion.value]);	
						}
						
					});  
				},
			});
			}, true);
		})
		
		// Populate the hidden input value into edit field //
		$("select[name='editCarInfoLocation']").val($("input[name='motorVehicleLocation']").val());
        $("select[name='editCarInfoLocationStateCode']").val($("input[name='motorVehicleLocationStateCode']").val());
		$("input[name=editCarInfoLoanProvider]").val($("input[name='motorLoanProviderDescription']").val());
		
	}
	
	<!-- Save Car Details -->
	function saveCarInfoSection(){
		// Hide the save button and enable the edit button
		$(".carInfoEditBtn").show();
		$(".carInfoSaveBtn").hide();
        var saveBtn = document.querySelectorAll("[id='saveBtn']");        
        var allowProceed = true;
		for(var i = 0; i < saveBtn.length; i++) {
            var displaySave = saveBtn[i].style.display;
            console.log(displaySave);
            if(displaySave == 'inline-block'){
                allowProceed = false;
            }
        }
            
        if(allowProceed) {
            $("#boxCheck").removeClass("promptNoSave");
        }
        
		// Change the value of hidden input
		$("input[name='motorNvic']").val($("select[name='editCarInfoSpecification']").val());
		$("input[name='motorVariant']").val($("input[name='editCarInfoVariant']").val());
		$("input[name='motorStyle']").val($("input[name='editCarInfoStyle']").val());
		$("input[name='motorSeat']").val($("input[name='editCarInfoSeat']").val());
		$("input[name='motorTransmission']").val($("input[name='editCarInfoTransmission']").val());
		$("input[name='motorVehicleLocation']").val($("select[name='editCarInfoLocation']").val());
        $("input[name='motorVehicleLocationStateCode']").val($("select[name='editCarInfoLocationStateCode']").val());
        if ($("input[name='enableCcDropDown']").val() == "true"){
    	    $("input[name='motorCc']").val($("select[name='editCarInfoCubicCapacity']").val());
        }
		
		// Change editable form to preview form
        if ($("input[name='enableCcDropDown']").val() == "true"){
    		$(".carInfoCubicCapacitySection").append("<strong></strong>");
    		$(".carInfoCubicCapacitySection").find('strong').html($("select[name='editCarInfoCubicCapacity'] option:selected").text());
    		$(".carInfoCubicCapacitySection").find('select').remove();
        }
		
		$(".carInfoSpecificationSection").append("<strong></strong>");
		$(".carInfoSpecificationSection").find('strong').html($("select[name='editCarInfoSpecification'] option:selected").text());
		$(".carInfoSpecificationSection").find('select').remove();
		$(".carInfoSpecificationSection").find('input').remove();
		
        
    	$(".carInfoLocationSection").append("<strong></strong>");
        
        var optionValue = $("input[name='motorVehicleLocationStateCode']").val();
    	jQuery.ajax({
    		type: "GET",
			url: '/api/content/render/false/type/json/limit/0/query/+structureName:TieRefState%20+(conhost:ceaa0d75-448c-4885-a628-7f0c35d374bd%20conhost:SYSTEM_HOST)%20+TieRefState.stateCode:'+optionValue+'%20+languageId:1%20+live:true/orderby/TieRefState.stateCode',            
			dataType: "json",
			success: function (data) {
				if(data!=null && data.contentlets.length > 0){
					if(data.contentlets.length == 1) {
						$('input[name=motorVehicleLocation]').val(data.contentlets[0].vpmsStateCode).trigger("change");
					}
				}
				$('select[name=motorVehicleLocation]>option:eq(0)').html("Select");
			},
			error: function (jqXHR, textStatus, errorThrown){
				var errorList = [];
				errorList.push({'message': 'Opps. Something went wrong, please check back again later.'});
				showErrorMessages(errorList);
			}
		});
        
        $(".carInfoLocationSection").find('strong').html($("select[name='editCarInfoLocation'] option:selected").text());
        $(".carInfoLocationSection").find('select').remove();
        
        $(".carInfoLocationSectionStateCode").append("<strong></strong>");
        $(".carInfoLocationSectionStateCode").find('strong').html($("select[name='editCarInfoLocationStateCode'] option:selected").text());
    	$(".carInfoLocationSectionStateCode").find('select').remove();
		
		/// Save auto complete Loan Provider field Start
		var financeName = $("input[name='editCarInfoLoanProvider']").val();
		if (financeName != null){
            if (financeName.includes("'")){
			    financeName = financeName.replace(/'/g, '"');
		    }
        }
		var financeCode = "";
		jQuery.ajax({
			type: "GET",
			url: '/api/content/render/false/type/json/limit/0/query/+structureName:TieRefBancaLoanProvider%20+(conhost:ceaa0d75-448c-4885-a628-7f0c35d374bd%20conhost:SYSTEM_HOST)%20+live:true/orderby/TieRefBancaLoanProvider.financeName',            
			dataType: "json",
			success: function (data) {
				var param = "[";
				if (data !== null && data.contentlets.length > 0) {
					for (var i = 0; i < data.contentlets.length; i++) {
					
						if(data.contentlets[i].financeName == financeName){
    						financeCode = data.contentlets[i].financeCode;
    						financeName = data.contentlets[i].financeName;
							$("input[name='motorLoanProvider']").val(financeCode);
                            $("input[name='motorLoanProviderDescription']").val(financeName);
						}
					}

				}
			},
		});
		$(".carInfoLoanProviderSection").find('input').remove();
		$(".carInfoLoanProviderSection").append("<strong></strong>");
		$(".carInfoLoanProviderSection").find('strong').html(financeName);
		/// Save auto complete Loan Provider field End
		
		calculateMotorPlusPlanPremium();
	}
	
	<!-- Edit Additional Driver Details -->
    var tempPosition = "";
    function editAdditionalDriverSection(driverNumber) {
		// Show the save button and disable the edit button
		$(".driverSaveBtn" + driverNumber).show();
		$(".driverEditBtn" + driverNumber).hide();
		$("#boxCheck").addClass("promptNoSave");
        
        var position = getPosition($("input[name='memberName']").val().split(","), $(".driverNameSection" + driverNumber + " strong").text());
    	tempPosition = position;
		// Change preview form to editable form
		if ($("input[name='driverNationality" + driverNumber + "']:checked").val() == "Y") {
			$(".driverNRICSection" + driverNumber).append("<input name='editDriverNRIC" + driverNumber + "' type='text' />");
			$("input[name='editDriverNRIC" + driverNumber + "']").mask("000000-00-0000", {placeholder: "E.g.: 900808-10-8888"});
		} else {
			$(".driverPassportSection" + driverNumber).append("<input name='editDriverPassport" + driverNumber + "' type='text' />");
			$(".driverDOBSection" + driverNumber).append("<input name='editDriverDOB" + driverNumber + "' type='text' />");
    		$("input[name='editDriverDOB" + driverNumber + "']").mask("00/00/0000", {placeholder: "DD/MM/YYYY"});
    		$("input[name='editDriverPassport" + driverNumber + "']").mask("000000-00-0000", {placeholder: "E.g.: 900808-10-8888"});
		}
		$(".driverNameSection" + driverNumber).find('strong').remove();
		
		if ($("input[name='driverNationality" + driverNumber + "']:checked").val() == "Y") {
			$(".driverNRICSection" + driverNumber).find('strong').remove();
		} else {
			$(".driverPassportSection" + driverNumber).find('strong').remove();
			$(".driverDOBSection" + driverNumber).find('strong').remove();
		}
		$(".driverGenderSection" + driverNumber).find('strong').remove();
		$(".driverRelationshipSection" + driverNumber).find('strong').remove();
		$(".driverExperienceSection" + driverNumber).find('strong').remove();
		$(".driverOccupationSection" + driverNumber).find('strong').remove();
		$(".driverNationalitySection" + driverNumber).show();
		
		$(".driverNameSection" + driverNumber).append("<input name='editDriverName" + driverNumber + "' placeholder='E.g.: Lee Siew Suan' type='text' />");
		$(".driverGenderSection" + driverNumber).append("<select name='editDriverGender" + driverNumber + "'><option value='0' hidden>Select Option</option><option value='M'>Male</option><option value='F'>Female</option></select>");
		$(".driverRelationshipSection" + driverNumber).append("<select name='editDriverRelationship" + driverNumber + "'><option value='0' hidden>Select Option</option><option value='01'>Parent / Parent-in-law</option><option value='02'>Spouse</option><option value='03'>Child</option><option value='04'>Sibling/Sibling-in-law/Cousin/Relative</option><option value='05'>Friend / Co-worker</option></select>");
		$(".driverExperienceSection" + driverNumber).append("<select name='editDriverExperience" + driverNumber + "'></select>");
		for(var i = 0; i < 53; i++) {
			$("select[name='editDriverExperience" + driverNumber + "']").append("<option value='" + i + "'>" + i + "</option>");
		}
		$(".driverOccupationSection" + driverNumber).append("<input name='editDriverOccupation" + driverNumber + "' placeholder='E.g.: Architect' type='text' />");
		
		$("input[name='driverNationality" + driverNumber + "']").unbind();
		
		$("input[name='driverNationality" + driverNumber + "']").change(function() {
			if ($(this).val() == "Y") {
				$("input#typeNonMalaysian" + driverNumber).removeAttr("checked");
                $("label[for=typeNonMalaysian" + driverNumber + "]").removeAttr("style");
                $("input#typeMalaysian" + driverNumber).attr("checked", "checked");
                $("label[for=typeMalaysian" + driverNumber + "]").css("font-weight", "bold");
                
                $(".driverNationalitySection" + driverNumber + " span").removeAttr("class");
                $(".driverNationalitySection" + driverNumber + " span[name=radioBtnMalaysian" + driverNumber + "]").attr("class", "dotSelect");
                $(".driverNationalitySection" + driverNumber + " span[name=radioBtnNonMalaysian" + driverNumber + "]").attr("class", "dotNonSelect");
				
                // Amendment Additional Driver Layout
				$(".driverNRICSection" + driverNumber).removeAttr("style");
				$(".driverNRICSection" + driverNumber).attr("name", "displayField-right");
				$(".driverPassportSection" + driverNumber).hide();
				$(".driverPassportSection" + driverNumber).removeAttr("name");
				$(".driverNRICSection" + driverNumber).find('strong').remove();
				$(".driverPassportSection" + driverNumber).find("br, span, input").remove();
				$(".driverNRICSection" + driverNumber).append("<input name='editDriverNRIC" + driverNumber + "' type='text' />");
				$("input[name='editDriverNRIC" + driverNumber + "']").mask("000000-00-0000", {placeholder: "E.g.: 900808-10-8888"});
				
				//Second Row
                $("div[name=driver" + driverNumber + "] li#secondRow").find("div").remove();
				$("div[name=driver" + driverNumber + "] li#secondRow").append("<div class='driverGenderSection" + driverNumber + "' name='displayField-left'><h4>Gender:</h4></div>");
				$("div[name=driver" + driverNumber + "] li#secondRow").append("<div class='driverRelationshipSection" + driverNumber + "' name='displayField-right'><h4>Family Relationship:</h4></div>");
				$(".driverGenderSection" + driverNumber).append("<select name='editDriverGender" + driverNumber + "'><option value='0' hidden>Select Option</option><option value='M'>Male</option><option value='F'>Female</option></select>");
				$(".driverRelationshipSection" + driverNumber).append("<select name='editDriverRelationship" + driverNumber + "'><option value='0' hidden>Select Option</option><option value='00'>PolicyHolder</option><option value='01'>Parent / Parent-in-law</option><option value='02'>Spouse</option><option value='03'>Child</option><option value='04'>Sibling/Sibling-in-law/Cousin/Relative</option><option value='05'>Friend / Co-worker</option></select>");
				
				//Third Row
				$("div[name=driver" + driverNumber + "] li#thirdRow").find("div").remove();
				$("div[name=driver" + driverNumber + "] li#thirdRow").append("<div class='driverExperienceSection" + driverNumber + "' name='displayField-left'><h4>Years of Driving Experience:</h4></div>");
				$("div[name=driver" + driverNumber + "] li#thirdRow").append("<div class='driverOccupationSection" + driverNumber + "' name='displayField-right'><h4>Occupation:</h4></div>");
				$(".driverExperienceSection" + driverNumber).append("<select name='editDriverExperience" + driverNumber + "'></select>");
				for(var i = 0; i < 53; i++) {
					$("select[name='editDriverExperience" + driverNumber + "']").append("<option value='" + i + "'>" + i + "</option>");
				}
				$(".driverOccupationSection" + driverNumber).append("<input name='editDriverOccupation" + driverNumber + "' placeholder='E.g.:: Architect' type='text' />");
				
				//Fourth Row
				$("div[name=driver" + driverNumber + "] li#fourthRow").remove();
				
				if ($("input[name='memberDOB']").val().split(',')[position] == "") {
					$("input[name='editDriverNRIC" + driverNumber + "']").val($("input[name='memberIdNo']").val().split(',')[position]);
				}
				
				// Populate value into input field
				$("select[name='editDriverGender" + driverNumber + "']").val($("input[name='memberGender']").val().split(',')[position]);
				$("select[name='editDriverRelationship" + driverNumber + "']").val($("input[name='driverRelationship']").val().split(',')[position]);
				$("select[name='editDriverExperience" + driverNumber + "']").val($("input[name='memberMotorDrivingExperience']").val().split(',')[position]);
				$("input[name='editDriverOccupation" + driverNumber + "']").val($("input[name='memberOccupation']").val().split(',')[position]);
				
				// Amendment Additional Driver Layout End
				
			} else if ($(this).val() == "N") {
				$("input#typeMalaysian" + driverNumber).removeAttr("checked");
                $("label[for=typeMalaysian" + driverNumber + "]").removeAttr("style");
                $("input#typeNonMalaysian" + driverNumber).attr("checked", "checked");
                $("label[for=typeNonMalaysian" + driverNumber + "]").css("font-weight", "bold");
                
                $(".driverNationalitySection" + driverNumber + " span").removeAttr("class");
                $(".driverNationalitySection" + driverNumber + " span[name=radioBtnMalaysian" + driverNumber + "]").attr("class", "dotNonSelect");
                $(".driverNationalitySection" + driverNumber + " span[name=radioBtnNonMalaysian" + driverNumber + "]").attr("class", "dotSelect");
				
				// Amendment Additional Driver Layout
				$(".driverPassportSection" + driverNumber).removeAttr("style");
				$(".driverPassportSection" + driverNumber).attr("name", "displayField-right");
				$(".driverNRICSection" + driverNumber).hide();
				$(".driverNRICSection" + driverNumber).removeAttr("name");
				$(".driverPassportSection" + driverNumber).find('strong').remove();
				$(".driverNRICSection" + driverNumber).find("br, span, input").remove();
				$(".driverPassportSection" + driverNumber).append("<input name='editDriverPassport" + driverNumber + "' type='text' />");
				
				// Second Row
				$("div[name=driver" + driverNumber + "] li#secondRow").find("div").remove();
				$("div[name=driver" + driverNumber + "] li#secondRow").append("<div class='driverDOBSection" + driverNumber + "' name='displayField-left'><h4>D.O.B:</h4></div>");
				$("div[name=driver" + driverNumber + "] li#secondRow").append("<div class='driverGenderSection" + driverNumber + "' name='displayField-right'><h4>Gender:</h4></div>");
				$(".driverDOBSection" + driverNumber).append("<input name='editDriverDOB" + driverNumber + "' type='text' />");
				$("input[name='editDriverDOB" + driverNumber + "']").mask("00/00/0000", {placeholder: "DD/MM/YYYY"});
				$(".driverGenderSection" + driverNumber).append("<select name='editDriverGender" + driverNumber + "'><option value='0' hidden>Select Option</option><option value='M'>Male</option><option value='F'>Female</option></select>");
				
				// Third Row
				$("div[name=driver" + driverNumber + "] li#thirdRow").find("div").remove();
				$("div[name=driver" + driverNumber + "] li#thirdRow").append("<div class='driverRelationshipSection" + driverNumber + "' name='displayField-left'><h4>Family Relationship:</h4></div>");
				$("div[name=driver" + driverNumber + "] li#thirdRow").append("<div class='driverExperienceSection" + driverNumber + "' name='displayField-right'><h4>Years of Driving Experience:</h4></div>");
				$(".driverRelationshipSection" + driverNumber).append("<select name='editDriverRelationship" + driverNumber + "'><option value='0' hidden>Select Option</option><option value='00'>PolicyHolder</option><option value='01'>Parent / Parent-in-law</option><option value='02'>Spouse</option><option value='03'>Child</option><option value='04'>Sibling/Sibling-in-law/Cousin/Relative</option><option value='05'>Friend / Co-worker</option></select>");
				$(".driverExperienceSection" + driverNumber).append("<select name='editDriverExperience" + driverNumber + "'></select>");
				for(var i = 0; i < 53; i++) {
					$("select[name='editDriverExperience" + driverNumber + "']").append("<option value='" + i + "'>" + i + "</option>");
				}
				
				// Fourth Row
				$("<li id='fourthRow'><li>").insertBefore("div[name=driver" + driverNumber + "] li#buttonRow");
				$("div[name=driver" + driverNumber + "] li#fourthRow").append("<div class='driverOccupationSection" + driverNumber + "' name='displayField-left'><h4>Occupation:</h4></div>");
				$(".driverOccupationSection" + driverNumber).append("<input name='editDriverOccupation" + driverNumber + "' type='text' />");
				
				if ($("input[name='memberDOB']").val().split(',')[position] != "") {
					$("input[name='editDriverPassport" + driverNumber + "']").val($("input[name='memberIdNo']").val().split(',')[position]);
					$("input[name='editDriverDOB" + driverNumber + "']").val($("input[name='memberDOB']").val().split(',')[position]);
				}
				
				// Populate value into edit field.
				$("input[name='editDriverDOB" + driverNumber + "']").val($("input[name='memberDOB']").val().split(',')[position]);
				$("select[name='editDriverGender" + driverNumber + "']").val($("input[name='memberGender']").val().split(',')[position]);
				$("select[name='editDriverRelationship" + driverNumber + "']").val($("input[name='driverRelationship']").val().split(',')[position]);
				$("select[name='editDriverExperience" + driverNumber + "']").val($("input[name='memberMotorDrivingExperience']").val().split(',')[position]);
				$("input[name='editDriverOccupation" + driverNumber + "']").val($("input[name='memberOccupation']").val().split(',')[position]);
				
				// Amendment Additional Driver Layout End
			}
		});
		
		// Populate the value into edit field
		$("input[name='editDriverName" + driverNumber + "']").val($("input[name='memberName']").val().split(',')[position]);
		$("input[name='editDriverNRIC" + driverNumber + "']").val($("input[name='memberIdNo']").val().split(',')[position]);
		$("input[name='editDriverPassport" + driverNumber + "']").val($("input[name='memberIdNo']").val().split(',')[position]);
		$("input[name='editDriverDOB" + driverNumber + "']").val($("input[name='memberDOB']").val().split(',')[position]);
		$("select[name='editDriverGender" + driverNumber + "']").val($("input[name='memberGender']").val().split(',')[position]);
		$("select[name='editDriverRelationship" + driverNumber + "']").val($("input[name='driverRelationship']").val().split(',')[position]);
		$("select[name='editDriverExperience" + driverNumber + "']").val($("input[name='memberMotorDrivingExperience']").val().split(',')[position]);
		$("input[name='editDriverOccupation" + driverNumber + "']").val($("input[name='memberOccupation']").val().split(',')[position]);
		
	}
	
	<!-- Save Additional Driver Details -->
	function saveAdditionalDriverSection(driverNumber) {
	
		// Validation Start
		var proceed = true;
		if($("input[name='editDriverName" + driverNumber + "']").val() == "") {
			proceed = false;
			$(".driverNameSection" + driverNumber).find("br, span").remove();
			$(".driverNameSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverName">Complete the Name field.</span>');
		} else if(!validateName($("input[name='editDriverName" + driverNumber + "']").val())){
			proceed = false;
			$(".driverNameSection" + driverNumber).find("br, span").remove();
			$(".driverNameSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverName">Please enter only alphabet,"-","@", "/" and " \' " for Name.</span>');
		} else {
			$(".driverNameSection" + driverNumber).find("br, span").remove();
		}
		
		if ($("input[name='driverNationality" + driverNumber + "']:checked").val() == "Y") {
			// NRIC
			if($("input[name='editDriverNRIC" + driverNumber + "']").val() == "") {
				proceed = false;
				$(".driverNRICSection" + driverNumber).find("br, span").remove();
				$(".driverNRICSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverNRIC">Complete the NRIC field.</span>');
			} else if(!validateNRIC($("input[name='editDriverNRIC" + driverNumber + "']").val(), driverNumber)){
				proceed = false;
				$(".driverNRICSection" + driverNumber).find("br, span").remove();
			$(".driverNRICSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverNRIC">Check the NRIC number.</span>');
			} else if(!validateNRICsecondary($("input[name='editDriverNRIC" + driverNumber + "']").val(), driverNumber)){
				proceed = false;
				$(".driverNRICSection" + driverNumber).find("br, span").remove();
				$(".driverNRICSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverNRIC">Please enter valid NRIC number.</span>');
			} else if(!validateAgeLimit($("input[name='editDriverNRIC" + driverNumber + "']").val(), $("input[name='editDriverDOB" + driverNumber + "']").val(), driverNumber, tempPosition)){
				proceed = false;
			} else {
				$(".driverNRICSection" + driverNumber).find("br, span").remove();
			}
		} else {
		
			// Passport
			if($("input[name='editDriverPassport" + driverNumber + "']").val() == "") {
				proceed = false;
				$(".driverPassportSection" + driverNumber).find("br, span").remove();
				$(".driverPassportSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverPassport">Complete the Passport No field.</span>');
			} else if(!validatePassport($("input[name='editDriverPassport" + driverNumber + "']").val(), driverNumber)){
				proceed = false;
				$(".driverPassportSection" + driverNumber).find("br, span").remove();
			$(".driverPassportSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverPassport">Please enter only digit, alphabet,"-" and "/" for Passport Number.</span>');
			} else {
				$(".driverPassportSection" + driverNumber).find("br, span").remove();
			}
			
			// D.O.B
			if($("input[name='editDriverDOB" + driverNumber + "']").val() == "") {
				proceed = false;
				$(".driverDOBSection" + driverNumber).find("br, span").remove();
				$(".driverDOBSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverNRIC">Complete the D.O.B field.</span>');
			} else if(!validateDOB($("input[name='editDriverDOB" + driverNumber + "']").val(), driverNumber)){
				proceed = false;
				$(".driverDOBSection" + driverNumber).find("br, span").remove();
				$(".driverDOBSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverNRIC">Please enter valid DOB.</span>');
			} else if(!validateAgeLimit($("input[name='editDriverNRIC" + driverNumber + "']").val(), $("input[name='editDriverDOB" + driverNumber + "']").val(), driverNumber, tempPosition)){
				proceed = false;
			} else {
				$(".driverDOBSection" + driverNumber).find("br, span").remove();
			}
			
		}
		
		// Gender
		if($("select[name='editDriverGender" + driverNumber + "'] option:selected").val() == "0") {
			proceed = false;
			$(".driverGenderSection" + driverNumber).find("br, span").remove();
			$(".driverGenderSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverGender">Complete the Gender field.</span>');
		} else {
			$(".driverGenderSection" + driverNumber).find("br, span").remove();
		}
		
		if($("select[name='editDriverRelationship" + driverNumber + "'] option:selected").val() == "0") {
			proceed = false;
			$(".driverRelationshipSection" + driverNumber).find("br, span").remove();
			$(".driverRelationshipSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverRelationship">Complete the Family Relationship field.</span>');
		} else {
			$(".driverRelationshipSection" + driverNumber).find("br, span").remove();
		}
		
		if($("input[name='editDriverOccupation" + driverNumber + "']").val() == "") {
			proceed = false;
			$(".driverOccupationSection" + driverNumber).find("br, span").remove();
			$(".driverOccupationSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverRelationship">Complete the Occupation field.</span>');
		} else {
			$(".driverOccupationSection" + driverNumber).find("br, span").remove();
		}
		
		// Validation End
		
		if (proceed) {
			// Hide the save button and enable the edit button
			$(".driverEditBtn" + driverNumber).show();
			$(".driverSaveBtn" + driverNumber).hide();
			$(".driverNationalitySection" + driverNumber).hide();
            var saveBtn = document.querySelectorAll("[id='saveBtn']");            
            var allowProceed = true;
    		for(var i = 0; i < saveBtn.length; i++) {
                 var displaySave = saveBtn[i].style.display;
                 console.log(displaySave);
                 if(displaySave == 'inline-block'){
                    allowProceed = false;
                 }
            }
            
            if(allowProceed) {
        		$("#boxCheck").removeClass("promptNoSave");
            }
			
			// Change the value of hidden input
			var driverNameStr = "";
			var driverNRICStr = "";
			var driverGenderStr = "";
			var driverRelationshipStr = "";
			var driverExperienceStr = "";
			var driverOccupationStr = "";
			var driverDOBStr = "";
			var driverNationalityStr = "";
			
			// Additional Driver Name
			for (var i = 0; i < $("input[name='memberName']").val().split(",").length; i++) {
				var driverNameValue = $("input[name='memberName']").val().split(",")[i];
				if (i == 0){
					driverNameStr = driverNameStr + driverNameValue;
				} else if (i == tempPosition){
					driverNameValue = $("input[name='editDriverName" + driverNumber + "']").val();
					driverNameStr = driverNameStr + "," + driverNameValue;
				} else {
					driverNameStr = driverNameStr + "," + driverNameValue;
				}
			}
			$("input[name='memberName']").attr("value", driverNameStr);
			
			// Additional Driver NRIC
			for (var i = 0; i < $("input[name='memberIdNo']").val().split(",").length; i++) {
				var driverNRICValue = $("input[name='memberIdNo']").val().split(",")[i];
				if (i == 0){
					driverNRICStr = driverNRICStr + driverNRICValue;
				} else if (i == tempPosition){
					if ($("input[name='driverNationality" + driverNumber + "']:checked").val() == "Y") {
						driverNRICValue = $("input[name='editDriverNRIC" + driverNumber + "']").val();
					} else {
						driverNRICValue = $("input[name='editDriverPassport" + driverNumber + "']").val();
					}
					driverNRICStr = driverNRICStr + "," + driverNRICValue;
				} else {
					driverNRICStr = driverNRICStr + "," + driverNRICValue;
				}
			}
			$("input[name='memberIdNo']").attr("value", driverNRICStr);
			
			
			// Additional Driver Gender
			for (var i = 0; i < $("input[name='memberGender']").val().split(",").length; i++) {
				var driverGenderValue = $("input[name='memberGender']").val().split(",")[i];
				if (i == 0){
					driverGenderStr = driverGenderStr + driverGenderValue;
				} else if (i == tempPosition){
					driverGenderValue = $("select[name='editDriverGender" + driverNumber + "']").val();
					driverGenderStr = driverGenderStr + "," + driverGenderValue;
				} else {
					driverGenderStr = driverGenderStr + "," + driverGenderValue;
				}
			}
			$("input[name='memberGender']").attr("value", driverGenderStr);
			
			// Additional Driver Relationship
			for (var i = 0; i < $("input[name='driverRelationship']").val().split(",").length; i++) {
				var driverRelationshipValue = $("input[name='driverRelationship']").val().split(",")[i];
				if (i == 0){
					driverRelationshipStr = driverRelationshipStr + driverRelationshipValue;
				} else if (i == tempPosition){
					driverRelationshipValue = $("select[name='editDriverRelationship" + driverNumber + "']").val();
					driverRelationshipStr = driverRelationshipStr + "," + driverRelationshipValue;
				} else {
					driverRelationshipStr = driverRelationshipStr + "," + driverRelationshipValue;
				}
			}
			$("input[name='driverRelationship']").attr("value", driverRelationshipStr);
			
			// Additional Driver Driving Experience
			for (var i = 0; i < $("input[name='memberMotorDrivingExperience']").val().split(",").length; i++) {
				var driverExperienceValue = $("input[name='memberMotorDrivingExperience']").val().split(",")[i];
				if (i == 0){
					driverExperienceStr = driverExperienceStr + driverExperienceValue;
				} else if (i == tempPosition){
					driverExperienceValue = $("select[name='editDriverExperience" + driverNumber + "']").val();
					driverExperienceStr = driverExperienceStr + "," + driverExperienceValue;
				} else {
					driverExperienceStr = driverExperienceStr + "," + driverExperienceValue;
				}
			}
			$("input[name='memberMotorDrivingExperience']").attr("value", driverExperienceStr);
			
			// Additional Driver Occupation
			for (var i = 0; i < $("input[name='memberOccupation']").val().split(",").length; i++) {
				var driverOccupationValue = $("input[name='memberOccupation']").val().split(",")[i];
				if (i == 0){
					driverOccupationStr = driverOccupationStr + driverOccupationValue;
				} else if (i == tempPosition){
					driverOccupationValue = $("input[name='editDriverOccupation" + driverNumber + "']").val();
					driverOccupationStr = driverOccupationStr + "," + driverOccupationValue;
				} else {
					driverOccupationStr = driverOccupationStr + "," + driverOccupationValue;
				}
			}
			$("input[name='memberOccupation']").attr("value", driverOccupationStr);
			
			// Additional Driver Nationality
			for (var i = 0; i < $("input[name='memberIsMalaysian']").val().split(",").length; i++) {
				var driverNationalityValue = $("input[name='memberIsMalaysian']").val().split(",")[i];
				if (i == 0) {
					driverNationalityStr = driverNationalityStr + driverNationalityValue;
				} else if (i == tempPosition) {
					driverNationalityValue = $("input[name='driverNationality" + driverNumber + "']:checked").val();
					driverNationalityStr = driverNationalityStr + "," + driverNationalityValue;
				} else {
					driverNationalityStr = driverNationalityStr + "," + driverNationalityValue;
				}
			}
			$("input[name='memberIsMalaysian']").attr("value", driverNationalityStr);
			
			// Additional Driver Date Of Birth
			for (var i = 0; i < $("input[name='memberDOB']").val().split(",").length; i++) {
				var driverDOBValue = $("input[name='memberDOB']").val().split(",")[i];
				if (i == 0) {
					driverDOBStr = driverDOBStr + driverDOBValue;
				} else if (i == tempPosition) {
					if ($("input[name='driverNationality" + driverNumber + "']:checked").val() == "Y") {
						driverDOBValue = "";
					} else {
						driverDOBValue = $("input[name='editDriverDOB" + driverNumber + "']").val();
					}
					driverDOBStr = driverDOBStr + "," + driverDOBValue;
				} else {
					driverDOBStr = driverDOBStr + "," + driverDOBValue;
				}
			}
			$("input[name='memberDOB']").attr("value", driverDOBStr);
			
			// Change editable form to preview form
			$(".driverNameSection" + driverNumber).find('input').remove();
			$(".driverNameSection" + driverNumber).append("<strong></strong>");
			$(".driverNameSection"+ driverNumber).find('strong').html($("input[name='memberName']").val().split(',')[tempPosition]);
			
			if ($("input[name='driverNationality" + driverNumber + "']:checked").val() == "Y") {
				$(".driverNRICSection" + driverNumber).find('input').remove();
				$(".driverNRICSection" + driverNumber).append("<strong></strong>");
				$(".driverNRICSection"+ driverNumber).find('strong').html($("input[name='memberIdNo']").val().split(',')[tempPosition]);
			} else {
				$(".driverPassportSection" + driverNumber).find('input').remove();
				$(".driverPassportSection" + driverNumber).append("<strong></strong>");
				$(".driverPassportSection"+ driverNumber).find('strong').html($("input[name='memberIdNo']").val().split(',')[tempPosition]);
				
				$(".driverDOBSection" + driverNumber).find('input').remove();
				$(".driverDOBSection" + driverNumber).append("<strong></strong>");
				$(".driverDOBSection"+ driverNumber).find('strong').html($("input[name='memberDOB']").val().split(',')[tempPosition]);
			}
			
			$(".driverGenderSection" + driverNumber).append("<strong></strong>");
			$(".driverGenderSection"+ driverNumber).find('strong').html($("select[name='editDriverGender" + driverNumber + "'] option:selected").text());
			$(".driverGenderSection" + driverNumber).find('select').remove();
			
			$(".driverRelationshipSection" + driverNumber).append("<strong></strong>");
			$(".driverRelationshipSection"+ driverNumber).find('strong').html($("select[name='editDriverRelationship" + driverNumber + "'] option:selected").text());
			$(".driverRelationshipSection" + driverNumber).find('select').remove();
			
			$(".driverExperienceSection" + driverNumber).append("<strong></strong>");
			$(".driverExperienceSection"+ driverNumber).find('strong').html($("select[name='editDriverExperience" + driverNumber + "'] option:selected").text());
			$(".driverExperienceSection" + driverNumber).find('select').remove();
			
			$(".driverOccupationSection" + driverNumber).find('input').remove();
			$(".driverOccupationSection" + driverNumber).append("<strong></strong>");
			$(".driverOccupationSection"+ driverNumber).find('strong').html($("input[name='memberOccupation']").val().split(',')[tempPosition]);
		}
	}
    
    function getPosition(arrayName,arrayItem) {
    	for(var i=0;i<arrayName.length;i++){ 
			if(arrayName[i]==arrayItem)
			return i;
		}
	}
	
	function removeAdditionalDriverSection(driverNumber){
		console.log("Remove Driver");
		
		// Change the value of hidden input
		var driverNameStr = "";
		var driverNRICStr = "";
		var driverGenderStr = "";
		
		var memberRelationshipStr = "";
		var driverRelationshipStr = "";
		
		var driverExperienceStr = "";
		var driverOccupationStr = "";
		var driverDOBStr = "";
		var driverNationalityStr = "";
        if($(".driverEditBtn" + driverNumber).css('display') == 'none'){
            var position = getPosition($("input[name='memberName']").val().split(","), $(".driverNameSection" + driverNumber + " input").val());
        } else {
            var position = getPosition($("input[name='memberName']").val().split(","), $(".driverNameSection" + driverNumber + " strong").text());
        }
		
		// Remove Name
		for (var i = 0; i < $("input[name='memberName']").val().split(",").length; i++) {
			var driverNameValue = $("input[name='memberName']").val().split(",")[i];
			if (i == 0){
				driverNameStr = driverNameStr + driverNameValue;
			} else if (i == position){
				driverNameStr = driverNameStr;
			} else {
				driverNameStr = driverNameStr + "," + driverNameValue;
			}
		}
		$("input[name='memberName']").attr("value", driverNameStr);
			
		// Remove NRIC
		for (var i = 0; i < $("input[name='memberIdNo']").val().split(",").length; i++) {
			var driverNRICValue = $("input[name='memberIdNo']").val().split(",")[i];
			if (i == 0){
				driverNRICStr = driverNRICStr + driverNRICValue;
			} else if (i == position){
				driverNRICStr = driverNRICStr;
			} else {
				driverNRICStr = driverNRICStr + "," + driverNRICValue;
			}
		}
		$("input[name='memberIdNo']").attr("value", driverNRICStr);
			
			
		// Remove Gender
		for (var i = 0; i < $("input[name='memberGender']").val().split(",").length; i++) {
			var driverGenderValue = $("input[name='memberGender']").val().split(",")[i];
			if (i == 0){
				driverGenderStr = driverGenderStr + driverGenderValue;
			} else if (i == position){
				driverGenderStr = driverGenderStr;
			} else {
				driverGenderStr = driverGenderStr + "," + driverGenderValue;
			}
		}
		$("input[name='memberGender']").attr("value", driverGenderStr);
		
		// Remove Member Relationship
		for (var i = 0; i < $("input[name='memberRelationship']").val().split(",").length; i++) {
			var memberRelationshipValue = $("input[name='memberRelationship']").val().split(",")[i];
			if (i == 0){
				memberRelationshipStr = memberRelationshipStr + memberRelationshipValue;
			} else if (i == position){
				memberRelationshipStr = memberRelationshipStr;
			} else {
				memberRelationshipStr = memberRelationshipStr + "," + memberRelationshipValue;
			}
		}
		$("input[name='memberRelationship']").attr("value", memberRelationshipStr);
			
		// Remove Driver Relationship
		for (var i = 0; i < $("input[name='driverRelationship']").val().split(",").length; i++) {
			var driverRelationshipValue = $("input[name='driverRelationship']").val().split(",")[i];
			if (i == 0){
				driverRelationshipStr = driverRelationshipStr + driverRelationshipValue;
			} else if (i == position){
				driverRelationshipStr = driverRelationshipStr;
			} else {
				driverRelationshipStr = driverRelationshipStr + "," + driverRelationshipValue;
			}
		}
		$("input[name='driverRelationship']").attr("value", driverRelationshipStr);
			
		// Remove Driving Experience
		for (var i = 0; i < $("input[name='memberMotorDrivingExperience']").val().split(",").length; i++) {
			var driverExperienceValue = $("input[name='memberMotorDrivingExperience']").val().split(",")[i];
			if (i == 0){
				driverExperienceStr = driverExperienceStr + driverExperienceValue;
			} else if (i == position){
				driverExperienceStr = driverExperienceStr;
			} else {
				driverExperienceStr = driverExperienceStr + "," + driverExperienceValue;
			}
		}
		$("input[name='memberMotorDrivingExperience']").attr("value", driverExperienceStr);
		
		// Remove Occupation
		for (var i = 0; i < $("input[name='memberOccupation']").val().split(",").length; i++) {
			var driverOccupationValue = $("input[name='memberOccupation']").val().split(",")[i];
			if (i == 0){
				driverOccupationStr = driverOccupationStr + driverOccupationValue;
			} else if (i == position){
				driverOccupationStr = driverOccupationStr;
			} else {
				driverOccupationStr = driverOccupationStr + "," + driverOccupationValue;
			}
		}
		$("input[name='memberOccupation']").attr("value", driverOccupationStr);
		
		// Remove Nationality
		for (var i = 0; i < $("input[name='memberIsMalaysian']").val().split(",").length; i++) {
			var driverNationalityValue = $("input[name='memberIsMalaysian']").val().split(",")[i];
			if (i == 0) {
				driverNationalityStr = driverNationalityStr + driverNationalityValue;
			} else if (i == position) {
				driverNationalityStr = driverNationalityStr;
			} else {
				driverNationalityStr = driverNationalityStr + "," + driverNationalityValue;
			}
		}
		$("input[name='memberIsMalaysian']").attr("value", driverNationalityStr);
		
		// Remove Date Of Birth
		for (var i = 0; i < $("input[name='memberDOB']").val().split(",").length; i++) {
			var driverDOBValue = $("input[name='memberDOB']").val().split(",")[i];
			if (i == 0) {
				driverDOBStr = driverDOBStr + driverDOBValue;
			} else if (i == position) {
				driverDOBStr = driverDOBStr;
			} else {
				driverDOBStr = driverDOBStr + "," + driverDOBValue;
			}
		}
		$("input[name='memberDOB']").attr("value", driverDOBStr);
		
        $("#boxCheck").removeClass("promptNoSave");
        
		$("div[name=driver" + driverNumber + "]").remove();
        calculateMotorPlusPlanPremium();
	}
	
	// Input Field Pattern Validation
	function validateName(value){
		var oRegEx = new RegExp("^[a-zA-Z][a-zA-Z-/@' ]*$");
		return oRegEx.test(value);
	}
	
	function validatePassport(value, driverNumber){
		var oRegEx = new RegExp("^[a-zA-Z0-9-/]*$");
		return oRegEx.test(value);
	}
	
	function validateContactNo(value) {
		var oRegEx = new RegExp("^(010|011|012|013|014|016|017|018|019)[-]{0,1}[0-9]{3}\\s[0-9]{4,7}$");
		return oRegEx.test(value);
	}
	
	function validateDOB(value, driverNumber) {
		var oRegEx = new RegExp("(((0[1-9]|[12][0-9]|3[01])([/])(0[13578]|10|12)([/])([1-2][0,9][0-9][0-9]))|(([0][1-9]|[12][0-9]|30)([/])(0[469]|11)([/])([1-2][0,9][0-9][0-9]))|((0[1-9]|1[0-9]|2[0-8])([/])(02)([/])([1-2][0,9][0-9][0-9]))|((29)(\.|-|\/)(02)([/])([02468][048]00))|((29)([/])(02)([/])([13579][26]00))|((29)([/])(02)([/])([0-9][0-9][0][48]))|((29)([/])(02)([/])([0-9][0-9][2468][048]))|((29)([/])(02)([/])([0-9][0-9][13579][26])))");
		return oRegEx.test(value);
	}
	
	function validateNRIC(value, driverNumber) {
		var oRegEx = new RegExp("^([0-9][0-9])((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))\-([0-9][0-9])\-([0-9][0-9][0-9][0-9])$");
		return oRegEx.test(value);
	}
	
	function validateNRICsecondary(value) {
		var today = new Date();

		var currentYYYY = today.getFullYear();
		var currentMM = today.getMonth();
		var currentDD = today.getDate();

		var yymmdd = value.substring(0, 6);
		var year = yymmdd.substring(0, 2);
		var month = yymmdd.substring(2, 4);
		var date = yymmdd.substring(4, 6);
		var currentYY = currentYYYY.toString().substring(2, 4);

		if ((currentYY - year) < 0) {
			ageYearPrefix = 19;
		}
		else {
			if ((currentYY - year) == 0) {
				if ((currentMM - (month - 1)) < 0) {
					ageYearPrefix = 19;
				} else {
					if ((currentMM - (month - 1)) == 0) {
						if ((currentDD - date) < 0) {
							ageYearPrefix = 19;
						} else {
							ageYearPrefix = 20;
						}
					} else {
						ageYearPrefix = 20;
					}
				}
			} else {
				ageYearPrefix = 20;
			}
		}

		dob = new Date(ageYearPrefix + year, month - 1, date);

		//input in ISO format: yyyy-MM-dd
		var input = ageYearPrefix + year + "-" + month + "-" + date;
		var bits = input.split('-');
		return dob.getFullYear() == bits[0] && (dob.getMonth() + 1) == bits[1] && dob.getDate() == Number(bits[2]);
	}
	
	var addCoverAgeLimitList = new Array();
	#if ($UtilMethods.isSet( $product.getAdditionalCoverageList()))
		#foreach($addCover in $product.getAdditionalCoverageList().entrySet())
		
			addCoverAgeLimitList['$addCover.getKey()'] = {
				min: "$addCover.getValue().getMinAge()",
				minUnit : "$addCover.getValue().getMinAgeUnit()",
				max: "$addCover.getValue().getMaxAge()",
				maxUnit: "$addCover.getValue().getMaxAgeUnit()"
			}
		
		#end	
	#end
	
	#if ($product.ageFromYearOfBirth)
		var isAgeFromYearOfBirth = true;
	#else
		var isAgeFromYearOfBirth = false;
	#end
	
	function validateAgeLimit(inputNRIC, inputDOB, driverNumber, position) {
		var dob;
		var min;
		var minUnit;
		var max;
		var maxUnit;
		
		var _coverStart = jQuery("input[name='coverageStartDate']").val();
		var relationship = $("input[name='memberRelationship']").val().split(",")[position];
		
		 if (_coverStart != undefined && _coverStart != '') {
			var coverStart = getDate(jQuery("input[name='coverageStartDate']").val());
		} else {
			return false;
		}
		
		
		if (inputDOB != undefined && inputDOB != "") {
			console.log("DOB");
			dob = getDate(inputDOB);
		} else {
			console.log("NRIC");
			dob = extractDOB(inputNRIC)
		}
		console.log("dob: "+ dob + " coverStart: " +coverStart);
		min = addCoverAgeLimitList[relationship].min;
        minUnit = addCoverAgeLimitList[relationship].minUnit;
        max = addCoverAgeLimitList[relationship].max;
        maxUnit = addCoverAgeLimitList[relationship].maxUnit;
		
		if(isNaN(dob)){
			return false;
		}
		if (dob instanceof Date && !isNaN(dob)) {
			if (isAgeFromYearOfBirth && minUnit == "year") {
                    dob = new Date(dob.getFullYear(), 0, 1);
			}
			
			var result = checkAgeLimit(dob, min, minUnit, max, maxUnit, coverStart);
			
			if (result == "NO_ERROR") {
				return true;
			} else {
				var minUnitStr = "";
				if (minUnit == 'day') {
					minUnitStr = ' days';
				}
				var maxUnitStr = "";
				if (maxUnit == 'year') {
					maxUnitStr = ' years';
				}
				
				var person = $("input[name='memberRelationship']").val().split(",")[position] + " #" + (driverNumber + 1);
				var message = "";
				if (result == "ERR_POLICYHOLDER_MIN_AGE") {
					message = "Min age for " + relationship + " #" + driverNumber + " is " + min + ".";
				} else if (result == "ERR_POLICYHOLDER_MAX_AGE") {
					message = "Max age for " + relationship + " #" + driverNumber + " is " + max + ".";
				}
				
				if (inputDOB != undefined && inputDOB != "") {
					$(".driverDOBSection" + driverNumber).find("br").remove();
					$(".driverDOBSection" + driverNumber).find("span").remove();
					$(".driverDOBSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverNRIC">' + message + '</span>');
				} else {
					$(".driverNRICSection" + driverNumber).find("br").remove();
					$(".driverNRICSection" + driverNumber).find("span").remove();
					$(".driverNRICSection" + driverNumber).append('<br/><span class="invalid" name="invalidDriverNRIC">' + message + '</span>');
				}
				return false;
			}
		} else {
			return false;
		}
	}
	
    function validatePolicyHolderAgeLimit(inputDOB) {
        var dob;
		var min;
		var minUnit;
		var max;
		var maxUnit;
        
		var _coverStart = jQuery("input[name='coverageStartDate']").val();
		var relationship = $("input[name='memberRelationship']").val().split(",")[0];
		
		 if (_coverStart != undefined && _coverStart != '') {
			var coverStart = getDate(jQuery("input[name='coverageStartDate']").val());
		} else {
			return false;
		}
		
		if (inputDOB != undefined && inputDOB != "") {
			dob = getDate(inputDOB);
		}
        
		min = addCoverAgeLimitList[relationship].min;
        minUnit = addCoverAgeLimitList[relationship].minUnit;
        max = addCoverAgeLimitList[relationship].max;
        maxUnit = addCoverAgeLimitList[relationship].maxUnit;
		
		if(isNaN(dob)){
			return false;
		}
		if (dob instanceof Date && !isNaN(dob)) {
			if (isAgeFromYearOfBirth && minUnit == "year") {
                    dob = new Date(dob.getFullYear(), 0, 1);
			}
			
			var result = checkAgeLimit(dob, min, minUnit, max, maxUnit, coverStart);
			
			if (result == "NO_ERROR") {
				return true;
			} else {
				var minUnitStr = "";
				if (minUnit == 'day') {
					minUnitStr = ' days';
				}
				var maxUnitStr = "";
				if (maxUnit == 'year') {
					maxUnitStr = ' years';
				}
				
				var message = "";
				if (result == "ERR_POLICYHOLDER_MIN_AGE") {
					message = "Min age for " + relationship + " is " + min + ".";
				} else if (result == "ERR_POLICYHOLDER_MAX_AGE") {
					message = "Max age for " + relationship + " is " + max + ".";
				}
				
				if (inputDOB != undefined && inputDOB != "") {
					$(".policyHolderDOBSection").find("br").remove();
					$(".policyHolderDOBSection").find("span").remove();
					$(".policyHolderDOBSection").append('<br/><span class="invalid" name="invalidDriverDOB">' + message + '</span>');
				} else {
					$(".policyHolderNRICSection").find("br").remove();
					$(".policyHolderNRICSection").find("span").remove();
					$(".policyHolderNRICSection").append('<br/><span class="invalid" name="invalidDriverDOB">' + message + '</span>');
				}
				return false;
			}
		} else {
			return false;
		}
	}
    
	function getDate(dateStr){
		ddMMYYYY = dateStr.split("/");
		var date = new Date(ddMMYYYY[2], ddMMYYYY[1] - 1, ddMMYYYY[0]);
		return date;
	}
	
	function extractDOB(nric){
		var today = new Date();
		
		var currentYYYY = today.getFullYear();
		var currentMM = today.getMonth();
		var currentDD = today.getDate();

		var yymmdd = nric.substring(0,6);
		var year = yymmdd.substring(0,2);
		var month = yymmdd.substring(2,4);
		var date = yymmdd.substring(4,6);
		var currentYY = currentYYYY.toString().substring(2,4);

		if ((currentYY - year) < 0) {
		  ageYearPrefix = 19;
		} else {
			if ((currentYY - year) == 0){
				if ((currentMM - (month-1)) < 0){
					ageYearPrefix = 19;
				}else{
					if ((currentMM - (month-1)) == 0){
						if ((currentDD - date) < 0){
							ageYearPrefix = 19;
						}else{
							ageYearPrefix = 20;
						}
					}else{
						ageYearPrefix = 20;
					}    
				}
			}else{
				ageYearPrefix = 20;
			}
		}  

		dob  = new Date(ageYearPrefix+year, month - 1, date);
		return dob;
	}
	
	function checkAgeLimit(dob, min, minUnit, max, maxUnit, coverStart){
	
	  var minAgeDate = new Date(dob.getFullYear(), dob.getMonth(), dob.getDate());
	  var maxAgeDate = new Date(dob.getFullYear(), dob.getMonth(), dob.getDate());
	  
		if (minUnit == "year"){
			var config = {years: min};
			var minAgeDate = minAgeDate.add(config);
		}else if (minUnit == "month"){
			var config = {months: min};
			var minAgeDate = minAgeDate.add(config);
		}else if (minUnit == "day"){
			var config = {days: min};
			var minAgeDate = minAgeDate.add(config);
		}
	  
		if (!Date.isLeapYear(minAgeDate.getFullYear)){
			if (dob.getMonth() == 1 && dob.getDate() == 29){
			  var config = {days: 1};
			  minAgeDate = minAgeDate.add(config);
			}
		}
		
		if (maxUnit == "year"){
			max = Number(max) + 1;
			var config = {years: max};
			var maxAgeDate = maxAgeDate.add(config);
		}else if (maxUnit == "month"){
			var config = {months: max};
			var maxAgeDate = maxAgeDate.add(config);
		}else if (maxUnit == "day"){
			var config = {days: max};
			var maxAgeDate = maxAgeDate.add(config);
		}
	  
		if (!Date.isLeapYear(maxAgeDate.getFullYear())){
			if (dob.getMonth() == 1 && dob.getDate() == 29){
			  var config = {days: 1};
			  maxAgeDate = maxAgeDate.add(config);
			}
		}
	  
		var result = 0;
		result = coverStart.compareTo(minAgeDate);
		if (result < 0){        
		  console.log("result : " + "ERR_POLICYHOLDER_MIN_AGE");
		  return "ERR_POLICYHOLDER_MIN_AGE";
		}else{
		  result = coverStart.compareTo(maxAgeDate);
		  if (result == 0 || result > 0 ){
			console.log("result : " + "ERR_POLICYHOLDER_MAX_AGE");
			return "ERR_POLICYHOLDER_MAX_AGE";
		  }
		}
		return "NO_ERROR";
	}
	
	function calculateMotorPlusPlanPremium() {
		var canCalc = true;
        if ($('input[name=motorNvic]').val() == null || $('input[name=motorNvic]').val() == "") {
            canCalc = false;
        }
        if ($('input[name=motorVehicleLocation]').val() == null || $('input[name=motorVehicleLocation]').val() == "") {
            canCalc = false;
        }
        if ($('input[name=motorNxtNcdLevel]').val() == null || $('input[name=motorNxtNcdLevel]').val() == "") {
            canCalc = false;
        }

        if (canCalc) {
        
            var memberRelArr = new Array();
            
            var elem = $("div#motorDriver");
            for (var i = 0; i < elem.length; i++)
            {
                var memberRel = "Driver"
                memberRelArr.push(memberRel);
            }
            memberRelArr.push("Driver");
            console.log("motorplus-family=" + elem.length);
            jQuery.ajax({
                type: "POST",
                url: '/dotCMS/purchase/buynow',
                dataType: "json",
                data: {                    
                    "action": "calculatePremium",
                    "memberRelationship": memberRelArr.join(),
                    "motorNvic": $('input[name=motorNvic]').val(),
                    "motorVehicleLocation": $('input[name=motorVehicleLocation]').val(),
                    "motorNxtNcdLevel": $('input[name=motorNxtNcdLevel]').val(),
                    "motorAddLegalLiabilityToPassengers": $('input[name=motorAddLegalLiabilityToPassengers]').val(),
                    "motorAddLegalLiabilityOfPassengers": $('input[name=motorAddLegalLiabilityOfPassengers]').val(),
                    "motorAddSpecialPerils": $('input[name=motorAddSpecialPerils]').val(),
                    "motorAddLimitedSpecialPerils": $('input[name=motorAddLimitedSpecialPerils]').val(),
                    "motorAddSRCC": $('input[name=motorAddSRCC]').val(),
                    "motorAddRiderPA": $('input[name=motorAddRiderPA]').val(),
                    "motorAddUnlimitedTowing": $('input[name=motorAddUnlimitedTowing]').val(),
                    "motorAddBetterment": $('input[name=motorAddBetterment]').val(),
                    "motorAddBettermentEndorsementCode": $('input[name=motorAddBettermentEndorsementCode]').val(),
                    "motorAddEHailing": $('input[name=motorAddEHailing]').val(),
                    "motorAddWaiverCompulsoryExcess": $('input[name=motorAddWaiverCompulsoryExcess]').val(),
                    "motorPlusPlan": $('input[name=motorPlusPlan]').val(),
                    "motorAddCARTSumInsured": $('input[name=motorAddCARTSumInsured]').val(),
					"allRiderPlan": $('input[name=allRiderPlan]').val(),
                    "productName": $('input[name=productName]').val(),
                    "additionalPlanA": $('input[name=additionalPlanA]').val(),
                    "additionalPlanB": $('input[name=additionalPlanB]').val(),
                    "additionalPlanC": $('input[name=additionalPlanC]').val(),
                    "additionalPlan07": $('input[name=additionalPlan07]').val(),
                    "additionalPlan14": $('input[name=additionalPlan14]').val(),
                    "additionalPlan21": $('input[name=additionalPlan21]').val(),
                    "motorAddNcdRelief": $('input[name=motorAddNcdRelief]').val(),
                    "motorAddSmartKeyShieldSumInsured": $('input[name=motorAddSmartKeyShieldSumInsured]').val(),
                    "motorAddDriverPersonalAccidentSumInsured": $('input[name=motorAddDriverPersonalAccidentSumInsured]').val(),
                    "motorAddWindscreenSumInsured": $('input[name=motorAddWindscreenSumInsured]').val(),
                    "productCode": $('input[name=productCode]').val(),
                    "partnerCode": $('input[name=partnerCode]').val(),
                    "coverageStartDate" : $('input[name=coverageStartDate]').val(),
                    "coverageExpiryDate" : $('input[name=coverageExpiryDate]').val(),
                    "policyHolderNRIC": $('input[name=policyHolderNRIC]').val(),
                    "policyHolderGender": $('input[name=policyHolderGender]').val(),
                    "policyHolderMalaysian": $('input[name=policyHolderMalaysian]').val(),
                    "policyHolderDateOfBirth": $('input[name=policyHolderDateOfBirth]').val(),
                    "motorCc": $('input[name=motorCc]').val(),
                    "motorMakeCode": $('input[name=motorMakeCode]').val(),
                    "motorYearOfMake": $('input[name=motorYearOfMake]').val(),
                    "motorModelCode": $('input[name=motorModelCode]').val(),
                    "motorChassisNo": $('input[name=motorChassisNo]').val(),
                    "motorRegistrationNo": $('input[name=motorRegistrationNo]').val(),
                    "motorSeat": $('input[name=motorSeat]').val(),
                    "motorStyle": $('input[name=motorStyle]').val(),
                    "motorVariant": $('input[name=motorVariant]').val(),
                    "motorTransmission": $('input[name=motorTransmission]').val(),
                    "motorFamily": $('input[name=motorFamily]').val(),
                    "motorMake": $('input[name=motorMake]').val(),
                    "motorVehiclePremiumValue": $('input[name=motorVehiclePremiumValue]').val(),
                    "motorRegistrationNo": $('input[name=motorRegistrationNo]').val(),
                    "dpfstatus": $('input[name=dpfStatus]').val(),
                    "staffId": $('input[name=staffID]').val(),
                    "staffRelationship": $('input[name=staffRelationship]').val(),
                    "addressState": $('input[name=addressState]').val(),
                    "promotionCode": $('[name=promotionCode]').val()
                },
                success: function (data) {
                    $('input[name=motorSumInsured]').val(data.sumInsured);
                    $('input[name=totalPremium]').val(data.totalPayable);
                    $('input[name=discount]').val(data.discountAmount);
                    $('input[name=sstVal]').val(data.sstAmount);
                    $('input[name=driverQuantity]').val(data.additionalDriver);
                    $('input[name=driverPremium]').val(data.additionalDriverPremium);
                    $('input[name=additionalPremium]').val(data.totalAdditionalCoveragePremium);
                    $('input[name=grandTotal]').val(data.totalPayable);
                    $('input[name=annualPremium]').val(data.totalPremium + data.discountAmount);
                    $('input[name=sst]').val(data.sst);
                    $('input[name=stampDuty]').val(data.stampDuty);
                    $('input[name=basicPremium]').val(data.basePremium);
                    $('input[name=ncdAmount]').val(data.ncdAmount);
                    $('input[name=netNcdAmount]').val(data.basePremium + data.allRiderPlanPremium - data.ncdAmount);
                    $('input[name=allRiderPlanPremium]').val(data.allRiderPlanPremium);
                    
                    $('span#summarySumInsured').html("RM " + $.number($('input[name=motorSumInsured]').val(), 2));
					$('span#summaryExcess').html("RM " + $.number(data.excess, 2));
                    $('span#summaryAnnualPremium').html("RM " + $.number($('input[name=annualPremium]').val(), 2));
                    
                    if($('input[name=driverQuantity]').val() > 0){
                        $('li#summaryAdditionalDriverRow').removeAttr('style');
                        $('li#summaryAdditionalDriverRow p').html("Additional Driver " + $('input[name=driverQuantity]').val());
                        $('span#summaryAdditionalDriver').html("RM " + $.number($('input[name=driverPremium]').val(), 2));
                    } else {
                        $('li#summaryAdditionalDriverRow').attr('style', 'display: none !important');
                        $('li#summaryAdditionalDriverRow p').html("");
                    }
                    
                    $('span#summaryDiscountValue').html("- RM " + $.number($('input[name=discount]').val(), 2));
                    $('span#summarySstValue').html("RM " + $.number($('input[name=sstVal]').val(), 2));
                    $('span#summaryGrandTotal').html("RM " + $.number($('input[name=grandTotal]').val(),2));
                    $('span#summaryTotalAdditionalPremium').html("RM " +  $.number($('input[name=additionalPremium]').val(), 2));
                    
                    $('input[name=motorPlusPlanPremium]').val(data.motorPlusPlanPremium);
                    $('input[name=legalLiabilityToPassengersPremium]').val(data.addLegalLiabilityToPassengersPremium);
                    $('input[name=legalLiabilityOfPassengersPremium]').val(data.addLegalLiabilityOfPassengersPremium);
                    $('input[name=ncdReliefPremium]').val(data.addNcdReliefPremium);
                    $('input[name=specialPerilsPremium]').val(data.addSpecialPerilsPremium);
                    $('input[name=limitedSpecialPerilsPremium]').val(data.addLimitedSpecialPerilsPremium);
                    $('input[name=unlimitedTowingPremium]').val(data.addUnlimitedTowingPremium);
                    $('input[name=waiverCompulsoryExcessPremium]').val(data.addWaiverCompulsoryExcessPremium);
                    $('input[name=srccPremium]').val(data.addSRCCPremium);
                    $('input[name=riderPAPremium]').val(data.addRiderPAPremium);
                    $('input[name=eHailingPremium]').val(data.addEHailingPremium);
                    $('input[name=bettermentPremium]').val(data.addBettermentPremium);
                    $('input[name=windscreenSumInsured]').val(data.addWindscreenPremium);
                    $('input[name=smartKeyShieldSumInsured]').val(data.addSmartKeyShieldPremium);
                    $('input[name=driverPersonalAccidentSumInsured]').val(data.addDriverPersonalAccidentPremium);
                    $('input[name=cartSumInsured]').val(data.addCARTPremium);
                    $('input[name=additionalPremium]').val(data.totalAdditionalCoveragePremium);
                    
                    $('p#ncdAmountDisplayNxtNcd').html("NCD (" + $('input[name=motorDisplayNxtNcd]').val() + ")");
                    $('span#basicPremium').html("RM " + $.number($('input[name=basicPremium]').val(), 2));
                    $('span#ncdAmount').html("- RM " + $.number($('input[name=ncdAmount]').val(), 2));
                    $('span#netNcdAmount').html("RM " + $.number($('input[name=netNcdAmount]').val(), 2));
                    
                     if($('input[name=driverQuantity]').val() > 0){
                        $('li#summaryAdditionalDriverRow').removeAttr('style');
                        $('li#summaryAdditionalDriverRow p').html("Additional Driver " + $('input[name=driverQuantity]').val());
                        $('span#summaryAdditionalDriver').html("RM " + $.number($('input[name=driverPremium]').val(), 2));
                    } else {
                        $('li#summaryAdditionalDriverRow').attr('style', 'display: none !important');
                        $('li#summaryAdditionalDriverRow p').html("");
                    }
                    
                    if($('input[name=annualPremium]').val() > 0){
                        $('li#summaryAnnualPremiumRow').removeAttr('style');
                        $('span#summaryAnnualPremium').html("RM " + $.number($('input[name=annualPremium]').val(), 2));
                    }
                    if($('input[name=discount]').val() > 0){
                        $('li#summaryDiscountRow').removeAttr('style');
                        $('span#summaryDiscountValue').html("- RM " + $.number($('input[name=discount]').val(), 2));
                    }
                    if($('input[name=sst]').val() > 0){
                        $('li#summarySstRow').removeAttr('style');
                        $('li#summarySstRow p').html("Service Tax (" + $('input[name=sst]').val() + "%)");
                        $('span#summarySstValue').html("RM " + $.number($('input[name=sstVal]').val(), 2));
                    }
                    $('span#summaryGrandTotal').html("RM " +  $.number($('input[name=grandTotal]').val(), 2));
                    if($('input[name=stampDuty]').val() > 0){
                        $('li#summaryStampDutyRow').removeAttr('style');
                        $('span#summaryStampDuty').html("RM " + $.number($('input[name=stampDuty]').val(), 2));
                    }
                                        
                    $('span#motorPlusPlanPremium').html("RM " +  $.number($('input[name=motorPlusPlanPremium]').val(), 2));
                    $('span#allRiderPlanPremium').html("RM " +  $.number($('input[name=allRiderPlanPremium]').val(), 2));
                    $('span#summaryLegalLiabilityToPassengers').html("RM " +  $.number($('input[name=legalLiabilityToPassengersPremium]').val(), 2));
                    $('span#summaryLegalLiabilityOfPassengers').html("RM " +  $.number($('input[name=legalLiabilityOfPassengersPremium]').val(), 2));
                    $('span#summarySpecialPerils').html("RM " +  $.number($('input[name=specialPerilsPremium]').val(), 2));
                    $('span#summaryLimitedSpecialPerils').html("RM " +  $.number($('input[name=limitedSpecialPerilsPremium]').val(), 2));
                    $('span#summaryUnlimitedTowing').html("RM " +  $.number($('input[name=unlimitedTowingPremium]').val(), 2));
                    $('span#summaryWaiverCompulsoryExcess').html("RM " +  $.number($('input[name=waiverCompulsoryExcessPremium]').val(), 2));
                    $('span#summarySRCC').html("RM " +  $.number($('input[name=srccPremium]').val(), 2));
                    $('span#summaryRiderPA').html("RM " +  $.number($('input[name=riderPAPremium]').val(), 2));
                    $('span#summaryEHailing').html("RM " +  $.number($('input[name=eHailingPremium]').val(), 2));
                    $('span#summaryNcdRelief').html("RM " +  $.number($('input[name=ncdReliefPremium]').val(), 2));
                    $('span#summaryBetterment').html("RM " +  $.number($('input[name=bettermentPremium]').val(), 2));
                    $('span#summaryWindscreen').html("RM " +  $.number($('input[name=windscreenSumInsured]').val(), 2));
                    $('span#summarySmartKeyShield').html("RM " +  $.number($('input[name=smartKeyShieldSumInsured]').val(), 2));
                    $('span#summaryDriverPersonalAccident').html("RM " +  $.number($('input[name=driverPersonalAccidentSumInsured]').val(), 2));
                    $('span#summaryCART').html("RM " +  $.number($('input[name=cartSumInsured]').val(), 2));
                    $('span#summaryTotalAdditionalPremium').html("RM " +  $.number($('input[name=additionalPremium]').val(), 2));
                    
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    var errorList = [];
                    errorList.push({'message': ' Opps. Something went wrong, please check back again later.'});
                    showErrorMessages(errorList);
                }
            });
        }
	}
    
    <!-- Motor Plus Review Page Javascript End -->
    
    <!-- Fieldset Amendment -->
        $(".motorPlusProgress").addClass("motorPlusStep4");
        $(".motorPlusProgress").removeClass("motorPlusStep5");
	<!-- Fieldset Amendment -->
  
  

 var isPromoCodeValidated = ! $('input[name=promotionCode]').length // will be updated in main.js
   var options = {
    target: '.errorMsgContainer',
        //beforeSubmit:  showRequest,  // pre-submit callback
        success:       showResponse,  // post-submit callback  
        // other available options:
        url:       '/dotCMS/purchase/buynow'         // override for form's 'action' attribute
        //type:      type        // 'get' or 'post', override for form's 'method' attribute
        //dataType:  'json'       // 'xml', 'script', or 'json' (expected server response type)
        //clearForm: true        // clear all form fields after successful submit
        //resetForm: true        // reset the form after successful submit
 
        // $.ajax options can be used here too, for example:
        //timeout:   3000
    };
  
  function proceed(){
    var form = jQuery('form[name=summaryForm]');
    if ($('#boxCheck').is(":checked") && form.valid()) {
         // Show Loading
         #if($product.formula == "motor" && $partnerCode != "SHOP")
            $(".progress-checking").removeClass("hidden");
            $(".planSummary,.checkBox").hide();
         #end
          var checkMembershipLength = 1;
         if($partnerCode.equals("SHOP")){
            if($("#membershipID").val() == ''){
                $('.errorMsgContainer').empty();
                $('.errorMsgContainer').append('<p><strong>Oops, please check your details</strong></p><ul><li> Complete your Membership ID.</li></ul><a href="">Ok, got it</a>');
                
                $('.errorMsgContainer a').click(function(e){
                    e.preventDefault();
                    $(this).parent().addClass("hidden");
                });
                
                $('.errorMsgContainer').removeClass("hidden");
                checkMembershipLength = 0;
            } else if($("#membershipID").val().length < 7) {
                $('.errorMsgContainer').empty();
                $('.errorMsgContainer').append('<p><strong>Oops, please check your details</strong></p><ul><li> Please enter at least 7 characters for your Membership ID.</li></ul><a href="">Ok, got it</a>');
                
                $('.errorMsgContainer a').click(function(e){
                    e.preventDefault();
                    $(this).parent().addClass("hidden");
                });
                
                $('.errorMsgContainer').removeClass("hidden");
                checkMembershipLength = 0;
            } else{
                 $(".progress-checking").removeClass("hidden");
                $(".planSummary,.checkBox").hide();
            }
         }
         
         if(checkMembershipLength == 1){
            if (isPromoCodeValidated) {
                    $("form[name=summaryForm]").ajaxSubmit(options);
                } else {
                    #if($product.formula == "motor" && $partnerCode != "SHOP")
                        $(".progress-checking").removeClass("hidden");
                        $(".planSummary, .checkBox").hide();
                    #end
                    // listen for our custom event, but only once
                    $('form[name=summaryForm]').off('promoCodeValidationComplete').one('promoCodeValidationComplete', function (e) {
                        if (e.success) {
                            $(this).ajaxSubmit(options);
                        } else {
                            #if($product.formula == "motor" && $partnerCode != "SHOP")
                                // Hide Loading
                                $(".progress-checking").addClass("hidden");
                                $(".planSummary, .checkBox").show();
                            #end
                        }
                    });
                    applyPromoCode();
                }
         }
         
         
        return false;
    }
  }
  
  // post-submit callback
  function showResponse(responseText, statusText, xhr, form)  {     
  
    if (responseText.indexOf("msform") != -1){    
      $(window).unbind('beforeunload');
      $("form[name=errorForm]").attr("action", "/$partnerURLTitle/products/$productURLTitle/payment.html$actionAddOnURL");
	  
      $("form[name=errorForm]").submit();
    }else{
      $(".errorMsgContainer a").click(function(e) {
        e.preventDefault();
        $(this).parent().addClass("hidden");
        #if($product.formula == "motor")
            // Hide Loading
            $(".progress-checking").addClass("hidden");
            $(".planSummary,.checkBox").show();
            // Loading Ended
        #end
      });

      $(".errorMsgContainer").removeClass("hidden");

    }
      
  }
    
    $(document).ready(function(e) {
      $(".ir.alignLeft").click(function(e) {
        $(window).unbind('beforeunload');
        #if($branch.length() > 0)
            $("form[name=summaryForm]").attr("action", "registration.html?branch=$branch#personalDetails");
        #else
			#if($productExtended.getAllowMotorPlusPlan().equals("Y") || $product.productName == "Motorcycle")
				$("form[name=summaryForm]").attr("action", "registration.html#planselection");
			#else
				$("form[name=summaryForm]").attr("action", "registration.html#personalDetails");
			#end
        #end
        // clear promo code if its invalid (not 6-12 length or not alphanumeric)
        if (!$("form[name=summaryForm]").valid()) {
            $('input[name=promotionCode]').val('')
        }
        
        $("form[name=summaryForm]").trigger("submit");
      });
      
      if ($('input[name=coveragePlan]').val() == "Upgrade"){
        $(".productUpgrade span").html("✔");
        $(".productUpgrade span").addClass("allowUpgrade");   
        $(".productUpgrade").removeClass("hidden");
      }
      
      $(".productPeople span").text($math.add($memberCount,1));  
      var totalPeople = $math.add($memberCount,1);
      #if ($product.formula != "motor")
        if(totalPeople >= 2){
        $(".productPeople").removeClass("hidden");
      }
      #end
      $(".productPrice span").text("$number.format($format, $totalPremium)");
      ## $(".productDays span").text($noDaysCovered);
      
      ## if has promo code, maybe from refresh or back from payment page
      #if ($UtilMethods.isSet($promotionCode))
        applyPromoCode()
      #end
    });
    
    $('.promptNoSave').click(function(e) {
            e.preventDefault();
            $('.promptOverlay').removeClass("hidden");
            $('.promptNoSaveMsg').removeClass("hidden");
      })
      
    $(document).on('click', 'input[type="checkbox"][data-group]', function(event) {
        // The checkbox that was clicked
        var actor = $(this);
        // The status of that checkbox
        var checked = actor.prop('checked');
        // The group that checkbox is in
        var group = actor.data('group');
        // All checkboxes of that group
        var checkboxes = $('input[type="checkbox"][data-group="' + group + '"]');
        // All checkboxes excluding the one that was clicked
        var otherCheckboxes = checkboxes.not(actor);
        // Check those checkboxes
        otherCheckboxes.prop('checked', checked);
    });
  </script>